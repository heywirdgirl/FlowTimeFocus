(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,81140,e=>{"use strict";function t(e,r,{checkForDefaultPrevented:n=!0}={}){return function(t){if(e?.(t),!1===n||!t.defaultPrevented)return r?.(t)}}e.s(["composeEventHandlers",()=>t])},20783,e=>{"use strict";var t=e.i(71645);function r(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function n(...e){return t=>{let n=!1,i=e.map(e=>{let i=r(e,t);return n||"function"!=typeof i||(n=!0),i});if(n)return()=>{for(let t=0;t<i.length;t++){let n=i[t];"function"==typeof n?n():r(e[t],null)}}}}function i(...e){return t.useCallback(n(...e),e)}e.s(["composeRefs",()=>n,"useComposedRefs",()=>i])},30030,e=>{"use strict";var t=e.i(71645),r=e.i(43476);function n(e,n){let i=t.createContext(n),s=e=>{let{children:n,...s}=e,o=t.useMemo(()=>s,Object.values(s));return(0,r.jsx)(i.Provider,{value:o,children:n})};return s.displayName=e+"Provider",[s,function(r){let s=t.useContext(i);if(s)return s;if(void 0!==n)return n;throw Error(`\`${r}\` must be used within \`${e}\``)}]}function i(e,n=[]){let s=[],o=()=>{let r=s.map(e=>t.createContext(e));return function(n){let i=n?.[e]||r;return t.useMemo(()=>({[`__scope${e}`]:{...n,[e]:i}}),[n,i])}};return o.scopeName=e,[function(n,i){let o=t.createContext(i),a=s.length;s=[...s,i];let l=n=>{let{scope:i,children:s,...l}=n,u=i?.[e]?.[a]||o,c=t.useMemo(()=>l,Object.values(l));return(0,r.jsx)(u.Provider,{value:c,children:s})};return l.displayName=n+"Provider",[l,function(r,s){let l=s?.[e]?.[a]||o,u=t.useContext(l);if(u)return u;if(void 0!==i)return i;throw Error(`\`${r}\` must be used within \`${n}\``)}]},function(...e){let r=e[0];if(1===e.length)return r;let n=()=>{let n=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let i=n.reduce((t,{useScope:r,scopeName:n})=>{let i=r(e)[`__scope${n}`];return{...t,...i}},{});return t.useMemo(()=>({[`__scope${r.scopeName}`]:i}),[i])}};return n.scopeName=r.scopeName,n}(o,...n)]}e.s(["createContext",()=>n,"createContextScope",()=>i])},48425,e=>{"use strict";var t=e.i(71645),r=e.i(74080),n=e.i(20783),i=e.i(43476),s=t.forwardRef((e,r)=>{let{children:n,...s}=e,a=t.Children.toArray(n),u=a.find(l);if(u){let e=u.props.children,n=a.map(r=>r!==u?r:t.Children.count(e)>1?t.Children.only(null):t.isValidElement(e)?e.props.children:null);return(0,i.jsx)(o,{...s,ref:r,children:t.isValidElement(e)?t.cloneElement(e,void 0,n):null})}return(0,i.jsx)(o,{...s,ref:r,children:n})});s.displayName="Slot";var o=t.forwardRef((e,r)=>{let{children:i,...s}=e;if(t.isValidElement(i)){var o;let e,a,l=(o=i,(a=(e=Object.getOwnPropertyDescriptor(o.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?o.ref:(a=(e=Object.getOwnPropertyDescriptor(o,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?o.props.ref:o.props.ref||o.ref),u=function(e,t){let r={...t};for(let n in t){let i=e[n],s=t[n];/^on[A-Z]/.test(n)?i&&s?r[n]=(...e)=>{s(...e),i(...e)}:i&&(r[n]=i):"style"===n?r[n]={...i,...s}:"className"===n&&(r[n]=[i,s].filter(Boolean).join(" "))}return{...e,...r}}(s,i.props);return i.type!==t.Fragment&&(u.ref=r?(0,n.composeRefs)(r,l):l),t.cloneElement(i,u)}return t.Children.count(i)>1?t.Children.only(null):null});o.displayName="SlotClone";var a=({children:e})=>(0,i.jsx)(i.Fragment,{children:e});function l(e){return t.isValidElement(e)&&e.type===a}var u=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,r)=>{let n=t.forwardRef((e,t)=>{let{asChild:n,...o}=e,a=n?s:r;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,i.jsx)(a,{...o,ref:t})});return n.displayName=`Primitive.${r}`,{...e,[r]:n}},{});function c(e,t){e&&r.flushSync(()=>e.dispatchEvent(t))}e.s(["Primitive",()=>u,"dispatchDiscreteCustomEvent",()=>c],48425)},30207,e=>{"use strict";var t=e.i(71645);function r(e){let r=t.useRef(e);return t.useEffect(()=>{r.current=e}),t.useMemo(()=>(...e)=>r.current?.(...e),[])}e.s(["useCallbackRef",()=>r])},96626,34620,e=>{"use strict";var t=e.i(71645),r=e.i(20783),n=globalThis?.document?t.useLayoutEffect:()=>{};e.s(["useLayoutEffect",()=>n],34620);var i=e=>{var i;let o,a,{present:l,children:u}=e,c=function(e){var r,i;let[o,a]=t.useState(),l=t.useRef({}),u=t.useRef(e),c=t.useRef("none"),[h,d]=(r=e?"mounted":"unmounted",i={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},t.useReducer((e,t)=>i[e][t]??e,r));return t.useEffect(()=>{let e=s(l.current);c.current="mounted"===h?e:"none"},[h]),n(()=>{let t=l.current,r=u.current;if(r!==e){let n=c.current,i=s(t);e?d("MOUNT"):"none"===i||t?.display==="none"?d("UNMOUNT"):r&&n!==i?d("ANIMATION_OUT"):d("UNMOUNT"),u.current=e}},[e,d]),n(()=>{if(o){let e,t=o.ownerDocument.defaultView??window,r=r=>{let n=s(l.current).includes(r.animationName);if(r.target===o&&n&&(d("ANIMATION_END"),!u.current)){let r=o.style.animationFillMode;o.style.animationFillMode="forwards",e=t.setTimeout(()=>{"forwards"===o.style.animationFillMode&&(o.style.animationFillMode=r)})}},n=e=>{e.target===o&&(c.current=s(l.current))};return o.addEventListener("animationstart",n),o.addEventListener("animationcancel",r),o.addEventListener("animationend",r),()=>{t.clearTimeout(e),o.removeEventListener("animationstart",n),o.removeEventListener("animationcancel",r),o.removeEventListener("animationend",r)}}d("ANIMATION_END")},[o,d]),{isPresent:["mounted","unmountSuspended"].includes(h),ref:t.useCallback(e=>{e&&(l.current=getComputedStyle(e)),a(e)},[])}}(l),h="function"==typeof u?u({present:c.isPresent}):t.Children.only(u),d=(0,r.useComposedRefs)(c.ref,(i=h,(a=(o=Object.getOwnPropertyDescriptor(i.props,"ref")?.get)&&"isReactWarning"in o&&o.isReactWarning)?i.ref:(a=(o=Object.getOwnPropertyDescriptor(i,"ref")?.get)&&"isReactWarning"in o&&o.isReactWarning)?i.props.ref:i.props.ref||i.ref));return"function"==typeof u||c.isPresent?t.cloneElement(h,{ref:d}):null};function s(e){return e?.animationName||"none"}i.displayName="Presence",e.s(["Presence",()=>i],96626)},75254,e=>{"use strict";var t=e.i(71645);let r=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,t.forwardRef)(({color:e="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:a="",children:l,iconNode:u,...c},h)=>(0,t.createElement)("svg",{ref:h,...n,width:i,height:i,stroke:e,strokeWidth:o?24*Number(s)/Number(i):s,className:r("lucide",a),...c},[...u.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(l)?l:[l]])),s=(e,n)=>{let s=(0,t.forwardRef)(({className:s,...o},a)=>(0,t.createElement)(i,{ref:a,iconNode:n,className:r(`lucide-${e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,s),...o}));return s.displayName=`${e}`,s};e.s(["default",()=>s],75254)},25913,26683,e=>{"use strict";function t(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=function e(t){var r,n,i="";if("string"==typeof t||"number"==typeof t)i+=t;else if("object"==typeof t)if(Array.isArray(t)){var s=t.length;for(r=0;r<s;r++)t[r]&&(n=e(t[r]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}(e))&&(n&&(n+=" "),n+=t);return n}let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e;e.s(["cva",0,(e,n)=>i=>{var s;if((null==n?void 0:n.variants)==null)return t(e,null==i?void 0:i.class,null==i?void 0:i.className);let{variants:o,defaultVariants:a}=n,l=Object.keys(o).map(e=>{let t=null==i?void 0:i[e],n=null==a?void 0:a[e];if(null===t)return null;let s=r(t)||r(n);return o[e][s]}),u=i&&Object.entries(i).reduce((e,t)=>{let[r,n]=t;return void 0===n||(e[r]=n),e},{});return t(e,l,null==n||null==(s=n.compoundVariants)?void 0:s.reduce((e,t)=>{let{class:r,className:n,...i}=t;return Object.entries(i).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...a,...u}[t]):({...a,...u})[t]===r})?[...e,r,n]:e},[]),null==i?void 0:i.class,null==i?void 0:i.className)}],25913);let n=(e,t)=>{if(0===e.length)return t.classGroupId;let r=e[0],i=t.nextPart.get(r),s=i?n(e.slice(1),i):void 0;if(s)return s;if(0===t.validators.length)return;let o=e.join("-");return t.validators.find(({validator:e})=>e(o))?.classGroupId},i=/^\[(.+)\]$/,s=(e,t,r,n)=>{e.forEach(e=>{if("string"==typeof e){(""===e?t:o(t,e)).classGroupId=r;return}"function"==typeof e?a(e)?s(e(n),t,r,n):t.validators.push({validator:e,classGroupId:r}):Object.entries(e).forEach(([e,i])=>{s(i,o(t,e),r,n)})})},o=(e,t)=>{let r=e;return t.split("-").forEach(e=>{r.nextPart.has(e)||r.nextPart.set(e,{nextPart:new Map,validators:[]}),r=r.nextPart.get(e)}),r},a=e=>e.isThemeGetter,l=/\s+/;function u(){let e,t,r=0,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=c(e))&&(n&&(n+=" "),n+=t);return n}let c=e=>{let t;if("string"==typeof e)return e;let r="";for(let n=0;n<e.length;n++)e[n]&&(t=c(e[n]))&&(r&&(r+=" "),r+=t);return r},h=e=>{let t=t=>t[e]||[];return t.isThemeGetter=!0,t},d=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,f=/^\((?:(\w[\w-]*):)?(.+)\)$/i,p=/^\d+\/\d+$/,g=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,m=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,y=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,v=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,w=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,b=e=>p.test(e),_=e=>!!e&&!Number.isNaN(Number(e)),E=e=>!!e&&Number.isInteger(Number(e)),I=e=>e.endsWith("%")&&_(e.slice(0,-1)),T=e=>g.test(e),S=()=>!0,C=e=>m.test(e)&&!y.test(e),k=()=>!1,A=e=>v.test(e),x=e=>w.test(e),R=e=>!O(e)&&!V(e),N=e=>H(e,X,k),O=e=>d.test(e),D=e=>H(e,J,C),P=e=>H(e,Z,_),L=e=>H(e,K,k),M=e=>H(e,Q,x),U=e=>H(e,k,A),V=e=>f.test(e),F=e=>G(e,J),j=e=>G(e,ee),B=e=>G(e,K),$=e=>G(e,X),z=e=>G(e,Q),q=e=>G(e,et,!0),H=(e,t,r)=>{let n=d.exec(e);return!!n&&(n[1]?t(n[1]):r(n[2]))},G=(e,t,r=!1)=>{let n=f.exec(e);return!!n&&(n[1]?t(n[1]):r)},K=e=>"position"===e,W=new Set(["image","url"]),Q=e=>W.has(e),Y=new Set(["length","size","percentage"]),X=e=>Y.has(e),J=e=>"length"===e,Z=e=>"number"===e,ee=e=>"family-name"===e,et=e=>"shadow"===e,er=function(e,...t){let r,o,a,c=function(l){var u;let d;return o=(r={cache:(e=>{if(e<1)return{get:()=>void 0,set:()=>{}};let t=0,r=new Map,n=new Map,i=(i,s)=>{r.set(i,s),++t>e&&(t=0,n=r,r=new Map)};return{get(e){let t=r.get(e);return void 0!==t?t:void 0!==(t=n.get(e))?(i(e,t),t):void 0},set(e,t){r.has(e)?r.set(e,t):i(e,t)}}})((u=t.reduce((e,t)=>t(e),e())).cacheSize),parseClassName:(e=>{let{prefix:t,experimentalParseClassName:r}=e,n=e=>{let t,r,n=[],i=0,s=0,o=0;for(let t=0;t<e.length;t++){let a=e[t];if(0===i&&0===s){if(":"===a){n.push(e.slice(o,t)),o=t+1;continue}if("/"===a){r=t;continue}}"["===a?i++:"]"===a?i--:"("===a?s++:")"===a&&s--}let a=0===n.length?e:e.substring(o),l=(t=a).endsWith("!")?t.substring(0,t.length-1):t.startsWith("!")?t.substring(1):t;return{modifiers:n,hasImportantModifier:l!==a,baseClassName:l,maybePostfixModifierPosition:r&&r>o?r-o:void 0}};if(t){let e=t+":",r=n;n=t=>t.startsWith(e)?r(t.substring(e.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:t,maybePostfixModifierPosition:void 0}}if(r){let e=n;n=t=>r({className:t,parseClassName:e})}return n})(u),sortModifiers:(d=Object.fromEntries(u.orderSensitiveModifiers.map(e=>[e,!0])),e=>{if(e.length<=1)return e;let t=[],r=[];return e.forEach(e=>{"["===e[0]||d[e]?(t.push(...r.sort(),e),r=[]):r.push(e)}),t.push(...r.sort()),t}),...(e=>{let t=(e=>{let{theme:t,classGroups:r}=e,n={nextPart:new Map,validators:[]};for(let e in r)s(r[e],n,e,t);return n})(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:o}=e;return{getClassGroupId:e=>{let r=e.split("-");return""===r[0]&&1!==r.length&&r.shift(),n(r,t)||(e=>{if(i.test(e)){let t=i.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}})(e)},getConflictingClassGroupIds:(e,t)=>{let n=r[e]||[];return t&&o[e]?[...n,...o[e]]:n}}})(u)}).cache.get,a=r.cache.set,c=h,h(l)};function h(e){let t=o(e);if(t)return t;let n=((e,t)=>{let{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i,sortModifiers:s}=t,o=[],a=e.trim().split(l),u="";for(let e=a.length-1;e>=0;e-=1){let t=a[e],{isExternal:l,modifiers:c,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:f}=r(t);if(l){u=t+(u.length>0?" "+u:u);continue}let p=!!f,g=n(p?d.substring(0,f):d);if(!g){if(!p||!(g=n(d))){u=t+(u.length>0?" "+u:u);continue}p=!1}let m=s(c).join(":"),y=h?m+"!":m,v=y+g;if(o.includes(v))continue;o.push(v);let w=i(g,p);for(let e=0;e<w.length;++e){let t=w[e];o.push(y+t)}u=t+(u.length>0?" "+u:u)}return u})(e,r);return a(e,n),n}return function(){return c(u.apply(null,arguments))}}(()=>{let e=h("color"),t=h("font"),r=h("text"),n=h("font-weight"),i=h("tracking"),s=h("leading"),o=h("breakpoint"),a=h("container"),l=h("spacing"),u=h("radius"),c=h("shadow"),d=h("inset-shadow"),f=h("drop-shadow"),p=h("blur"),g=h("perspective"),m=h("aspect"),y=h("ease"),v=h("animate"),w=()=>["auto","avoid","all","avoid-page","page","left","right","column"],C=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],k=()=>["auto","hidden","clip","visible","scroll"],A=()=>["auto","contain","none"],x=()=>[b,"px","full","auto",V,O,l],H=()=>[E,"none","subgrid",V,O],G=()=>["auto",{span:["full",E,V,O]},V,O],K=()=>[E,"auto",V,O],W=()=>["auto","min","max","fr",V,O],Q=()=>[V,O,l],Y=()=>["start","end","center","between","around","evenly","stretch","baseline"],X=()=>["start","end","center","stretch"],J=()=>[V,O,l],Z=()=>["px",...J()],ee=()=>["px","auto",...J()],et=()=>[b,"auto","px","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",V,O,l],er=()=>[e,V,O],en=()=>[I,D],ei=()=>["","none","full",u,V,O],es=()=>["",_,F,D],eo=()=>["solid","dashed","dotted","double"],ea=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],el=()=>["","none",p,V,O],eu=()=>["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",V,O],ec=()=>["none",_,V,O],eh=()=>["none",_,V,O],ed=()=>[_,V,O],ef=()=>[b,"full","px",V,O,l];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[T],breakpoint:[T],color:[S],container:[T],"drop-shadow":[T],ease:["in","out","in-out"],font:[R],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[T],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[T],shadow:[T],spacing:[_],text:[T],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",b,O,V,m]}],container:["container"],columns:[{columns:[_,O,V,a]}],"break-after":[{"break-after":w()}],"break-before":[{"break-before":w()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...C(),O,V]}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:x()}],"inset-x":[{"inset-x":x()}],"inset-y":[{"inset-y":x()}],start:[{start:x()}],end:[{end:x()}],top:[{top:x()}],right:[{right:x()}],bottom:[{bottom:x()}],left:[{left:x()}],visibility:["visible","invisible","collapse"],z:[{z:[E,"auto",V,O]}],basis:[{basis:[b,"full","auto",V,O,a,l]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[_,b,"auto","initial","none",O]}],grow:[{grow:["",_,V,O]}],shrink:[{shrink:["",_,V,O]}],order:[{order:[E,"first","last","none",V,O]}],"grid-cols":[{"grid-cols":H()}],"col-start-end":[{col:G()}],"col-start":[{"col-start":K()}],"col-end":[{"col-end":K()}],"grid-rows":[{"grid-rows":H()}],"row-start-end":[{row:G()}],"row-start":[{"row-start":K()}],"row-end":[{"row-end":K()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":W()}],"auto-rows":[{"auto-rows":W()}],gap:[{gap:Q()}],"gap-x":[{"gap-x":Q()}],"gap-y":[{"gap-y":Q()}],"justify-content":[{justify:[...Y(),"normal"]}],"justify-items":[{"justify-items":[...X(),"normal"]}],"justify-self":[{"justify-self":["auto",...X()]}],"align-content":[{content:["normal",...Y()]}],"align-items":[{items:[...X(),"baseline"]}],"align-self":[{self:["auto",...X(),"baseline"]}],"place-content":[{"place-content":Y()}],"place-items":[{"place-items":[...X(),"baseline"]}],"place-self":[{"place-self":["auto",...X()]}],p:[{p:Z()}],px:[{px:Z()}],py:[{py:Z()}],ps:[{ps:Z()}],pe:[{pe:Z()}],pt:[{pt:Z()}],pr:[{pr:Z()}],pb:[{pb:Z()}],pl:[{pl:Z()}],m:[{m:ee()}],mx:[{mx:ee()}],my:[{my:ee()}],ms:[{ms:ee()}],me:[{me:ee()}],mt:[{mt:ee()}],mr:[{mr:ee()}],mb:[{mb:ee()}],ml:[{ml:ee()}],"space-x":[{"space-x":J()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":J()}],"space-y-reverse":["space-y-reverse"],size:[{size:et()}],w:[{w:[a,"screen",...et()]}],"min-w":[{"min-w":[a,"screen","none",...et()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[o]},...et()]}],h:[{h:["screen",...et()]}],"min-h":[{"min-h":["screen","none",...et()]}],"max-h":[{"max-h":["screen",...et()]}],"font-size":[{text:["base",r,F,D]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,V,P]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",I,O]}],"font-family":[{font:[j,O,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,V,O]}],"line-clamp":[{"line-clamp":[_,"none",V,P]}],leading:[{leading:[V,O,s,l]}],"list-image":[{"list-image":["none",V,O]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",V,O]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:er()}],"text-color":[{text:er()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...eo(),"wavy"]}],"text-decoration-thickness":[{decoration:[_,"from-font","auto",V,D]}],"text-decoration-color":[{decoration:er()}],"underline-offset":[{"underline-offset":[_,"auto",V,O]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:["px",...J()]}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",V,O]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",V,O]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...C(),B,L]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","space","round"]}]}],"bg-size":[{bg:["auto","cover","contain",$,N]}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},E,V,O],radial:["",V,O],conic:[E,V,O]},z,M]}],"bg-color":[{bg:er()}],"gradient-from-pos":[{from:en()}],"gradient-via-pos":[{via:en()}],"gradient-to-pos":[{to:en()}],"gradient-from":[{from:er()}],"gradient-via":[{via:er()}],"gradient-to":[{to:er()}],rounded:[{rounded:ei()}],"rounded-s":[{"rounded-s":ei()}],"rounded-e":[{"rounded-e":ei()}],"rounded-t":[{"rounded-t":ei()}],"rounded-r":[{"rounded-r":ei()}],"rounded-b":[{"rounded-b":ei()}],"rounded-l":[{"rounded-l":ei()}],"rounded-ss":[{"rounded-ss":ei()}],"rounded-se":[{"rounded-se":ei()}],"rounded-ee":[{"rounded-ee":ei()}],"rounded-es":[{"rounded-es":ei()}],"rounded-tl":[{"rounded-tl":ei()}],"rounded-tr":[{"rounded-tr":ei()}],"rounded-br":[{"rounded-br":ei()}],"rounded-bl":[{"rounded-bl":ei()}],"border-w":[{border:es()}],"border-w-x":[{"border-x":es()}],"border-w-y":[{"border-y":es()}],"border-w-s":[{"border-s":es()}],"border-w-e":[{"border-e":es()}],"border-w-t":[{"border-t":es()}],"border-w-r":[{"border-r":es()}],"border-w-b":[{"border-b":es()}],"border-w-l":[{"border-l":es()}],"divide-x":[{"divide-x":es()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":es()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...eo(),"hidden","none"]}],"divide-style":[{divide:[...eo(),"hidden","none"]}],"border-color":[{border:er()}],"border-color-x":[{"border-x":er()}],"border-color-y":[{"border-y":er()}],"border-color-s":[{"border-s":er()}],"border-color-e":[{"border-e":er()}],"border-color-t":[{"border-t":er()}],"border-color-r":[{"border-r":er()}],"border-color-b":[{"border-b":er()}],"border-color-l":[{"border-l":er()}],"divide-color":[{divide:er()}],"outline-style":[{outline:[...eo(),"none","hidden"]}],"outline-offset":[{"outline-offset":[_,V,O]}],"outline-w":[{outline:["",_,F,D]}],"outline-color":[{outline:[e]}],shadow:[{shadow:["","none",c,q,U]}],"shadow-color":[{shadow:er()}],"inset-shadow":[{"inset-shadow":["none",V,O,d]}],"inset-shadow-color":[{"inset-shadow":er()}],"ring-w":[{ring:es()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:er()}],"ring-offset-w":[{"ring-offset":[_,D]}],"ring-offset-color":[{"ring-offset":er()}],"inset-ring-w":[{"inset-ring":es()}],"inset-ring-color":[{"inset-ring":er()}],opacity:[{opacity:[_,V,O]}],"mix-blend":[{"mix-blend":[...ea(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ea()}],filter:[{filter:["","none",V,O]}],blur:[{blur:el()}],brightness:[{brightness:[_,V,O]}],contrast:[{contrast:[_,V,O]}],"drop-shadow":[{"drop-shadow":["","none",f,V,O]}],grayscale:[{grayscale:["",_,V,O]}],"hue-rotate":[{"hue-rotate":[_,V,O]}],invert:[{invert:["",_,V,O]}],saturate:[{saturate:[_,V,O]}],sepia:[{sepia:["",_,V,O]}],"backdrop-filter":[{"backdrop-filter":["","none",V,O]}],"backdrop-blur":[{"backdrop-blur":el()}],"backdrop-brightness":[{"backdrop-brightness":[_,V,O]}],"backdrop-contrast":[{"backdrop-contrast":[_,V,O]}],"backdrop-grayscale":[{"backdrop-grayscale":["",_,V,O]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[_,V,O]}],"backdrop-invert":[{"backdrop-invert":["",_,V,O]}],"backdrop-opacity":[{"backdrop-opacity":[_,V,O]}],"backdrop-saturate":[{"backdrop-saturate":[_,V,O]}],"backdrop-sepia":[{"backdrop-sepia":["",_,V,O]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":J()}],"border-spacing-x":[{"border-spacing-x":J()}],"border-spacing-y":[{"border-spacing-y":J()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",V,O]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[_,"initial",V,O]}],ease:[{ease:["linear","initial",y,V,O]}],delay:[{delay:[_,V,O]}],animate:[{animate:["none",v,V,O]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[g,V,O]}],"perspective-origin":[{"perspective-origin":eu()}],rotate:[{rotate:ec()}],"rotate-x":[{"rotate-x":ec()}],"rotate-y":[{"rotate-y":ec()}],"rotate-z":[{"rotate-z":ec()}],scale:[{scale:eh()}],"scale-x":[{"scale-x":eh()}],"scale-y":[{"scale-y":eh()}],"scale-z":[{"scale-z":eh()}],"scale-3d":["scale-3d"],skew:[{skew:ed()}],"skew-x":[{"skew-x":ed()}],"skew-y":[{"skew-y":ed()}],transform:[{transform:[V,O,"","none","gpu","cpu"]}],"transform-origin":[{origin:eu()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ef()}],"translate-x":[{"translate-x":ef()}],"translate-y":[{"translate-y":ef()}],"translate-z":[{"translate-z":ef()}],"translate-none":["translate-none"],accent:[{accent:er()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:er()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",V,O]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":J()}],"scroll-mx":[{"scroll-mx":J()}],"scroll-my":[{"scroll-my":J()}],"scroll-ms":[{"scroll-ms":J()}],"scroll-me":[{"scroll-me":J()}],"scroll-mt":[{"scroll-mt":J()}],"scroll-mr":[{"scroll-mr":J()}],"scroll-mb":[{"scroll-mb":J()}],"scroll-ml":[{"scroll-ml":J()}],"scroll-p":[{"scroll-p":J()}],"scroll-px":[{"scroll-px":J()}],"scroll-py":[{"scroll-py":J()}],"scroll-ps":[{"scroll-ps":J()}],"scroll-pe":[{"scroll-pe":J()}],"scroll-pt":[{"scroll-pt":J()}],"scroll-pr":[{"scroll-pr":J()}],"scroll-pb":[{"scroll-pb":J()}],"scroll-pl":[{"scroll-pl":J()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",V,O]}],fill:[{fill:["none",...er()]}],"stroke-w":[{stroke:[_,F,D,P]}],stroke:[{stroke:["none",...er()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["before","after","placeholder","file","marker","selection","first-line","first-letter","backdrop","*","**"]}});function en(...e){return er(t(e))}e.s(["cn",()=>en],26683)},11398,e=>{"use strict";let t,r,n;var i=e.i(43476),s=e.i(71645);function o(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}var a=((n=s.forwardRef((e,t)=>{let{children:r,...n}=e;if(s.isValidElement(r)){var i;let e,a,l=(i=r,(a=(e=Object.getOwnPropertyDescriptor(i.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?i.ref:(a=(e=Object.getOwnPropertyDescriptor(i,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?i.props.ref:i.props.ref||i.ref),u=function(e,t){let r={...t};for(let n in t){let i=e[n],s=t[n];/^on[A-Z]/.test(n)?i&&s?r[n]=(...e)=>{let t=s(...e);return i(...e),t}:i&&(r[n]=i):"style"===n?r[n]={...i,...s}:"className"===n&&(r[n]=[i,s].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==s.Fragment&&(u.ref=t?function(...e){return t=>{let r=!1,n=e.map(e=>{let n=o(e,t);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let t=0;t<n.length;t++){let r=n[t];"function"==typeof r?r():o(e[t],null)}}}}(t,l):l),s.cloneElement(r,u)}return s.Children.count(r)>1?s.Children.only(null):null})).displayName="Slot.SlotClone",t=n,(r=s.forwardRef((e,r)=>{let{children:n,...o}=e,a=s.Children.toArray(n),l=a.find(u);if(l){let e=l.props.children,n=a.map(t=>t!==l?t:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,i.jsx)(t,{...o,ref:r,children:s.isValidElement(e)?s.cloneElement(e,void 0,n):null})}return(0,i.jsx)(t,{...o,ref:r,children:n})})).displayName="Slot.Slot",r),l=Symbol("radix.slottable");function u(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===l}var c=e.i(25913),h=e.i(26683);let d=(0,c.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),f=s.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...s},o)=>(0,i.jsx)(n?a:"button",{className:(0,h.cn)(d({variant:t,size:r,className:e})),ref:o,...s}));f.displayName="Button",e.s(["Button",()=>f],11398)},86318,e=>{"use strict";var t=e.i(71645);e.i(43476);var r=t.createContext(void 0);function n(e){let n=t.useContext(r);return e||n||"ltr"}e.s(["useDirection",()=>n])},68834,e=>{"use strict";var t=e.i(71645);let r=e=>{let t,r=new Set,n=(e,n)=>{let i="function"==typeof e?e(t):e;if(!Object.is(i,t)){let e=t;t=(null!=n?n:"object"!=typeof i||null===i)?i:Object.assign({},t,i),r.forEach(r=>r(t,e))}},i=()=>t,s={setState:n,getState:i,getInitialState:()=>o,subscribe:e=>(r.add(e),()=>r.delete(e))},o=t=e(n,i,s);return s},n=e=>{let n=e?r(e):r,i=e=>(function(e,r=e=>e){let n=t.default.useSyncExternalStore(e.subscribe,t.default.useCallback(()=>r(e.getState()),[e,r]),t.default.useCallback(()=>r(e.getInitialState()),[e,r]));return t.default.useDebugValue(n),n})(n,e);return Object.assign(i,n),i},i=e=>e?n(e):n;e.s(["create",()=>i],68834)},67034,(e,t,r)=>{var n={675:function(e,t){"use strict";t.byteLength=function(e){var t=l(e),r=t[0],n=t[1];return(r+n)*3/4-n},t.toByteArray=function(e){var t,r,s=l(e),o=s[0],a=s[1],u=new i((o+a)*3/4-a),c=0,h=a>0?o-4:o;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;return 2===a&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,u[c++]=255&t),1===a&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t),u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,s=[],o=0,a=n-i;o<a;o+=16383)s.push(function(e,t,n){for(var i,s=[],o=t;o<n;o+=3)i=(e[o]<<16&0xff0000)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(r[i>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}(e,o,o+16383>a?a:o+16383));return 1===i?s.push(r[(t=e[n-1])>>2]+r[t<<4&63]+"=="):2===i&&s.push(r[(t=(e[n-2]<<8)+e[n-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),s.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=s.length;o<a;++o)r[o]=s[o],n[s.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}n[45]=62,n[95]=63},72:function(e,t,r){"use strict";var n=r(675),i=r(783),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function o(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return c(e)}return l(e,t,r)}function l(e,t,r){if("string"==typeof e){var n=e,i=t;if(("string"!=typeof i||""===i)&&(i="utf8"),!a.isEncoding(i))throw TypeError("Unknown encoding: "+i);var s=0|f(n,i),l=o(s),u=l.write(n,i);return u!==s&&(l=l.slice(0,u)),l}if(ArrayBuffer.isView(e))return h(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(x(e,ArrayBuffer)||e&&x(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(x(e,SharedArrayBuffer)||e&&x(e.buffer,SharedArrayBuffer)))return function(e,t,r){var n;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),a.prototype),n}(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var c=e.valueOf&&e.valueOf();if(null!=c&&c!==e)return a.from(c,t,r);var p=function(e){if(a.isBuffer(e)){var t=0|d(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||function(e){return e!=e}(e.length)?o(0):h(e):"Buffer"===e.type&&Array.isArray(e.data)?h(e.data):void 0}(e);if(p)return p;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return u(e),o(e<0?0:0|d(e))}function h(e){for(var t=e.length<0?0:0|d(e.length),r=o(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}t.Buffer=a,t.SlowBuffer=function(e){return+e!=e&&(e=0),a.alloc(+e)},t.INSPECT_MAX_BYTES=50,t.kMaxLength=0x7fffffff,a.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,r){return l(e,t,r)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,r){return(u(e),e<=0)?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)},a.allocUnsafe=function(e){return c(e)},a.allocUnsafeSlow=function(e){return c(e)};function d(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function f(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||x(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return S(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return k(e).length;default:if(i)return n?-1:S(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){var i,s,o,a=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",s=t;s<r;++s)i+=R[e[s]];return i}(this,t,r);case"utf8":case"utf-8":return v(this,t,r);case"ascii":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}(this,t,r);case"latin1":case"binary":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}(this,t,r);case"base64":return i=this,s=t,o=r,0===s&&o===i.length?n.fromByteArray(i):n.fromByteArray(i.slice(s,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var n=e.slice(t,r),i="",s=0;s<n.length;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}(this,t,r);default:if(a)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function g(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,i){var s;if(0===e.length)return -1;if("string"==typeof r?(n=r,r=0):r>0x7fffffff?r=0x7fffffff:r<-0x80000000&&(r=-0x80000000),(s=r*=1)!=s&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length)if(i)return -1;else r=e.length-1;else if(r<0)if(!i)return -1;else r=0;if("string"==typeof t&&(t=a.from(t,n)),a.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,i);if("number"==typeof t){if(t&=255,"function"==typeof Uint8Array.prototype.indexOf)if(i)return Uint8Array.prototype.indexOf.call(e,t,r);else return Uint8Array.prototype.lastIndexOf.call(e,t,r);return y(e,[t],r,n,i)}throw TypeError("val must be string, number or Buffer")}function y(e,t,r,n,i){var s,o=1,a=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return -1;o=2,a/=2,l/=2,r/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var c=-1;for(s=r;s<a;s++)if(u(e,s)===u(t,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===l)return c*o}else -1!==c&&(s-=s-c),c=-1}else for(r+l>a&&(r=a-l),s=r;s>=0;s--){for(var h=!0,d=0;d<l;d++)if(u(e,s+d)!==u(t,d)){h=!1;break}if(h)return s}return -1}a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(x(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),x(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:+(n<r)},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;var r,n=a.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if(x(s,Uint8Array)&&(s=a.from(s)),!a.isBuffer(s))throw TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},a.byteLength=f,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},a.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?v(this,0,e):p.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},s&&(a.prototype[s]=a.prototype.inspect),a.prototype.compare=function(e,t,r,n,i){if(x(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;for(var s=i-n,o=r-t,l=Math.min(s,o),u=this.slice(n,i),c=e.slice(t,r),h=0;h<l;++h)if(u[h]!==c[h]){s=u[h],o=c[h];break}return s<o?-1:+(o<s)},a.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},a.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},a.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)};function v(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var s,o,a,l,u=e[i],c=null,h=u>239?4:u>223?3:u>191?2:1;if(i+h<=r)switch(h){case 1:u<128&&(c=u);break;case 2:(192&(s=e[i+1]))==128&&(l=(31&u)<<6|63&s)>127&&(c=l);break;case 3:s=e[i+1],o=e[i+2],(192&s)==128&&(192&o)==128&&(l=(15&u)<<12|(63&s)<<6|63&o)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:s=e[i+1],o=e[i+2],a=e[i+3],(192&s)==128&&(192&o)==128&&(192&a)==128&&(l=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&l<1114112&&(c=l)}null===c?(c=65533,h=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=h}var d=n,f=d.length;if(f<=4096)return String.fromCharCode.apply(String,d);for(var p="",g=0;g<f;)p+=String.fromCharCode.apply(String,d.slice(g,g+=4096));return p}function w(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function b(e,t,r,n,i,s){if(!a.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw RangeError('"value" argument is out of bounds');if(r+n>e.length)throw RangeError("Index out of range")}function _(e,t,r,n,i,s){if(r+n>e.length||r<0)throw RangeError("Index out of range")}function E(e,t,r,n,s){return t*=1,r>>>=0,s||_(e,t,r,4,34028234663852886e22,-34028234663852886e22),i.write(e,t,r,n,23,4),r+4}function I(e,t,r,n,s){return t*=1,r>>>=0,s||_(e,t,r,8,17976931348623157e292,-17976931348623157e292),i.write(e,t,r,n,52,8),r+8}a.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var i,s,o,a,l,u,c,h,d=this.length-t;if((void 0===r||r>d)&&(r=d),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var f=!1;;)switch(n){case"hex":return function(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var s=t.length;n>s/2&&(n=s/2);for(var o=0;o<n;++o){var a,l=parseInt(t.substr(2*o,2),16);if((a=l)!=a)break;e[r+o]=l}return o}(this,e,t,r);case"utf8":case"utf-8":return i=t,s=r,A(S(e,this.length-i),this,i,s);case"ascii":return o=t,a=r,A(C(e),this,o,a);case"latin1":case"binary":return function(e,t,r,n){return A(C(t),e,r,n)}(this,e,t,r);case"base64":return l=t,u=r,A(k(e),this,l,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return c=t,h=r,A(function(e,t){for(var r,n,i=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i.push(r%256),i.push(n);return i}(e,this.length-c),this,c,h);default:if(f)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),f=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},a.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,a.prototype),n},a.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n},a.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},a.prototype.readUInt8=function(e,t){return e>>>=0,t||w(e,1,this.length),this[e]},a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},a.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=t,i=1,s=this[e+--n];n>0&&(i*=256);)s+=this[e+--n]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*t)),s},a.prototype.readInt8=function(e,t){return(e>>>=0,t||w(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||w(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?0xffff0000|r:r},a.prototype.readInt16BE=function(e,t){e>>>=0,t||w(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?0xffff0000|r:r},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return e>>>=0,t||w(e,4,this.length),i.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||w(e,4,this.length),i.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||w(e,8,this.length),i.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||w(e,8,this.length),i.read(this,e,!1,52,8)},a.prototype.writeUIntLE=function(e,t,r,n){if(e*=1,t>>>=0,r>>>=0,!n){var i=Math.pow(2,8*r)-1;b(this,e,t,r,i,0)}var s=1,o=0;for(this[t]=255&e;++o<r&&(s*=256);)this[t+o]=e/s&255;return t+r},a.prototype.writeUIntBE=function(e,t,r,n){if(e*=1,t>>>=0,r>>>=0,!n){var i=Math.pow(2,8*r)-1;b(this,e,t,r,i,0)}var s=r-1,o=1;for(this[t+s]=255&e;--s>=0&&(o*=256);)this[t+s]=e/o&255;return t+r},a.prototype.writeUInt8=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUInt16LE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUInt16BE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUInt32LE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUInt32BE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeIntLE=function(e,t,r,n){if(e*=1,t>>>=0,!n){var i=Math.pow(2,8*r-1);b(this,e,t,r,i-1,-i)}var s=0,o=1,a=0;for(this[t]=255&e;++s<r&&(o*=256);)e<0&&0===a&&0!==this[t+s-1]&&(a=1),this[t+s]=(e/o|0)-a&255;return t+r},a.prototype.writeIntBE=function(e,t,r,n){if(e*=1,t>>>=0,!n){var i=Math.pow(2,8*r-1);b(this,e,t,r,i-1,-i)}var s=r-1,o=1,a=0;for(this[t+s]=255&e;--s>=0&&(o*=256);)e<0&&0===a&&0!==this[t+s+1]&&(a=1),this[t+s]=(e/o|0)-a&255;return t+r},a.prototype.writeInt8=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeFloatLE=function(e,t,r){return E(this,e,t,!0,r)},a.prototype.writeFloatBE=function(e,t,r){return E(this,e,t,!1,r)},a.prototype.writeDoubleLE=function(e,t,r){return I(this,e,t,!0,r)},a.prototype.writeDoubleBE=function(e,t,r){return I(this,e,t,!1,r)},a.prototype.copy=function(e,t,r,n){if(!a.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var s=i-1;s>=0;--s)e[s+t]=this[s+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return i},a.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw TypeError("Unknown encoding: "+n);if(1===e.length){var i,s=e.charCodeAt(0);("utf8"===n&&s<128||"latin1"===n)&&(e=s)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var o=a.isBuffer(e)?e:a.from(e,n),l=o.length;if(0===l)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%l]}return this};var T=/[^+/0-9A-Za-z-_]/g;function S(e,t){t=t||1/0;for(var r,n=e.length,i=null,s=[],o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319||o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return s}function C(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function k(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(T,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function A(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length)&&!(i>=e.length);++i)t[i+r]=e[i];return i}function x(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var R=function(){for(var e="0123456789abcdef",t=Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}()},783:function(e,t){t.read=function(e,t,r,n,i){var s,o,a=8*i-n-1,l=(1<<a)-1,u=l>>1,c=-7,h=r?i-1:0,d=r?-1:1,f=e[t+h];for(h+=d,s=f&(1<<-c)-1,f>>=-c,c+=a;c>0;s=256*s+e[t+h],h+=d,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=n;c>0;o=256*o+e[t+h],h+=d,c-=8);if(0===s)s=1-u;else{if(s===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,n),s-=u}return(f?-1:1)*o*Math.pow(2,s-n)},t.write=function(e,t,r,n,i,s){var o,a,l,u=8*s-i-1,c=(1<<u)-1,h=c>>1,d=5960464477539062e-23*(23===i),f=n?0:s-1,p=n?1:-1,g=+(t<0||0===t&&1/t<0);for(isNaN(t=Math.abs(t))||t===1/0?(a=+!!isNaN(t),o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+h>=1?t+=d/l:t+=d*Math.pow(2,1-h),t*l>=2&&(o++,l/=2),o+h>=c?(a=0,o=c):o+h>=1?(a=(t*l-1)*Math.pow(2,i),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[r+f]=255&a,f+=p,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;e[r+f]=255&o,f+=p,o/=256,u-=8);e[r+f-p]|=128*g}}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={exports:{}},o=!0;try{n[e](r,r.exports,s),o=!1}finally{o&&delete i[e]}return r.exports}s.ab="/ROOT/node_modules/next/dist/compiled/buffer/",t.exports=s(72)},36180,17875,90571,51718,41264,30450,e=>{"use strict";let t,r,n;var i,s,o,a,l,u,c,h,d,f,p,g,m,y,v,w,b,_,E,I,T,S=e.i(47167),C=e.i(67034);let k=function(e){let t=[],r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:((64512&i)==55296&&n+1<e.length&&(64512&e.charCodeAt(n+1))==56320?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++n)),t[r++]=i>>18|240,t[r++]=i>>12&63|128):t[r++]=i>>12|224,t[r++]=i>>6&63|128),t[r++]=63&i|128)}return t},A=function(e){let t=[],r=0,n=0;for(;r<e.length;){let i=e[r++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){let s=e[r++];t[n++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){let s=((7&i)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else{let s=e[r++],o=e[r++];t[n++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")},x={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let t=0;t<e.length;t+=3){let i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,l=a?e[t+2]:0,u=i>>2,c=(3&i)<<4|o>>4,h=(15&o)<<2|l>>6,d=63&l;!a&&(d=64,s||(h=64)),n.push(r[u],r[c],r[h],r[d])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(k(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):A(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let t=0;t<e.length;){let i=r[e.charAt(t++)],s=t<e.length?r[e.charAt(t)]:0,o=++t<e.length?r[e.charAt(t)]:64,a=++t<e.length?r[e.charAt(t)]:64;if(++t,null==i||null==s||null==o||null==a)throw new R;let l=i<<2|s>>4;if(n.push(l),64!==o){let e=s<<4&240|o>>2;if(n.push(e),64!==a){let e=o<<6&192|a;n.push(e)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class R extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let N=function(e){let t=k(e);return x.encodeByteArray(t,!0)},O=function(e){return N(e).replace(/\./g,"")},D=function(e){try{return x.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},P=()=>{try{return("undefined"!=typeof self?self:"undefined"!=typeof window?window:e.g).__FIREBASE_DEFAULTS__||(()=>{if(void 0===S.default||void 0===S.default.env)return;let e=S.default.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)})()||(()=>{let e;if("undefined"==typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let t=e&&D(e[1]);return t&&JSON.parse(t)})()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},L=e=>{var t,r;return null==(r=null==(t=P())?void 0:t.emulatorHosts)?void 0:r[e]},M=e=>{let t=L(e);if(!t)return;let r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let n=parseInt(t.substring(r+1),10);return"["===t[0]?[t.substring(1,r-1),n]:[t.substring(0,r),n]},U=()=>{var e;return null==(e=P())?void 0:e.config},V=e=>{var t;return null==(t=P())?void 0:t[`_${e}`]};class F{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,r))}}}function j(e){return e.endsWith(".cloudworkstations.dev")}async function B(e){return(await fetch(e,{credentials:"include"})).ok}function $(e,t){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let r=t||"demo-project",n=e.iat||0,i=e.sub||e.user_id;if(!i)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:n,exp:n+3600,auth_time:n,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[O(JSON.stringify({alg:"none",type:"JWT"})),O(JSON.stringify(s)),""].join(".")}let z={},q=!1;function H(e,t){if("undefined"==typeof window||"undefined"==typeof document||!j(window.location.host)||z[e]===t||z[e]||q)return;function r(e){return`__firebase__banner__${e}`}z[e]=t;let n="__firebase__banner",i=function(){let e={prod:[],emulator:[]};for(let t of Object.keys(z))z[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){let e,t,s=(e=document.getElementById(n),t=!1,e||((e=document.createElement("div")).setAttribute("id",n),t=!0),{created:t,element:e}),o=r("text"),a=document.getElementById(o)||document.createElement("span"),l=r("learnmore"),u=document.getElementById(l)||document.createElement("a"),c=r("preprendIcon"),h=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(s.created){let e,t=s.element;t.style.display="flex",t.style.background="#7faaf0",t.style.position="fixed",t.style.bottom="5px",t.style.left="5px",t.style.padding=".5em",t.style.borderRadius="5px",t.style.alignItems="center",u.setAttribute("id",l),u.innerText="Learn more",u.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",u.setAttribute("target","__blank"),u.style.paddingLeft="5px",u.style.textDecoration="underline";let r=((e=document.createElement("span")).style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{let e;q=!0,(e=document.getElementById(n))&&e.remove()},e);h.setAttribute("width","24"),h.setAttribute("id",c),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px",t.append(h,a,u,r),document.body.appendChild(t)}i?(a.innerText="Preview backend disconnected.",h.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(h.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,a.innerText="Preview backend running in this workspace."),a.setAttribute("id",o)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",s):s()}function G(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function K(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}class W extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,W.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Q.prototype.create)}}class Q{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){var r,n;let i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],a=o?(r=o,n=i,r.replace(Y,(e,t)=>{let r=n[t];return null!=r?String(r):`<${t}?>`})):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new W(s,l,i)}}let Y=/\{\$([^}]+)}/g;function X(e,t){if(e===t)return!0;let r=Object.keys(e),n=Object.keys(t);for(let i of r){if(!n.includes(i))return!1;let r=e[i],s=t[i];if(J(r)&&J(s)){if(!X(r,s))return!1}else if(r!==s)return!1}for(let e of n)if(!r.includes(e))return!1;return!0}function J(e){return null!==e&&"object"==typeof e}function Z(e){let t=[];for(let[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(e=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function ee(e){let t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){let[r,n]=e.split("=");t[decodeURIComponent(r)]=decodeURIComponent(n)}}),t}function et(e){let t=e.indexOf("?");if(!t)return"";let r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)}class er{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let n;if(void 0===e&&void 0===t&&void 0===r)throw Error("Missing Observer.");void 0===(n=!function(e,t){if("object"!=typeof e||null===e)return!1;for(let r of t)if(r in e&&"function"==typeof e[r])return!0;return!1}(e,["next","error","complete"])?{next:e,error:t,complete:r}:e).next&&(n.next=en),void 0===n.error&&(n.error=en),void 0===n.complete&&(n.complete=en);let i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?n.error(this.finalError):n.complete()}catch(e){}}),this.observers.push(n),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function en(){}function ei(e){return e&&e._delegate?e._delegate:e}class es{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}let eo="[DEFAULT]";class ea{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new F;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&e.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),n=null!=(t=null==e?void 0:e.optional)&&t;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(e){if(n)return null;throw e}if(n)return null;throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:eo})}catch(e){}for(let[e,t]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:r});t.resolve(e)}catch(e){}}}}clearInstance(e=eo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=eo){return this.instances.has(e)}getOptions(e=eo){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let n=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[e,t]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(e)&&t.resolve(n);return n}onInit(e,t){var r;let n=this.normalizeInstanceIdentifier(t),i=null!=(r=this.onInitCallbacks.get(n))?r:new Set;i.add(e),this.onInitCallbacks.set(n,i);let s=this.instances.get(n);return s&&e(s,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let n of r)try{n(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){var r;let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e)===eo?void 0:r,options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}return n||null}normalizeInstanceIdentifier(e=eo){return this.component?this.component.multipleInstances?e:eo:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class el{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new ea(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}let eu=[];(i=l||(l={}))[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT";let ec={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},eh=l.INFO,ed={[l.DEBUG]:"log",[l.VERBOSE]:"log",[l.INFO]:"info",[l.WARN]:"warn",[l.ERROR]:"error"},ef=(e,t,...r)=>{if(t<e.logLevel)return;let n=new Date().toISOString(),i=ed[t];if(i)console[i](`[${n}]  ${e.name}:`,...r);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class ep{constructor(e){this.name=e,this._logLevel=eh,this._logHandler=ef,this._userLogHandler=null,eu.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in l))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?ec[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,l.DEBUG,...e),this._logHandler(this,l.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,l.VERBOSE,...e),this._logHandler(this,l.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,l.INFO,...e),this._logHandler(this,l.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,l.WARN,...e),this._logHandler(this,l.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,l.ERROR,...e),this._logHandler(this,l.ERROR,...e)}}let eg=new WeakMap,em=new WeakMap,ey=new WeakMap,ev=new WeakMap,ew=new WeakMap,eb={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return em.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ey.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return e_(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function e_(e){if(e instanceof IDBRequest){let t;return(t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(e_(e.result)),n()},s=()=>{r(e.error),n()};e.addEventListener("success",i),e.addEventListener("error",s)})).then(t=>{t instanceof IDBCursor&&eg.set(t,e)}).catch(()=>{}),ew.set(t,e),t}if(ev.has(e))return ev.get(e);let n=function(e){if("function"==typeof e)return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(eE(this),t),e_(eg.get(this))}:function(...t){return e_(e.apply(eE(this),t))}:function(t,...r){let n=e.call(eE(this),t,...r);return ey.set(n,t.sort?t.sort():[t]),e_(n)};return e instanceof IDBTransaction&&function(e){if(em.has(e))return;let t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),n()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});em.set(e,t)}(e),(t||(t=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(t=>e instanceof t)?new Proxy(e,eb):e}(e);return n!==e&&(ev.set(e,n),ew.set(n,e)),n}let eE=e=>ew.get(e),eI=["get","getKey","getAll","getAllKeys","count"],eT=["put","add","delete","clear"],eS=new Map;function eC(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(eS.get(t))return eS.get(t);let r=t.replace(/FromIndex$/,""),n=t!==r,i=eT.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||eI.includes(r)))return;let s=async function(e,...t){let s=this.transaction(e,i?"readwrite":"readonly"),o=s.store;return n&&(o=o.index(t.shift())),(await Promise.all([o[r](...t),i&&s.done]))[0]};return eS.set(t,s),s}eb={...n=eb,get:(e,t,r)=>eC(e,t)||n.get(e,t,r),has:(e,t)=>!!eC(e,t)||n.has(e,t)};class ek{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{let t;if((null==(t=e.getComponent())?void 0:t.type)!=="VERSION")return null;{let t=e.getImmediate();return`${t.library}/${t.version}`}}).filter(e=>e).join(" ")}}let eA="@firebase/app",ex="0.13.1",eR=new ep("@firebase/app"),eN="[DEFAULT]",eO={[eA]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},eD=new Map,eP=new Map,eL=new Map;function eM(e,t){try{e.container.addComponent(t)}catch(r){eR.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function eU(e,t){e.container.addOrOverwriteComponent(t)}function eV(e){let t=e.name;if(eL.has(t))return eR.debug(`There were multiple attempts to register component ${t}.`),!1;for(let r of(eL.set(t,e),eD.values()))eM(r,e);for(let t of eP.values())eM(t,e);return!0}function eF(e,t){let r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function ej(e,t,r=eN){eF(e,t).clearInstance(r)}function eB(e){return void 0!==e.options}function e$(e){return null!=e&&void 0!==e.settings}function ez(){eL.clear()}let eq=new Q("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class eH{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new es("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw eq.create("app-deleted",{appName:this._name})}}function eG(e,t){let r=D(e.split(".")[1]);null===r?console.error(`FirebaseServerApp ${t} is invalid: second part could not be parsed.`):void 0===JSON.parse(r).exp?console.error(`FirebaseServerApp ${t} is invalid: expiration claim could not be parsed`):1e3*JSON.parse(r).exp-new Date().getTime()<=0&&console.error(`FirebaseServerApp ${t} is invalid: the token has expired.`)}class eK extends eH{constructor(e,t,r,n){const i=void 0===t.automaticDataCollectionEnabled||t.automaticDataCollectionEnabled,s={name:r,automaticDataCollectionEnabled:i};void 0!==e.apiKey?super(e,s,n):super(e.options,s,n),this._serverConfig=Object.assign({automaticDataCollectionEnabled:i},t),this._serverConfig.authIdToken&&eG(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&eG(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,"undefined"!=typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,e0(eA,ex,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){eZ(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw eq.create("server-app-deleted")}}let eW="11.9.0";function eQ(e,t={}){let r=e;"object"!=typeof t&&(t={name:t});let n=Object.assign({name:eN,automaticDataCollectionEnabled:!0},t),i=n.name;if("string"!=typeof i||!i)throw eq.create("bad-app-name",{appName:String(i)});if(r||(r=U()),!r)throw eq.create("no-options");let s=eD.get(i);if(s)if(X(r,s.options)&&X(n,s.config))return s;else throw eq.create("duplicate-app",{appName:i});let o=new el(i);for(let e of eL.values())o.addComponent(e);let a=new eH(r,n,o);return eD.set(i,a),a}function eY(e,t){let r;if(("undefined"!=typeof window||K())&&!K())throw eq.create("invalid-server-app-environment");void 0===t.automaticDataCollectionEnabled&&(t.automaticDataCollectionEnabled=!0),r=eB(e)?e.options:e;let n=Object.assign(Object.assign({},t),r);if(void 0!==n.releaseOnDeref&&delete n.releaseOnDeref,void 0!==t.releaseOnDeref&&"undefined"==typeof FinalizationRegistry)throw eq.create("finalization-registry-not-supported",{});let i=""+[...JSON.stringify(n)].reduce((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0,0),s=eP.get(i);if(s)return s.incRefCount(t.releaseOnDeref),s;let o=new el(i);for(let e of eL.values())o.addComponent(e);let a=new eK(r,t,i,o);return eP.set(i,a),a}function eX(e=eN){let t=eD.get(e);if(!t&&e===eN&&U())return eQ();if(!t)throw eq.create("no-app",{appName:e});return t}function eJ(){return Array.from(eD.values())}async function eZ(e){let t=!1,r=e.name;eD.has(r)?(t=!0,eD.delete(r)):eP.has(r)&&0>=e.decRefCount()&&(eP.delete(r),t=!0),t&&(await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function e0(e,t,r){var n;let i=null!=(n=eO[e])?n:e;r&&(i+=`-${r}`);let s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){let e=[`Unable to register library "${i}" with version "${t}":`];s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),eR.warn(e.join(" "));return}eV(new es(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}function e1(e,t){if(null!==e&&"function"!=typeof e)throw eq.create("invalid-log-argument");for(let r of eu){let n=null;t&&t.level&&(n=ec[t.level]),null===e?r.userLogHandler=null:r.userLogHandler=(t,r,...i)=>{let s=i.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}}).filter(e=>e).join(" ");r>=(null!=n?n:t.logLevel)&&e({level:l[r].toLowerCase(),message:s,args:i,type:t.name})}}}function e2(e){eu.forEach(t=>{t.setLogLevel(e)})}let e6="firebase-heartbeat-store",e3=null;function e5(){return e3||(e3=(function(e,t,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){let o=indexedDB.open(e,1),a=e_(o);return n&&o.addEventListener("upgradeneeded",e=>{n(e_(o.result),e.oldVersion,e.newVersion,e_(o.transaction),e)}),r&&o.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a})("firebase-heartbeat-database",0,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(e6)}catch(e){console.warn(e)}}}).catch(e=>{throw eq.create("idb-open",{originalErrorMessage:e.message})})),e3}async function e4(e){try{let t=(await e5()).transaction(e6),r=await t.objectStore(e6).get(e7(e));return await t.done,r}catch(e){if(e instanceof W)eR.warn(e.message);else{let t=eq.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});eR.warn(t.message)}}}async function e8(e,t){try{let r=(await e5()).transaction(e6,"readwrite"),n=r.objectStore(e6);await n.put(t,e7(e)),await r.done}catch(e){if(e instanceof W)eR.warn(e.message);else{let t=eq.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});eR.warn(t.message)}}}function e7(e){return`${e.name}!${e.options.appId}`}class e9{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new tt(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{let r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=te();if((null==(e=this._heartbeatsCache)?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,(null==(t=this._heartbeatsCache)?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(e=>e.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>30){let e=function(e){if(0===e.length)return -1;let t=0,r=e[0].date;for(let n=1;n<e.length;n++)e[n].date<r&&(r=e[n].date,t=n);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){eR.warn(e)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,(null==(e=this._heartbeatsCache)?void 0:e.heartbeats)==null||0===this._heartbeatsCache.heartbeats.length)return"";let t=te(),{heartbeatsToSend:r,unsentEntries:n}=function(e,t=1024){let r=[],n=e.slice();for(let i of e){let e=r.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),tr(r)>t){e.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),tr(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}(this._heartbeatsCache.heartbeats),i=O(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return eR.warn(e),""}}}function te(){return new Date().toISOString().substring(0,10)}class tt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"==typeof indexedDB}catch(e){return!1}}()&&new Promise((e,t)=>{try{let r=!0,n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var e;t((null==(e=i.error)?void 0:e.message)||"")}}catch(e){t(e)}}).then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let e=await e4(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){let r=await this.read();return e8(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){let r=await this.read();return e8(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}}}function tr(e){return O(JSON.stringify({version:2,heartbeats:e})).length}eV(new es("platform-logger",e=>new ek(e),"PRIVATE")),eV(new es("heartbeat",e=>new e9(e),"PRIVATE")),e0(eA,ex,""),e0(eA,ex,"esm2017"),e0("fire-js",""),e.s(["SDK_VERSION",()=>eW,"_DEFAULT_ENTRY_NAME",()=>eN,"_addComponent",()=>eM,"_addOrOverwriteComponent",()=>eU,"_apps",()=>eD,"_clearComponents",()=>ez,"_components",()=>eL,"_getProvider",()=>eF,"_isFirebaseApp",()=>eB,"_isFirebaseServerApp",()=>e$,"_registerComponent",()=>eV,"_removeServiceInstance",()=>ej,"_serverApps",()=>eP,"deleteApp",()=>eZ,"getApp",()=>eX,"getApps",()=>eJ,"initializeApp",()=>eQ,"initializeServerApp",()=>eY,"onLog",()=>e1,"registerVersion",()=>e0,"setLogLevel",()=>e2],85086);var tn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:e.g,ti={};(function(){function e(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.B=Array(this.blockSize),this.o=this.h=0,this.s()}var t=function(){this.blockSize=-1};function r(){}function n(e,t,r){r||(r=0);var n=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)n[i]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(i=0;16>i;++i)n[i]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^r&(i^s))+n[0]+0xd76aa478|0;o=s+(i^(t=r+(o<<7|o>>>25))&(r^i))+n[1]+0xe8c7b756|0,o=i+(r^(s=t+(o<<12|o>>>20))&(t^r))+n[2]+0x242070db|0,o=r+(t^(i=s+(o<<17|o>>>15))&(s^t))+n[3]+0xc1bdceee|0,o=t+(s^(r=i+(o<<22|o>>>10))&(i^s))+n[4]+0xf57c0faf|0,o=s+(i^(t=r+(o<<7|o>>>25))&(r^i))+n[5]+0x4787c62a|0,o=i+(r^(s=t+(o<<12|o>>>20))&(t^r))+n[6]+0xa8304613|0,o=r+(t^(i=s+(o<<17|o>>>15))&(s^t))+n[7]+0xfd469501|0,o=t+(s^(r=i+(o<<22|o>>>10))&(i^s))+n[8]+0x698098d8|0,o=s+(i^(t=r+(o<<7|o>>>25))&(r^i))+n[9]+0x8b44f7af|0,o=i+(r^(s=t+(o<<12|o>>>20))&(t^r))+n[10]+0xffff5bb1|0,o=r+(t^(i=s+(o<<17|o>>>15))&(s^t))+n[11]+0x895cd7be|0,o=t+(s^(r=i+(o<<22|o>>>10))&(i^s))+n[12]+0x6b901122|0,o=s+(i^(t=r+(o<<7|o>>>25))&(r^i))+n[13]+0xfd987193|0,o=i+(r^(s=t+(o<<12|o>>>20))&(t^r))+n[14]+0xa679438e|0,o=r+(t^(i=s+(o<<17|o>>>15))&(s^t))+n[15]+0x49b40821|0,r=i+(o<<22|o>>>10),o=t+(i^s&(r^i))+n[1]+0xf61e2562|0,t=r+(o<<5|o>>>27),o=s+(r^i&(t^r))+n[6]+0xc040b340|0,s=t+(o<<9|o>>>23),o=i+(t^r&(s^t))+n[11]+0x265e5a51|0,i=s+(o<<14|o>>>18),o=r+(s^t&(i^s))+n[0]+0xe9b6c7aa|0,r=i+(o<<20|o>>>12),o=t+(i^s&(r^i))+n[5]+0xd62f105d|0,t=r+(o<<5|o>>>27),o=s+(r^i&(t^r))+n[10]+0x2441453|0,s=t+(o<<9|o>>>23),o=i+(t^r&(s^t))+n[15]+0xd8a1e681|0,i=s+(o<<14|o>>>18),o=r+(s^t&(i^s))+n[4]+0xe7d3fbc8|0,r=i+(o<<20|o>>>12),o=t+(i^s&(r^i))+n[9]+0x21e1cde6|0,t=r+(o<<5|o>>>27),o=s+(r^i&(t^r))+n[14]+0xc33707d6|0,s=t+(o<<9|o>>>23),o=i+(t^r&(s^t))+n[3]+0xf4d50d87|0,i=s+(o<<14|o>>>18),o=r+(s^t&(i^s))+n[8]+0x455a14ed|0,r=i+(o<<20|o>>>12),o=t+(i^s&(r^i))+n[13]+0xa9e3e905|0,t=r+(o<<5|o>>>27),o=s+(r^i&(t^r))+n[2]+0xfcefa3f8|0,s=t+(o<<9|o>>>23),o=i+(t^r&(s^t))+n[7]+0x676f02d9|0,i=s+(o<<14|o>>>18),o=r+(s^t&(i^s))+n[12]+0x8d2a4c8a|0,o=t+((r=i+(o<<20|o>>>12))^i^s)+n[5]+0xfffa3942|0,o=s+((t=r+(o<<4|o>>>28))^r^i)+n[8]+0x8771f681|0,o=i+((s=t+(o<<11|o>>>21))^t^r)+n[11]+0x6d9d6122|0,o=r+((i=s+(o<<16|o>>>16))^s^t)+n[14]+0xfde5380c|0,o=t+((r=i+(o<<23|o>>>9))^i^s)+n[1]+0xa4beea44|0,o=s+((t=r+(o<<4|o>>>28))^r^i)+n[4]+0x4bdecfa9|0,o=i+((s=t+(o<<11|o>>>21))^t^r)+n[7]+0xf6bb4b60|0,o=r+((i=s+(o<<16|o>>>16))^s^t)+n[10]+0xbebfbc70|0,o=t+((r=i+(o<<23|o>>>9))^i^s)+n[13]+0x289b7ec6|0,o=s+((t=r+(o<<4|o>>>28))^r^i)+n[0]+0xeaa127fa|0,o=i+((s=t+(o<<11|o>>>21))^t^r)+n[3]+0xd4ef3085|0,o=r+((i=s+(o<<16|o>>>16))^s^t)+n[6]+0x4881d05|0,o=t+((r=i+(o<<23|o>>>9))^i^s)+n[9]+0xd9d4d039|0,o=s+((t=r+(o<<4|o>>>28))^r^i)+n[12]+0xe6db99e5|0,o=i+((s=t+(o<<11|o>>>21))^t^r)+n[15]+0x1fa27cf8|0,o=r+((i=s+(o<<16|o>>>16))^s^t)+n[2]+0xc4ac5665|0,r=i+(o<<23|o>>>9),o=t+(i^(r|~s))+n[0]+0xf4292244|0,t=r+(o<<6|o>>>26),o=s+(r^(t|~i))+n[7]+0x432aff97|0,s=t+(o<<10|o>>>22),o=i+(t^(s|~r))+n[14]+0xab9423a7|0,i=s+(o<<15|o>>>17),o=r+(s^(i|~t))+n[5]+0xfc93a039|0,r=i+(o<<21|o>>>11),o=t+(i^(r|~s))+n[12]+0x655b59c3|0,t=r+(o<<6|o>>>26),o=s+(r^(t|~i))+n[3]+0x8f0ccc92|0,s=t+(o<<10|o>>>22),o=i+(t^(s|~r))+n[10]+0xffeff47d|0,i=s+(o<<15|o>>>17),o=r+(s^(i|~t))+n[1]+0x85845dd1|0,r=i+(o<<21|o>>>11),o=t+(i^(r|~s))+n[8]+0x6fa87e4f|0,t=r+(o<<6|o>>>26),o=s+(r^(t|~i))+n[15]+0xfe2ce6e0|0,s=t+(o<<10|o>>>22),o=i+(t^(s|~r))+n[6]+0xa3014314|0,i=s+(o<<15|o>>>17),o=r+(s^(i|~t))+n[13]+0x4e0811a1|0,r=i+(o<<21|o>>>11),o=t+(i^(r|~s))+n[4]+0xf7537e82|0,t=r+(o<<6|o>>>26),o=s+(r^(t|~i))+n[11]+0xbd3af235|0,s=t+(o<<10|o>>>22),o=i+(t^(s|~r))+n[2]+0x2ad7d2bb|0,i=s+(o<<15|o>>>17),o=r+(s^(i|~t))+n[9]+0xeb86d391|0,e.g[0]=e.g[0]+t|0,e.g[1]=e.g[1]+(i+(o<<21|o>>>11))|0,e.g[2]=e.g[2]+i|0,e.g[3]=e.g[3]+s|0}function i(e,t){this.h=t;for(var r=[],n=!0,i=e.length-1;0<=i;i--){var s=0|e[i];n&&s==t||(r[i]=s,n=!1)}this.g=r}r.prototype=t.prototype,e.D=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.C=function(e,r,n){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[r].apply(e,i)},e.prototype.s=function(){this.g[0]=0x67452301,this.g[1]=0xefcdab89,this.g[2]=0x98badcfe,this.g[3]=0x10325476,this.o=this.h=0},e.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,s=this.h,o=0;o<t;){if(0==s)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"==typeof e){for(;o<t;)if(i[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<t;)if(i[s++]=e[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},e.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var r=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&r,r/=256;for(this.u(e),e=Array(16),t=r=0;4>t;++t)for(var n=0;32>n;n+=8)e[r++]=this.g[t]>>>n&255;return e};var s,o={};function a(e){var t;return -128<=e&&128>e?(t=function(e){return new i([0|e],0>e?-1:0)},Object.prototype.hasOwnProperty.call(o,e)?o[e]:o[e]=t(e)):new i([0|e],0>e?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return h;if(0>e)return m(l(-e));for(var t=[],r=1,n=0;e>=r;n++)t[n]=e/r|0,r*=0x100000000;return new i(t,0)}var h=a(0),d=a(1),f=a(0x1000000);function p(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function g(e){return -1==e.h}function m(e){for(var t=e.g.length,r=[],n=0;n<t;n++)r[n]=~e.g[n];return new i(r,~e.h).add(d)}function y(e,t){return e.add(m(t))}function v(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function w(e,t){this.g=e,this.h=t}function b(e,t){if(p(t))throw Error("division by zero");if(p(e))return new w(h,h);if(g(e))return t=b(m(e),t),new w(m(t.g),m(t.h));if(g(t))return t=b(e,m(t)),new w(m(t.g),t.h);if(30<e.g.length){if(g(e)||g(t))throw Error("slowDivide_ only works with positive integers.");for(var r=d,n=t;0>=n.l(e);)r=_(r),n=_(n);var i=E(r,1),s=E(n,1);for(n=E(n,2),r=E(r,2);!p(n);){var o=s.add(n);0>=o.l(e)&&(i=i.add(r),s=o),n=E(n,1),r=E(r,1)}return t=y(e,i.j(t)),new w(i,t)}for(i=h;0<=e.l(t);){for(n=48>=(n=Math.ceil(Math.log(r=Math.max(1,Math.floor(e.m()/t.m())))/Math.LN2))?1:Math.pow(2,n-48),o=(s=l(r)).j(t);g(o)||0<o.l(e);)r-=n,o=(s=l(r)).j(t);p(s)&&(s=d),i=i.add(s),e=y(e,o)}return new w(i,e)}function _(e){for(var t=e.g.length+1,r=[],n=0;n<t;n++)r[n]=e.i(n)<<1|e.i(n-1)>>>31;return new i(r,e.h)}function E(e,t){var r=t>>5;t%=32;for(var n=e.g.length-r,s=[],o=0;o<n;o++)s[o]=0<t?e.i(o+r)>>>t|e.i(o+r+1)<<32-t:e.i(o+r);return new i(s,e.h)}(s=i.prototype).m=function(){if(g(this))return-m(this).m();for(var e=0,t=1,r=0;r<this.g.length;r++){var n=this.i(r);e+=(0<=n?n:0x100000000+n)*t,t*=0x100000000}return e},s.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(p(this))return"0";if(g(this))return"-"+m(this).toString(e);for(var t=l(Math.pow(e,6)),r=this,n="";;){var i=b(r,t).g,s=((0<(r=y(r,i.j(t))).g.length?r.g[0]:r.h)>>>0).toString(e);if(p(r=i))return s+n;for(;6>s.length;)s="0"+s;n=s+n}},s.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},s.l=function(e){return g(e=y(this,e))?-1:+!p(e)},s.abs=function(){return g(this)?m(this):this},s.add=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0,s=0;s<=t;s++){var o=n+(65535&this.i(s))+(65535&e.i(s)),a=(o>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);n=a>>>16,o&=65535,a&=65535,r[s]=a<<16|o}return new i(r,-0x80000000&r[r.length-1]?-1:0)},s.j=function(e){if(p(this)||p(e))return h;if(g(this))return g(e)?m(this).j(m(e)):m(m(this).j(e));if(g(e))return m(this.j(m(e)));if(0>this.l(f)&&0>e.l(f))return l(this.m()*e.m());for(var t=this.g.length+e.g.length,r=[],n=0;n<2*t;n++)r[n]=0;for(n=0;n<this.g.length;n++)for(var s=0;s<e.g.length;s++){var o=this.i(n)>>>16,a=65535&this.i(n),u=e.i(s)>>>16,c=65535&e.i(s);r[2*n+2*s]+=a*c,v(r,2*n+2*s),r[2*n+2*s+1]+=o*c,v(r,2*n+2*s+1),r[2*n+2*s+1]+=a*u,v(r,2*n+2*s+1),r[2*n+2*s+2]+=o*u,v(r,2*n+2*s+2)}for(n=0;n<t;n++)r[n]=r[2*n+1]<<16|r[2*n];for(n=t;n<2*t;n++)r[n]=0;return new i(r,0)},s.A=function(e){return b(this,e).h},s.and=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.i(n)&e.i(n);return new i(r,this.h&e.h)},s.or=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.i(n)|e.i(n);return new i(r,this.h|e.h)},s.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.i(n)^e.i(n);return new i(r,this.h^e.h)},e.prototype.digest=e.prototype.v,e.prototype.reset=e.prototype.s,e.prototype.update=e.prototype.u,c=ti.Md5=e,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=l,i.fromString=function e(t,r){if(0==t.length)throw Error("number format error: empty string");if(2>(r=r||10)||36<r)throw Error("radix out of range: "+r);if("-"==t.charAt(0))return m(e(t.substring(1),r));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=l(Math.pow(r,8)),i=h,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),r);8>o?(o=l(Math.pow(r,o)),i=i.j(o).add(l(a))):i=(i=i.j(n)).add(l(a))}return i},u=ti.Integer=i}).apply(void 0!==tn?tn:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var ts="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:e.g,to={};(function(){var e,t,r,n="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e},i=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof ts&&ts];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);!function(e,t){if(t)e:{var r=i;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in r))break e;r=r[o]}(t=t(s=r[e=e[e.length-1]]))!=s&&null!=t&&n(r,e,{configurable:!0,writable:!0,value:t})}}("Array.prototype.values",function(e){return e||function(){var e,t,r,n,i;return e=this,t=function(e,t){return t},e instanceof String&&(e+=""),r=0,n=!1,(i={next:function(){if(!n&&r<e.length){var i=r++;return{value:t(i,e[i]),done:!1}}return n=!0,{done:!0,value:void 0}}})[Symbol.iterator]=function(){return i},i}});var s=s||{},o=this||self;function a(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function l(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function u(e,t,r){return e.call.apply(e.bind,arguments)}function c(e,t,r){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),e.apply(t,r)}}return function(){return e.apply(t,arguments)}}function w(e,t,r){return(w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?u:c).apply(null,arguments)}function b(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function _(e,t){function r(){}r.prototype=t.prototype,e.aa=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.Qb=function(e,r,n){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[r].apply(e,i)}}function E(e){let t=e.length;if(0<t){let r=Array(t);for(let n=0;n<t;n++)r[n]=e[n];return r}return[]}function I(e,t){for(let t=1;t<arguments.length;t++){let r=arguments[t];if(a(r)){let t=e.length||0,n=r.length||0;e.length=t+n;for(let i=0;i<n;i++)e[t+i]=r[i]}else e.push(r)}}function T(e){return/^[\s\xa0]*$/.test(e)}function S(){var e=o.navigator;return e&&(e=e.userAgent)?e:""}function C(e){return C[" "](e),e}C[" "]=function(){};var k=-1!=S().indexOf("Gecko")&&(-1==S().toLowerCase().indexOf("webkit")||-1!=S().indexOf("Edge"))&&-1==S().indexOf("Trident")&&-1==S().indexOf("MSIE")&&-1==S().indexOf("Edge");function A(e,t,r){for(let n in e)t.call(r,e[n],n,e)}function x(e){let t={};for(let r in e)t[r]=e[r];return t}let R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(e,t){let r,n;for(let t=1;t<arguments.length;t++){for(r in n=arguments[t])e[r]=n[r];for(let t=0;t<R.length;t++)r=R[t],Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}}var O=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new D,e=>e.reset());class D{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let P,L=!1,M=new class{constructor(){this.h=this.g=null}add(e,t){let r=O.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},U=()=>{let e=o.Promise.resolve(void 0);P=()=>{e.then(V)}};var V=()=>{let e;for(var t;e=null,M.g&&(e=M.g,M.g=M.g.next,M.g||(M.h=null),e.next=null),t=e;){try{t.h.call(t.g)}catch(e){!function(e){o.setTimeout(()=>{throw e},0)}(e)}O.j(t),100>O.h&&(O.h++,t.next=O.g,O.g=t)}L=!1};function F(){this.s=this.s,this.C=this.C}function j(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}F.prototype.s=!1,F.prototype.ma=function(){this.s||(this.s=!0,this.N())},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},j.prototype.h=function(){this.defaultPrevented=!0};var B=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{let e=()=>{};o.addEventListener("test",e,t),o.removeEventListener("test",e,t)}catch(e){}return e}();function $(e,t){if(j.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var r=this.type=e.type,n=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(k){e:{try{C(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==r?t=e.fromElement:"mouseout"==r&&(t=e.toElement);this.relatedTarget=t,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:z[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&$.aa.h.call(this)}}_($,j);var z={2:"touch",3:"pen",4:"mouse"};$.prototype.h=function(){$.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var q="closure_listenable_"+(1e6*Math.random()|0),H=0;function G(e,t,r,n,i){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!n,this.ha=i,this.key=++H,this.da=this.fa=!1}function K(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function W(e){this.src=e,this.g={},this.h=0}function Q(e,t){var r=t.type;if(r in e.g){var n,i=e.g[r],s=Array.prototype.indexOf.call(i,t,void 0);(n=0<=s)&&Array.prototype.splice.call(i,s,1),n&&(K(t),0==e.g[r].length&&(delete e.g[r],e.h--))}}function Y(e,t,r,n){for(var i=0;i<e.length;++i){var s=e[i];if(!s.da&&s.listener==t&&!!r==s.capture&&s.ha==n)return i}return -1}W.prototype.add=function(e,t,r,n,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=Y(e,t,n,i);return -1<o?(t=e[o],r||(t.fa=!1)):((t=new G(t,this.src,s,!!n,i)).fa=r,e.push(t)),t};var X="closure_lm_"+(1e6*Math.random()|0),J={};function Z(e,t,r,n,i,s){if(!t)throw Error("Invalid event type");var o=l(i)?!!i.capture:!!i,a=en(e);if(a||(e[X]=a=new W(e)),(r=a.add(t,r,n,o,s)).proxy)return r;if(n=function e(t){return er.call(e.src,e.listener,t)},r.proxy=n,n.src=e,n.listener=r,e.addEventListener)B||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),n,i);else if(e.attachEvent)e.attachEvent(et(t.toString()),n);else if(e.addListener&&e.removeListener)e.addListener(n);else throw Error("addEventListener and attachEvent are unavailable.");return r}function ee(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[q])Q(t.i,e);else{var r=e.type,n=e.proxy;t.removeEventListener?t.removeEventListener(r,n,e.capture):t.detachEvent?t.detachEvent(et(r),n):t.addListener&&t.removeListener&&t.removeListener(n),(r=en(t))?(Q(r,e),0==r.h&&(r.src=null,t[X]=null)):K(e)}}}function et(e){return e in J?J[e]:J[e]="on"+e}function er(e,t){if(e.da)e=!0;else{t=new $(t,this);var r=e.listener,n=e.ha||e.src;e.fa&&ee(e),e=r.call(n,t)}return e}function en(e){return(e=e[X])instanceof W?e:null}var ei="__closure_events_fn_"+(1e9*Math.random()>>>0);function es(e){return"function"==typeof e?e:(e[ei]||(e[ei]=function(t){return e.handleEvent(t)}),e[ei])}function eo(){F.call(this),this.i=new W(this),this.M=this,this.F=null}function ea(e,t){var r,n=e.F;if(n)for(r=[];n;n=n.F)r.push(n);if(e=e.M,n=t.type||t,"string"==typeof t)t=new j(t,e);else if(t instanceof j)t.target=t.target||e;else{var i=t;N(t=new j(n,e),i)}if(i=!0,r)for(var s=r.length-1;0<=s;s--){var o=t.g=r[s];i=el(o,n,!0,t)&&i}if(i=el(o=t.g=e,n,!0,t)&&i,i=el(o,n,!1,t)&&i,r)for(s=0;s<r.length;s++)i=el(o=t.g=r[s],n,!1,t)&&i}function el(e,t,r,n){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.da&&o.capture==r){var a=o.listener,l=o.ha||o.src;o.fa&&Q(e.i,o),i=!1!==a.call(l,n)&&i}}return i&&!n.defaultPrevented}function eu(e,t,r){if("function"==typeof e)r&&(e=w(e,r));else if(e&&"function"==typeof e.handleEvent)e=w(e.handleEvent,e);else throw Error("Invalid listener argument");return 0x7fffffff<Number(t)?-1:o.setTimeout(e,t||0)}_(eo,F),eo.prototype[q]=!0,eo.prototype.removeEventListener=function(e,t,r,n){!function e(t,r,n,i,s){if(Array.isArray(r))for(var o=0;o<r.length;o++)e(t,r[o],n,i,s);else(i=l(i)?!!i.capture:!!i,n=es(n),t&&t[q])?(t=t.i,(r=String(r).toString())in t.g&&-1<(n=Y(o=t.g[r],n,i,s))&&(K(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[r],t.h--))):t&&(t=en(t))&&(r=t.g[r.toString()],t=-1,r&&(t=Y(r,n,i,s)),(n=-1<t?r[t]:null)&&ee(n))}(this,e,t,r,n)},eo.prototype.N=function(){if(eo.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var r=t.g[e],n=0;n<r.length;n++)K(r[n]);delete t.g[e],t.h--}}this.F=null},eo.prototype.K=function(e,t,r,n){return this.i.add(String(e),t,!1,r,n)},eo.prototype.L=function(e,t,r,n){return this.i.add(String(e),t,!0,r,n)};class ec extends F{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:function e(t){t.g=eu(()=>{t.g=null,t.i&&(t.i=!1,e(t))},t.l);let r=t.h;t.h=null,t.m.apply(null,r)}(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function eh(e){F.call(this),this.h=e,this.g={}}_(eh,F);var ed=[];function ef(e){A(e.g,function(e,t){this.g.hasOwnProperty(t)&&ee(e)},e),e.g={}}eh.prototype.N=function(){eh.aa.N.call(this),ef(this)},eh.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ep=o.JSON.stringify,eg=o.JSON.parse,em=class{stringify(e){return o.JSON.stringify(e,void 0)}parse(e){return o.JSON.parse(e,void 0)}};function ey(){}function ev(e){return e.h||(e.h=e.i())}function ew(){}ey.prototype.h=null;var eb={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function e_(){j.call(this,"d")}function eE(){j.call(this,"c")}_(e_,j),_(eE,j);var eI={},eT=null;function eS(){return eT=eT||new eo}function eC(e){j.call(this,eI.La,e)}function ek(e){let t=eS();ea(t,new eC(t))}function eA(e,t){j.call(this,eI.STAT_EVENT,e),this.stat=t}function ex(e){let t=eS();ea(t,new eA(t,e))}function eR(e,t){j.call(this,eI.Ma,e),this.size=t}function eN(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){e()},t)}function eO(){this.g=!0}function eD(e,t,r,n){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var r=JSON.parse(t);if(r){for(e=0;e<r.length;e++)if(Array.isArray(r[e])){var n=r[e];if(!(2>n.length)){var i=n[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}}return ep(r)}catch(e){return t}}(e,r)+(n?" "+n:"")})}eI.La="serverreachability",_(eC,j),eI.STAT_EVENT="statevent",_(eA,j),eI.Ma="timingevent",_(eR,j),eO.prototype.xa=function(){this.g=!1},eO.prototype.info=function(){};var eP={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},eL={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function eM(){}function eU(e,t,r,n){this.j=e,this.i=t,this.l=r,this.R=n||1,this.U=new eh(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new eV}function eV(){this.i=null,this.g="",this.h=!1}_(eM,ey),eM.prototype.g=function(){return new XMLHttpRequest},eM.prototype.i=function(){return{}},t=new eM;var eF={},ej={};function eB(e,t,r){e.L=1,e.v=tr(e8(t)),e.m=r,e.P=!0,e$(e,null)}function e$(e,t){e.F=Date.now(),eq(e),e.A=e8(e.v);var r,n,i,s,o,a,u=e.A,c=e.R;Array.isArray(c)||(c=[String(c)]),ty(u.i,"t",c),e.C=0,u=e.j.J,e.h=new eV,e.g=t6(e.j,u?t:null,!e.m),0<e.O&&(e.M=new ec(w(e.Y,e,e.g),e.O)),t=e.U,u=e.g,c=e.ca;var h="readystatechange";Array.isArray(h)||(h&&(ed[0]=h.toString()),h=ed);for(var d=0;d<h.length;d++){var f=function e(t,r,n,i,s){if(i&&i.once)return function e(t,r,n,i,s){if(Array.isArray(r)){for(var o=0;o<r.length;o++)e(t,r[o],n,i,s);return null}return n=es(n),t&&t[q]?t.L(r,n,l(i)?!!i.capture:!!i,s):Z(t,r,n,!0,i,s)}(t,r,n,i,s);if(Array.isArray(r)){for(var o=0;o<r.length;o++)e(t,r[o],n,i,s);return null}return n=es(n),t&&t[q]?t.K(r,n,l(i)?!!i.capture:!!i,s):Z(t,r,n,!1,i,s)}(u,h[d],c||t.handleEvent,!1,t.h||t);if(!f)break;t.g[f.key]=f}t=e.H?x(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),ek(),r=e.i,n=e.u,i=e.A,s=e.l,o=e.R,a=e.m,r.info(function(){if(r.g)if(a)for(var e="",t=a.split("&"),l=0;l<t.length;l++){var u=t[l].split("=");if(1<u.length){var c=u[0];u=u[1];var h=c.split("_");e=2<=h.length&&"type"==h[1]?e+(c+"=")+u+"&":e+(c+"=redacted&")}}else e=null;else e=a;return"XMLHTTP REQ ("+s+") [attempt "+o+"]: "+n+"\n"+i+"\n"+e})}function ez(e){return!!e.g&&"GET"==e.u&&2!=e.L&&e.j.Ca}function eq(e){e.S=Date.now()+e.I,eH(e,e.I)}function eH(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=eN(w(e.ba,e),t)}function eG(e){e.B&&(o.clearTimeout(e.B),e.B=null)}function eK(e){0==e.j.G||e.J||tJ(e.j,e)}function eW(e){eG(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ef(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function eQ(e,t){try{var r=e.j;if(0!=r.G&&(r.g==e||e0(r.h,e))){if(!e.K&&e0(r.h,e)&&3==r.G){try{var n=r.Da.g.parse(t)}catch(e){n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){e:if(!r.u){if(r.g)if(r.g.F+3e3<e.F)tX(r),tB(r);else break e;tW(r),ex(18)}}else r.za=i[1],0<r.za-r.T&&37500>i[2]&&r.F&&0==r.v&&!r.C&&(r.C=eN(w(r.Za,r),6e3));if(1>=eZ(r.h)&&r.ca){try{r.ca()}catch(e){}r.ca=void 0}}else t0(r,11)}else if((e.K||r.g==e)&&tX(r),!T(t))for(i=r.Da.g.parse(t),t=0;t<i.length;t++){let a=i[t];if(r.T=a[0],a=a[1],2==r.G)if("c"==a[0]){r.K=a[1],r.ia=a[2];let t=a[3];null!=t&&(r.la=t,r.j.info("VER="+r.la));let i=a[4];null!=i&&(r.Aa=i,r.j.info("SVER="+r.Aa));let l=a[5];null!=l&&"number"==typeof l&&0<l&&(r.L=n=1.5*l,r.j.info("backChannelRequestTimeoutMs_="+n)),n=r;let u=e.g;if(u){let e=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=n.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(e1(s,s.h),s.h=null))}if(n.D){let e=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(n.ya=e,tt(n.I,n.D,e))}}if(r.G=3,r.l&&r.l.ua(),r.ba&&(r.R=Date.now()-e.F,r.j.info("Handshake RTT: "+r.R+"ms")),(n=r).qa=t2(n,n.J?n.ia:null,n.W),e.K){e2(n.h,e);var o=n.L;o&&(e.I=o),e.B&&(eG(e),eq(e)),n.g=e}else tK(n);0<r.i.length&&tz(r)}else"stop"!=a[0]&&"close"!=a[0]||t0(r,7);else 3==r.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?t0(r,7):tj(r):"noop"!=a[0]&&r.l&&r.l.ta(a),r.v=0)}}ek(4)}catch(e){}}eU.prototype.ca=function(e){e=e.target;let t=this.M;t&&3==tM(e)?t.j():this.Y(e)},eU.prototype.Y=function(e){try{if(e==this.g)e:{let v=tM(this.g);var t=this.g.Ba();let w=this.g.Z();if(!(3>v)&&(3!=v||this.g&&(this.h.h||this.g.oa()||tU(this.g)))){this.J||4!=v||7==t||(8==t||0>=w?ek(3):ek(2)),eG(this);var r=this.g.Z();this.X=r;t:if(ez(this)){var n=tU(this.g);e="";var i=n.length,s=4==tM(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){eW(this),eK(this);var a="";break t}this.h.i=new o.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(n[t],{stream:!(s&&t==i-1)});n.length=0,this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==r,l=this.i,u=this.u,c=this.A,h=this.l,d=this.R,f=r,l.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+d+"]: "+u+"\n"+c+"\n"+v+" "+f}),this.o){if(this.T&&!this.K){t:{if(this.g){var l,u,c,h,d,f,p,g=this.g;if((p=g.g?g.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(p)){var m=p;break t}}m=null}if(r=m)eD(this.i,this.l,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,eQ(this,r);else{this.o=!1,this.s=3,ex(12),eW(this),eK(this);break e}}if(this.P){let e;for(r=!0;!this.J&&this.C<a.length;)if((e=function(e,t){var r=e.C,n=t.indexOf("\n",r);return -1==n?ej:isNaN(r=Number(t.substring(r,n)))?eF:(n+=1)+r>t.length?ej:(t=t.slice(n,n+r),e.C=n+r,t)}(this,a))==ej){4==v&&(this.s=4,ex(14),r=!1),eD(this.i,this.l,null,"[Incomplete Response]");break}else if(e==eF){this.s=4,ex(15),eD(this.i,this.l,a,"[Invalid Chunk]"),r=!1;break}else eD(this.i,this.l,e,null),eQ(this,e);if(ez(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=v||0!=a.length||this.h.h||(this.s=1,ex(16),r=!1),this.o=this.o&&r,r){if(0<a.length&&!this.W){this.W=!0;var y=this.j;y.g==this&&y.ba&&!y.M&&(y.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),tQ(y),y.M=!0,ex(11))}}else eD(this.i,this.l,a,"[Invalid Chunked Response]"),eW(this),eK(this)}else eD(this.i,this.l,a,null),eQ(this,a);4==v&&eW(this),this.o&&!this.J&&(4==v?tJ(this.j,this):(this.o=!1,eq(this)))}else(function(e){let t={};e=(e.g&&2<=tM(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<e.length;n++){if(T(e[n]))continue;var r=function(e){var t=1;e=e.split(":");let r=[];for(;0<t&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}(e[n]);let i=r[0];if("string"!=typeof(r=r[1]))continue;r=r.trim();let s=t[i]||[];t[i]=s,s.push(r)}var n=function(e){return e.join(", ")};for(let e in t)n.call(void 0,t[e],e,t)})(this.g),400==r&&0<a.indexOf("Unknown SID")?(this.s=3,ex(12)):(this.s=0,ex(13)),eW(this),eK(this)}}}catch(e){}finally{}},eU.prototype.cancel=function(){this.J=!0,eW(this)},eU.prototype.ba=function(){var e,t;this.B=null;let r=Date.now();0<=r-this.S?(e=this.i,t=this.A,e.info(function(){return"TIMEOUT: "+t}),2!=this.L&&(ek(),ex(17)),eW(this),this.s=2,eK(this)):eH(this,this.S-r)};var eY=class{constructor(e,t){this.g=e,this.map=t}};function eX(e){this.l=e||10,e=o.PerformanceNavigationTiming?0<(e=o.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function eJ(e){return!!e.h||!!e.g&&e.g.size>=e.j}function eZ(e){return e.h?1:e.g?e.g.size:0}function e0(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function e1(e,t){e.g?e.g.add(t):e.h=t}function e2(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function e6(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(let r of e.g.values())t=t.concat(r.D);return t}return E(e.i)}function e3(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(a(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var r=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(a(e)||"string"==typeof e){var t=[];e=e.length;for(var r=0;r<e;r++)t.push(r);return t}for(let n in t=[],r=0,e)t[r++]=n;return t}}}(e),n=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(a(e)){for(var t=[],r=e.length,n=0;n<r;n++)t.push(e[n]);return t}for(n in t=[],r=0,e)t[r++]=e[n];return t}(e),i=n.length,s=0;s<i;s++)t.call(void 0,n[s],r&&r[s],e)}eX.prototype.cancel=function(){if(this.i=e6(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(let e of this.g.values())e.cancel();this.g.clear()}};var e5=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function e4(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof e4){this.h=e.h,e7(this,e.j),this.o=e.o,this.g=e.g,e9(this,e.s),this.l=e.l;var t=e.i,r=new tf;r.i=t.i,t.g&&(r.g=new Map(t.g),r.h=t.h),te(this,r),this.m=e.m}else e&&(t=String(e).match(e5))?(this.h=!1,e7(this,t[1]||"",!0),this.o=tn(t[2]||""),this.g=tn(t[3]||"",!0),e9(this,t[4]),this.l=tn(t[5]||"",!0),te(this,t[6]||"",!0),this.m=tn(t[7]||"")):(this.h=!1,this.i=new tf(null,this.h))}function e8(e){return new e4(e)}function e7(e,t,r){e.j=r?tn(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function e9(e,t){if(t){if(isNaN(t=Number(t))||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function te(e,t,r){var n,i;t instanceof tf?(e.i=t,n=e.i,(i=e.h)&&!n.j&&(tp(n),n.i=null,n.g.forEach(function(e,t){var r=t.toLowerCase();t!=r&&(tg(this,t),ty(this,r,e))},n)),n.j=i):(r||(t=ti(t,th)),e.i=new tf(t,e.h))}function tt(e,t,r){e.i.set(t,r)}function tr(e){return tt(e,"zx",Math.floor(0x80000000*Math.random()).toString(36)+Math.abs(Math.floor(0x80000000*Math.random())^Date.now()).toString(36)),e}function tn(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ti(e,t,r){return"string"==typeof e?(e=encodeURI(e).replace(t,ta),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ta(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}e4.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ti(t,tl,!0),":");var r=this.g;return(r||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ti(t,tl,!0),"@"),e.push(encodeURIComponent(String(r)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(r=this.s)&&e.push(":",String(r))),(r=this.l)&&(this.g&&"/"!=r.charAt(0)&&e.push("/"),e.push(ti(r,"/"==r.charAt(0)?tc:tu,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.m)&&e.push("#",ti(r,td)),e.join("")};var tl=/[#\/\?@]/g,tu=/[#\?:]/g,tc=/[#\?]/g,th=/[#\?@]/g,td=/#/g;function tf(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function tp(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var r=0;r<e.length;r++){var n=e[r].indexOf("="),i=null;if(0<=n){var s=e[r].substring(0,n);i=e[r].substring(n+1)}else s=e[r];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)}))}function tg(e,t){tp(e),t=tv(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function tm(e,t){return tp(e),t=tv(e,t),e.g.has(t)}function ty(e,t,r){tg(e,t),0<r.length&&(e.i=null,e.g.set(tv(e,t),E(r)),e.h+=r.length)}function tv(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function tw(e,t,r,n,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),n(r)}catch(e){}}function tb(){this.g=new em}function t_(e){this.l=e.Ub||null,this.j=e.eb||!1}function tE(e,t){eo.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function tI(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function tT(e){e.readyState=4,e.l=null,e.j=null,e.v=null,tS(e)}function tS(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function tC(e){let t="";return A(e,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function tk(e,t,r){e:{for(n in r){var n=!1;break e}n=!0}n||(r=tC(r),"string"==typeof e?null!=r&&encodeURIComponent(String(r)):tt(e,t,r))}function tA(e){eo.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(r=tf.prototype).add=function(e,t){tp(this),this.i=null,e=tv(this,e);var r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this},r.forEach=function(e,t){tp(this),this.g.forEach(function(r,n){r.forEach(function(r){e.call(t,r,n,this)},this)},this)},r.na=function(){tp(this);let e=Array.from(this.g.values()),t=Array.from(this.g.keys()),r=[];for(let n=0;n<t.length;n++){let i=e[n];for(let e=0;e<i.length;e++)r.push(t[n])}return r},r.V=function(e){tp(this);let t=[];if("string"==typeof e)tm(this,e)&&(t=t.concat(this.g.get(tv(this,e))));else{e=Array.from(this.g.values());for(let r=0;r<e.length;r++)t=t.concat(e[r])}return t},r.set=function(e,t){return tp(this),this.i=null,tm(this,e=tv(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},r.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},r.toString=function(){if(this.i)return this.i;if(!this.g)return"";let e=[],t=Array.from(this.g.keys());for(var r=0;r<t.length;r++){var n=t[r];let s=encodeURIComponent(String(n)),o=this.V(n);for(n=0;n<o.length;n++){var i=s;""!==o[n]&&(i+="="+encodeURIComponent(String(o[n]))),e.push(i)}}return this.i=e.join("&")},_(t_,ey),t_.prototype.g=function(){return new tE(this.l,this.j)},t_.prototype.i=(e={},function(){return e}),_(tE,eo),(r=tE.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,tS(this)},r.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;let t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||o).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,tT(this)),this.readyState=0},r.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,tS(this)),this.g&&(this.readyState=3,tS(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==o.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;tI(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},r.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?tT(this):tS(this),3==this.readyState&&tI(this)}},r.Ra=function(e){this.g&&(this.response=this.responseText=e,tT(this))},r.Qa=function(e){this.g&&(this.response=e,tT(this))},r.ga=function(){this.g&&tT(this)},r.setRequestHeader=function(e,t){this.u.append(e,t)},r.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";let e=[],t=this.h.entries();for(var r=t.next();!r.done;)e.push((r=r.value)[0]+": "+r[1]),r=t.next();return e.join("\r\n")},Object.defineProperty(tE.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),_(tA,eo);var tx=/^https?$/i,tR=["POST","PUT"];function tN(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,tO(e),tP(e)}function tO(e){e.A||(e.A=!0,ea(e,"complete"),ea(e,"error"))}function tD(e){if(e.h&&void 0!==s&&(!e.v[1]||4!=tM(e)||2!=e.Z())){if(e.u&&4==tM(e))eu(e.Ea,0,e);else if(ea(e,"readystatechange"),4==tM(e)){e.h=!1;try{let s=e.Z();switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t,r,n=!0;break;default:n=!1}if(!(t=n)){if(r=0===s){var i=String(e.D).match(e5)[1]||null;!i&&o.self&&o.self.location&&(i=o.self.location.protocol.slice(0,-1)),r=!tx.test(i?i.toLowerCase():"")}t=r}if(t)ea(e,"complete"),ea(e,"success");else{e.m=6;try{var a=2<tM(e)?e.g.statusText:""}catch(e){a=""}e.l=a+" ["+e.Z()+"]",tO(e)}}finally{tP(e)}}}}function tP(e,t){if(e.g){tL(e);let r=e.g,n=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||ea(e,"ready");try{r.onreadystatechange=n}catch(e){}}}function tL(e){e.I&&(o.clearTimeout(e.I),e.I=null)}function tM(e){return e.g?e.g.readyState:0}function tU(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function tV(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function tF(e){this.Aa=0,this.i=[],this.j=new eO,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=tV("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=tV("baseRetryDelayMs",5e3,e),this.cb=tV("retryDelaySeedMs",1e4,e),this.Wa=tV("forwardChannelMaxRetries",2,e),this.wa=tV("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new eX(e&&e.concurrentRequestLimit),this.Da=new tb,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function tj(e){if(t$(e),3==e.G){var t=e.U++,r=e8(e.I);if(tt(r,"SID",e.K),tt(r,"RID",t),tt(r,"TYPE","terminate"),tH(e,r),(t=new eU(e,e.j,t)).L=2,t.v=tr(e8(r)),r=!1,o.navigator&&o.navigator.sendBeacon)try{r=o.navigator.sendBeacon(t.v.toString(),"")}catch(e){}!r&&o.Image&&((new Image).src=t.v,r=!0),r||(t.g=t6(t.j,null),t.g.ea(t.v)),t.F=Date.now(),eq(t)}t1(e)}function tB(e){e.g&&(tQ(e),e.g.cancel(),e.g=null)}function t$(e){tB(e),e.u&&(o.clearTimeout(e.u),e.u=null),tX(e),e.h.cancel(),e.s&&("number"==typeof e.s&&o.clearTimeout(e.s),e.s=null)}function tz(e){if(!eJ(e.h)&&!e.s){e.s=!0;var t=e.Ga;P||U(),L||(P(),L=!0),M.add(t,e),e.B=0}}function tq(e,t){var r;r=t?t.l:e.U++;let n=e8(e.I);tt(n,"SID",e.K),tt(n,"RID",r),tt(n,"AID",e.T),tH(e,n),e.m&&e.o&&tk(n,e.m,e.o),r=new eU(e,e.j,r,e.B+1),null===e.m&&(r.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tG(e,r,1e3),r.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),e1(e.h,r),eB(r,n,t)}function tH(e,t){e.H&&A(e.H,function(e,r){tt(t,r,e)}),e.l&&e3({},function(e,r){tt(t,r,e)})}function tG(e,t,r){r=Math.min(e.i.length,r);var n=e.l?w(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){let e=["count="+r];-1==t?0<r?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<r;o++){let r=i[o].g,a=i[o].map;if(0>(r-=t))t=Math.max(0,i[o].g-100),s=!1;else try{!function(e,t,r){let n=r||"";try{e3(e,function(e,r){let i=e;l(e)&&(i=ep(e)),t.push(n+r+"="+encodeURIComponent(i))})}catch(e){throw t.push(n+"type="+encodeURIComponent("_badmap")),e}}(a,e,"req"+r+"_")}catch(e){n&&n(a)}}if(s){n=e.join("&");break e}}}return t.D=e=e.i.splice(0,r),n}function tK(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;P||U(),L||(P(),L=!0),M.add(t,e),e.v=0}}function tW(e){return!e.g&&!e.u&&!(3<=e.v)&&(e.Y++,e.u=eN(w(e.Fa,e),tZ(e,e.v)),e.v++,!0)}function tQ(e){null!=e.A&&(o.clearTimeout(e.A),e.A=null)}function tY(e){e.g=new eU(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=e8(e.qa);tt(t,"RID","rpc"),tt(t,"SID",e.K),tt(t,"AID",e.T),tt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&tt(t,"TO",e.ja),tt(t,"TYPE","xmlhttp"),tH(e,t),e.m&&e.o&&tk(t,e.m,e.o),e.L&&(e.g.I=e.L);var r=e.g;e=e.ia,r.L=1,r.v=tr(e8(t)),r.m=null,r.P=!0,e$(r,e)}function tX(e){null!=e.C&&(o.clearTimeout(e.C),e.C=null)}function tJ(e,t){var r,n=null;if(e.g==t){tX(e),tQ(e),e.g=null;var i=2}else{if(!e0(e.h,t))return;n=t.D,e2(e.h,t),i=1}if(0!=e.G){if(t.o)if(1==i){n=t.m?t.m.length:0,t=Date.now()-t.F;var s=e.B;ea(i=eS(),new eR(i,n)),tz(e)}else tK(e);else if(3==(s=t.s)||0==s&&0<t.X||!(1==i&&(r=t,!(eZ(e.h)>=e.h.j-!!e.s)&&(e.s?(e.i=r.D.concat(e.i),!0):1!=e.G&&2!=e.G&&!(e.B>=(e.Va?0:e.Wa))&&(e.s=eN(w(e.Ga,e,r),tZ(e,e.B)),e.B++,!0)))||2==i&&tW(e)))switch(n&&0<n.length&&((t=e.h).i=t.i.concat(n)),s){case 1:t0(e,5);break;case 4:t0(e,10);break;case 3:t0(e,6);break;default:t0(e,2)}}}function tZ(e,t){let r=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(r*=2),r*t}function t0(e,t){if(e.j.info("Error code "+t),2==t){let t,s,a;var r,n=w(e.fb,e),i=e.Xa;let l=!i;i=new e4(i||"//www.google.com/images/cleardot.gif"),o.location&&"http"==o.location.protocol||e7(i,"https"),tr(i),l?function(e,t){let r=new eO;if(o.Image){let n=new Image;n.onload=b(tw,r,"TestLoadImage: loaded",!0,t,n),n.onerror=b(tw,r,"TestLoadImage: error",!1,t,n),n.onabort=b(tw,r,"TestLoadImage: abort",!1,t,n),n.ontimeout=b(tw,r,"TestLoadImage: timeout",!1,t,n),o.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=e}else t(!1)}(i.toString(),n):(r=i.toString(),t=new eO,s=new AbortController,a=setTimeout(()=>{s.abort(),tw(t,"TestPingServer: timeout",!1,n)},1e4),fetch(r,{signal:s.signal}).then(e=>{clearTimeout(a),e.ok?tw(t,"TestPingServer: ok",!0,n):tw(t,"TestPingServer: server error",!1,n)}).catch(()=>{clearTimeout(a),tw(t,"TestPingServer: error",!1,n)}))}else ex(2);e.G=0,e.l&&e.l.sa(t),t1(e),t$(e)}function t1(e){if(e.G=0,e.ka=[],e.l){let t=e6(e.h);(0!=t.length||0!=e.i.length)&&(I(e.ka,t),I(e.ka,e.i),e.h.i.length=0,E(e.i),e.i.length=0),e.l.ra()}}function t2(e,t,r){var n=r instanceof e4?e8(r):new e4(r);if(""!=n.g)t&&(n.g=t+"."+n.g),e9(n,n.s);else{var i=o.location;n=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new e4(null);n&&e7(s,n),t&&(s.g=t),i&&e9(s,i),r&&(s.l=r),n=s}return r=e.D,t=e.ya,r&&t&&tt(n,r,t),tt(n,"VER",e.la),tH(e,n),n}function t6(e,t,r){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new tA(e.Ca&&!e.pa?new t_({eb:r}):e.pa)).Ha(e.J),t}function t3(){}function t5(){}function t4(e,t){eo.call(this),this.g=new tF(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!T(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!T(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new t9(this)}function t8(e){e_.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(let r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function t7(){eE.call(this),this.status=1}function t9(e){this.g=e}(r=tA.prototype).Ha=function(e){this.J=e},r.ea=function(e,r,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);r=r?r.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():t.g(),this.v=this.o?ev(this.o):ev(t),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(r,String(e),!0),this.B=!1}catch(e){tN(this,e);return}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)n.set(s,i[s]);else if("function"==typeof i.keys&&"function"==typeof i.get)for(let e of i.keys())n.set(e,i.get(e));else throw Error("Unknown input type for opt_headers: "+String(i));for(let[t,a]of(i=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=o.FormData&&e instanceof o.FormData,!(0<=Array.prototype.indexOf.call(tR,r,void 0))||i||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),n))this.g.setRequestHeader(t,a);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{tL(this),this.u=!0,this.g.send(e),this.u=!1}catch(e){tN(this,e)}},r.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,ea(this,"complete"),ea(this,"abort"),tP(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),tP(this,!0)),tA.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?tD(this):this.bb())},r.bb=function(){tD(this)},r.isActive=function(){return!!this.g},r.Z=function(){try{return 2<tM(this)?this.g.status:-1}catch(e){return -1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},r.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),eg(t)}},r.Ba=function(){return this.m},r.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(r=tF.prototype).la=8,r.G=1,r.connect=function(e,t,r,n){ex(0),this.W=e,this.H=t||{},r&&void 0!==n&&(this.H.OSID=r,this.H.OAID=n),this.F=this.X,this.I=t2(this,null,this.W),tz(this)},r.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;let i=new eU(this,this.j,e),s=this.o;if(this.S&&(s?N(s=x(s),this.S):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)e:{for(var t=0,r=0;r<this.i.length;r++){t:{var n=this.i[r];if("__data__"in n.map&&"string"==typeof(n=n.map.__data__)){n=n.length;break t}n=void 0}if(void 0===n)break;if(4096<(t+=n)){t=r;break e}if(4096===t||r===this.i.length-1){t=r+1;break e}}t=1e3}else t=1e3;t=tG(this,i,t),tt(r=e8(this.I),"RID",e),tt(r,"CVER",22),this.D&&tt(r,"X-HTTP-Session-Id",this.D),tH(this,r),s&&(this.O?t="headers="+encodeURIComponent(String(tC(s)))+"&"+t:this.m&&tk(r,this.m,s)),e1(this.h,i),this.Ua&&tt(r,"TYPE","init"),this.P?(tt(r,"$req",t),tt(r,"SID","null"),i.T=!0,eB(i,r,null)):eB(i,r,t),this.G=2}}else 3==this.G&&(e?tq(this,e):0==this.i.length||eJ(this.h)||tq(this))},r.Fa=function(){if(this.u=null,tY(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=eN(w(this.ab,this),e)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ex(10),tB(this),tY(this))},r.Za=function(){null!=this.C&&(this.C=null,tB(this),tW(this),ex(19))},r.fb=function(e){e?(this.j.info("Successfully pinged google.com"),ex(2)):(this.j.info("Failed to ping google.com"),ex(1))},r.isActive=function(){return!!this.l&&this.l.isActive(this)},(r=t3.prototype).ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){},t5.prototype.g=function(e,t){return new t4(e,t)},_(t4,eo),t4.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},t4.prototype.close=function(){tj(this.g)},t4.prototype.o=function(e){var t=this.g;if("string"==typeof e){var r={};r.__data__=e,e=r}else this.u&&((r={}).__data__=ep(e),e=r);t.i.push(new eY(t.Ya++,e)),3==t.G&&tz(t)},t4.prototype.N=function(){this.g.l=null,delete this.j,tj(this.g),delete this.g,t4.aa.N.call(this)},_(t8,e_),_(t7,eE),_(t9,t3),t9.prototype.ua=function(){ea(this.g,"a")},t9.prototype.ta=function(e){ea(this.g,new t8(e))},t9.prototype.sa=function(e){ea(this.g,new t7)},t9.prototype.ra=function(){ea(this.g,"b")},t5.prototype.createWebChannel=t5.prototype.g,t4.prototype.send=t4.prototype.o,t4.prototype.open=t4.prototype.m,t4.prototype.close=t4.prototype.close,v=to.createWebChannelTransport=function(){return new t5},y=to.getStatEventTarget=function(){return eS()},m=to.Event=eI,g=to.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},eP.NO_ERROR=0,eP.TIMEOUT=8,eP.HTTP_ERROR=6,p=to.ErrorCode=eP,eL.COMPLETE="complete",f=to.EventType=eL,ew.EventType=eb,eb.OPEN="a",eb.CLOSE="b",eb.ERROR="c",eb.MESSAGE="d",eo.prototype.listen=eo.prototype.K,d=to.WebChannel=ew,to.FetchXmlHttpFactory=t_,tA.prototype.listenOnce=tA.prototype.L,tA.prototype.getLastError=tA.prototype.Ka,tA.prototype.getLastErrorCode=tA.prototype.Ba,tA.prototype.getStatus=tA.prototype.Z,tA.prototype.getResponseJson=tA.prototype.Oa,tA.prototype.getResponseText=tA.prototype.oa,tA.prototype.send=tA.prototype.ea,tA.prototype.setWithCredentials=tA.prototype.Ha,h=to.XhrIo=tA}).apply(void 0!==ts?ts:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});let ta="@firebase/firestore",tl="4.7.17";class tu{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}tu.UNAUTHENTICATED=new tu(null),tu.GOOGLE_CREDENTIALS=new tu("google-credentials-uid"),tu.FIRST_PARTY=new tu("first-party-uid"),tu.MOCK_USER=new tu("mock-user");let tc="11.9.0",th=new ep("@firebase/firestore");function td(){return th.logLevel}function tf(e,...t){if(th.logLevel<=l.DEBUG){let r=t.map(tm);th.debug(`Firestore (${tc}): ${e}`,...r)}}function tp(e,...t){if(th.logLevel<=l.ERROR){let r=t.map(tm);th.error(`Firestore (${tc}): ${e}`,...r)}}function tg(e,...t){if(th.logLevel<=l.WARN){let r=t.map(tm);th.warn(`Firestore (${tc}): ${e}`,...r)}}function tm(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function ty(e,t,r){let n="Unexpected state";"string"==typeof t?n=t:r=t,tv(e,n,r)}function tv(e,t,r){let n=`FIRESTORE (${tc}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==r)try{n+=" CONTEXT: "+JSON.stringify(r)}catch(e){n+=" CONTEXT: "+r}throw tp(n),Error(n)}function tw(e,t,r,n){let i="Unexpected state";"string"==typeof r?i=r:n=r,e||tv(t,i,n)}let tb={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class t_ extends W{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class tE{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class tI{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class tT{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(tu.UNAUTHENTICATED))}shutdown(){}}class tS{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class tC{constructor(e){this.t=e,this.currentUser=tu.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){tw(void 0===this.o,42304);let r=this.i,n=e=>this.i!==r?(r=this.i,t(e)):Promise.resolve(),i=new tE;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new tE,e.enqueueRetryable(()=>n(this.currentUser))};let s=()=>{let t=i;e.enqueueRetryable(async()=>{await t.promise,await n(this.currentUser)})},o=e=>{tf("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){let e=this.t.getImmediate({optional:!0});e?o(e):(tf("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new tE)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(tf("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(tw("string"==typeof t.accessToken,31837,{l:t}),new tI(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return tw(null===e||"string"==typeof e,2055,{h:e}),new tu(e)}}class tk{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=tu.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class tA{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new tk(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(tu.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class tx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class tR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,e$(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){tw(void 0===this.o,3512);let r=e=>{null!=e.error&&tf("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let r=e.token!==this.m;return this.m=e.token,tf("FirebaseAppCheckTokenProvider",`Received ${r?"new":"existing"} token.`),r?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>r(t))};let n=e=>{tf("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>n(e)),setTimeout(()=>{if(!this.appCheck){let e=this.V.getImmediate({optional:!0});e?n(e):tf("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new tx(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(tw("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new tx(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function tN(){return new TextEncoder}class tO{static newId(){let e=62*Math.floor(256/62),t="";for(;t.length<20;){let r=function(e){let t="undefined"!=typeof self&&(self.crypto||self.msCrypto),r=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(r);else for(let e=0;e<40;e++)r[e]=Math.floor(256*Math.random());return r}(0);for(let n=0;n<r.length;++n)t.length<20&&r[n]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(r[n]%62))}return t}}function tD(e,t){return e<t?-1:+(e>t)}function tP(e,t){let r=0;for(;r<e.length&&r<t.length;){let n=e.codePointAt(r),i=t.codePointAt(r);if(n!==i){if(n<128&&i<128)return tD(n,i);{let s=tN(),o=function(e,t){for(let r=0;r<e.length&&r<t.length;++r)if(e[r]!==t[r])return tD(e[r],t[r]);return tD(e.length,t.length)}(s.encode(tL(e,r)),s.encode(tL(t,r)));return 0!==o?o:tD(n,i)}}r+=n>65535?2:1}return tD(e.length,t.length)}function tL(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function tM(e,t,r){return e.length===t.length&&e.every((e,n)=>r(e,t[n]))}class tU{static now(){return tU.fromMillis(Date.now())}static fromDate(e){return tU.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*1e6);return new tU(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new t_(tb.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-0xe7791f700||e>=0x3afff44180)throw new t_(tb.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?tD(this.nanoseconds,e.nanoseconds):tD(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -0xe7791f700).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class tV{static fromTimestamp(e){return new tV(e)}static min(){return new tV(new tU(0,0))}static max(){return new tV(new tU(0x3afff4417f,0x3b9ac9ff))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}let tF="__name__";class tj{constructor(e,t,r){void 0===t?t=0:t>e.length&&ty(637,{offset:t,range:e.length}),void 0===r?r=e.length-t:r>e.length-t&&ty(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===tj.comparator(this,e)}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof tj?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let n=0;n<r;n++){let r=tj.compareSegments(e.get(n),t.get(n));if(0!==r)return r}return tD(e.length,t.length)}static compareSegments(e,t){let r=tj.isNumericId(e),n=tj.isNumericId(t);return r&&!n?-1:!r&&n?1:r&&n?tj.extractNumericId(e).compare(tj.extractNumericId(t)):tP(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return u.fromString(e.substring(4,e.length-2))}}class tB extends tj{construct(e,t,r){return new tB(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new t_(tb.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(e=>e.length>0))}return new tB(t)}static emptyPath(){return new tB([])}}let t$=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tz extends tj{construct(e,t,r){return new tz(e,t,r)}static isValidIdentifier(e){return t$.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tz.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===tF}static keyField(){return new tz([tF])}static fromServerFormat(e){let t=[],r="",n=0,i=()=>{if(0===r.length)throw new t_(tb.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;n<e.length;){let t=e[n];if("\\"===t){if(n+1===e.length)throw new t_(tb.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let t=e[n+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new t_(tb.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=t,n+=2}else"`"===t?s=!s:"."!==t||s?r+=t:i(),n++}if(i(),s)throw new t_(tb.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new tz(t)}static emptyPath(){return new tz([])}}class tq{constructor(e){this.path=e}static fromPath(e){return new tq(tB.fromString(e))}static fromName(e){return new tq(tB.fromString(e).popFirst(5))}static empty(){return new tq(tB.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===tB.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return tB.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new tq(new tB(e.slice()))}}class tH{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new tH(tV.min(),tq.empty(),-1)}static max(){return new tH(tV.max(),tq.empty(),-1)}}class tG{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function tK(e){if(e.code!==tb.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;tf("LocalStore","Unexpectedly lost primary lease")}class tW{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ty(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new tW((r,n)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(r,n)},this.catchCallback=e=>{this.wrapFailure(t,e).next(r,n)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof tW?t:tW.resolve(t)}catch(e){return tW.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):tW.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):tW.reject(t)}static resolve(e){return new tW((t,r)=>{t(e)})}static reject(e){return new tW((t,r)=>{r(e)})}static waitFor(e){return new tW((t,r)=>{let n=0,i=0,s=!1;e.forEach(e=>{++n,e.next(()=>{++i,s&&i===n&&t()},e=>r(e))}),s=!0,i===n&&t()})}static or(e){let t=tW.resolve(!1);for(let r of e)t=t.next(e=>e?tW.resolve(e):r());return t}static forEach(e,t){let r=[];return e.forEach((e,n)=>{r.push(t.call(this,e,n))}),this.waitFor(r)}static mapArray(e,t){return new tW((r,n)=>{let i=e.length,s=Array(i),o=0;for(let a=0;a<i;a++){let l=a;t(e[l]).next(e=>{s[l]=e,++o===i&&r(s)},e=>n(e))}})}static doWhile(e,t){return new tW((r,n)=>{let i=()=>{!0===e()?t().next(()=>{i()},n):r()};i()})}}function tQ(e){return"IndexedDbTransactionError"===e.name}class tY{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ue(e),this.ce=e=>t.writeSequenceNumber(e))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ce&&this.ce(e),e}}tY.le=-1;function tX(e){return 0===e&&1/e==-1/0}function tJ(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function tZ(e,t){for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function t0(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class t1{constructor(e,t){this.comparator=e,this.root=t||t6.EMPTY}insert(e,t){return new t1(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,t6.BLACK,null,null))}remove(e){return new t1(this.comparator,this.root.remove(e,this.comparator).copy(null,null,t6.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let n=this.comparator(e,r.key);if(0===n)return t+r.left.size;n<0?r=r.left:(t+=r.left.size+1,r=r.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new t2(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new t2(this.root,e,this.comparator,!1)}getReverseIterator(){return new t2(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new t2(this.root,e,this.comparator,!0)}}class t2{constructor(e,t,r,n){this.isReverse=n,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&n&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class t6{constructor(e,t,r,n,i){this.key=e,this.value=t,this.color=null!=r?r:t6.RED,this.left=null!=n?n:t6.EMPTY,this.right=null!=i?i:t6.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,n,i){return new t6(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=n?n:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let n=this,i=r(e,n.key);return(n=i<0?n.copy(null,null,null,n.left.insert(e,t,r),null):0===i?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,r))).fixUp()}removeMin(){if(this.left.isEmpty())return t6.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let r,n=this;if(0>t(e,n.key))n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),0===t(e,n.key)){if(n.right.isEmpty())return t6.EMPTY;r=n.right.min(),n=n.copy(r.key,r.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t6.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t6.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ty(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ty(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw ty(27949);return e+ +!this.isRed()}}t6.EMPTY=null,t6.RED=!0,t6.BLACK=!1,t6.EMPTY=new class{constructor(){this.size=0}get key(){throw ty(57766)}get value(){throw ty(16141)}get color(){throw ty(16727)}get left(){throw ty(29726)}get right(){throw ty(36894)}copy(e,t,r,n,i){return this}insert(e,t,r){return new t6(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class t3{constructor(e){this.comparator=e,this.data=new t1(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let n=r.getNext();if(this.comparator(n.key,e[1])>=0)return;t(n.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new t5(this.data.getIterator())}getIteratorFrom(e){return new t5(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof t3)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let e=t.getNext().key,n=r.getNext().key;if(0!==this.comparator(e,n))return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new t3(this.comparator);return t.data=e,t}}class t5{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class t4{constructor(e){this.fields=e,e.sort(tz.comparator)}static empty(){return new t4([])}unionWith(e){let t=new t3(tz.comparator);for(let e of this.fields)t=t.add(e);for(let r of e)t=t.add(r);return new t4(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return tM(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class t8 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class t7{constructor(e){this.binaryString=e}static fromBase64String(e){return new t7(function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new t8("Invalid base64 string: "+e):e}}(e))}static fromUint8Array(e){return new t7(function(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}(e))}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){var e=this.binaryString;let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tD(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}t7.EMPTY_BYTE_STRING=new t7("");let t9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function re(e){if(tw(!!e,39018),"string"==typeof e){let t=0,r=t9.exec(e);if(tw(!!r,46558,{timestamp:e}),r[1]){let e=r[1];t=Number(e=(e+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(e).getTime()/1e3),nanos:t}}return{seconds:rt(e.seconds),nanos:rt(e.nanos)}}function rt(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function rr(e){return"string"==typeof e?t7.fromBase64String(e):t7.fromUint8Array(e)}let rn="server_timestamp",ri="__type__",rs="__previous_value__",ro="__local_write_time__";function ra(e){var t,r;return(null==(r=((null==(t=null==e?void 0:e.mapValue)?void 0:t.fields)||{})[ri])?void 0:r.stringValue)===rn}function rl(e){let t=e.mapValue.fields[rs];return ra(t)?rl(t):t}function ru(e){let t=re(e.mapValue.fields[ro].timestampValue);return new tU(t.seconds,t.nanos)}class rc{constructor(e,t,r,n,i,s,o,a,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=n,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l,this.isUsingEmulator=u}}let rh="(default)";class rd{constructor(e,t){this.projectId=e,this.database=t||rh}static empty(){return new rd("","")}get isDefaultDatabase(){return this.database===rh}isEqual(e){return e instanceof rd&&e.projectId===this.projectId&&e.database===this.database}}let rf="__type__",rp="__max__",rg={},rm="__vector__",ry="value";function rv(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?ra(e)?4:rD(e)?0x1fffffffffffff:rN(e)?10:11:ty(28295,{value:e})}function rw(e,t){if(e===t)return!0;let r=rv(e);if(r!==rv(t))return!1;switch(r){case 0:case 0x1fffffffffffff:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return ru(e).isEqual(ru(t));case 3:if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;let n=re(e.timestampValue),i=re(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos;case 5:return e.stringValue===t.stringValue;case 6:return rr(e.bytesValue).isEqual(rr(t.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return rt(e.geoPointValue.latitude)===rt(t.geoPointValue.latitude)&&rt(e.geoPointValue.longitude)===rt(t.geoPointValue.longitude);case 2:if("integerValue"in e&&"integerValue"in t)return rt(e.integerValue)===rt(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){let r=rt(e.doubleValue),n=rt(t.doubleValue);return r===n?tX(r)===tX(n):isNaN(r)&&isNaN(n)}return!1;case 9:return tM(e.arrayValue.values||[],t.arrayValue.values||[],rw);case 10:case 11:let s=e.mapValue.fields||{},o=t.mapValue.fields||{};if(tJ(s)!==tJ(o))return!1;for(let e in s)if(s.hasOwnProperty(e)&&(void 0===o[e]||!rw(s[e],o[e])))return!1;return!0;default:return ty(52216,{left:e})}}function rb(e,t){return void 0!==(e.values||[]).find(e=>rw(e,t))}function r_(e,t){var r,n,i,s,o,a,l,u,c,h;if(e===t)return 0;let d=rv(e),f=rv(t);if(d!==f)return tD(d,f);switch(d){case 0:case 0x1fffffffffffff:return 0;case 1:return tD(e.booleanValue,t.booleanValue);case 2:let p,g;return p=rt(e.integerValue||e.doubleValue),p<(g=rt(t.integerValue||t.doubleValue))?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1;case 3:return rE(e.timestampValue,t.timestampValue);case 4:return rE(ru(e),ru(t));case 5:return tP(e.stringValue,t.stringValue);case 6:let m,y;return r=e.bytesValue,n=t.bytesValue,m=rr(r),y=rr(n),m.compareTo(y);case 7:return function(e,t){let r=e.split("/"),n=t.split("/");for(let e=0;e<r.length&&e<n.length;e++){let t=tD(r[e],n[e]);if(0!==t)return t}return tD(r.length,n.length)}(e.referenceValue,t.referenceValue);case 8:let v;return i=e.geoPointValue,s=t.geoPointValue,0!==(v=tD(rt(i.latitude),rt(s.latitude)))?v:tD(rt(i.longitude),rt(s.longitude));case 9:return rI(e.arrayValue,t.arrayValue);case 10:let w,b,_,E,I;return o=e.mapValue,a=t.mapValue,w=o.fields||{},b=a.fields||{},_=null==(l=w[ry])?void 0:l.arrayValue,E=null==(u=b[ry])?void 0:u.arrayValue,0!==(I=tD((null==(c=null==_?void 0:_.values)?void 0:c.length)||0,(null==(h=null==E?void 0:E.values)?void 0:h.length)||0))?I:rI(_,E);case 11:return function(e,t){if(e===rg&&t===rg)return 0;if(e===rg)return 1;if(t===rg)return -1;let r=e.fields||{},n=Object.keys(r),i=t.fields||{},s=Object.keys(i);n.sort(),s.sort();for(let e=0;e<n.length&&e<s.length;++e){let t=tP(n[e],s[e]);if(0!==t)return t;let o=r_(r[n[e]],i[s[e]]);if(0!==o)return o}return tD(n.length,s.length)}(e.mapValue,t.mapValue);default:throw ty(23264,{Pe:d})}}function rE(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return tD(e,t);let r=re(e),n=re(t),i=tD(r.seconds,n.seconds);return 0!==i?i:tD(r.nanos,n.nanos)}function rI(e,t){let r=e.values||[],n=t.values||[];for(let e=0;e<r.length&&e<n.length;++e){let t=r_(r[e],n[e]);if(t)return t}return tD(r.length,n.length)}function rT(e){var t,r;let n;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(n=re(e.timestampValue),`time(${n.seconds},${n.nanos})`):"stringValue"in e?e.stringValue:"bytesValue"in e?rr(e.bytesValue).toBase64():"referenceValue"in e?(t=e.referenceValue,tq.fromName(t).toString()):"geoPointValue"in e?(r=e.geoPointValue,`geo(${r.latitude},${r.longitude})`):"arrayValue"in e?function(e){let t="[",r=!0;for(let n of e.values||[])r?r=!1:t+=",",t+=rT(n);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){let t=Object.keys(e.fields||{}).sort(),r="{",n=!0;for(let i of t)n?n=!1:r+=",",r+=`${i}:${rT(e.fields[i])}`;return r+"}"}(e.mapValue):ty(61005,{value:e})}function rS(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function rC(e){return!!e&&"integerValue"in e}function rk(e){return!!e&&"arrayValue"in e}function rA(e){return!!e&&"nullValue"in e}function rx(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function rR(e){return!!e&&"mapValue"in e}function rN(e){var t,r;return(null==(r=((null==(t=null==e?void 0:e.mapValue)?void 0:t.fields)||{})[rf])?void 0:r.stringValue)===rm}function rO(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){let t={mapValue:{fields:{}}};return tZ(e.mapValue.fields,(e,r)=>t.mapValue.fields[e]=rO(r)),t}if(e.arrayValue){let t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=rO(e.arrayValue.values[r]);return t}return Object.assign({},e)}function rD(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===rp}class rP{constructor(e){this.value=e}static empty(){return new rP({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(!rR(t=(t.mapValue.fields||{})[e.get(r)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=rO(t)}setAll(e){let t=tz.emptyPath(),r={},n=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){let e=this.getFieldsMap(t);this.applyChanges(e,r,n),r={},n=[],t=i.popLast()}e?r[i.lastSegment()]=rO(e):n.push(i.lastSegment())});let i=this.getFieldsMap(t);this.applyChanges(i,r,n)}delete(e){let t=this.field(e.popLast());rR(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return rw(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let n=t.mapValue.fields[e.get(r)];rR(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=n),t=n}return t.mapValue.fields}applyChanges(e,t,r){for(let n of(tZ(t,(t,r)=>e[t]=r),r))delete e[n]}clone(){return new rP(rO(this.value))}}class rL{constructor(e,t,r,n,i,s,o){this.key=e,this.documentType=t,this.version=r,this.readTime=n,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new rL(e,0,tV.min(),tV.min(),tV.min(),rP.empty(),0)}static newFoundDocument(e,t,r,n){return new rL(e,1,t,tV.min(),r,n,0)}static newNoDocument(e,t){return new rL(e,2,t,tV.min(),tV.min(),rP.empty(),0)}static newUnknownDocument(e,t){return new rL(e,3,t,tV.min(),tV.min(),rP.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(tV.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rP.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rP.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=tV.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof rL&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new rL(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class rM{constructor(e,t){this.position=e,this.inclusive=t}}function rU(e,t,r){let n=0;for(let i=0;i<e.position.length;i++){let s=t[i],o=e.position[i];if(n=s.field.isKeyField()?tq.comparator(tq.fromName(o.referenceValue),r.key):r_(o,r.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function rV(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!rw(e.position[r],t.position[r]))return!1;return!0}class rF{constructor(e,t="asc"){this.field=e,this.dir=t}}class rj{}class rB extends rj{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new rH(e,t,r):"array-contains"===t?new rQ(e,r):"in"===t?new rY(e,r):"not-in"===t?new rX(e,r):"array-contains-any"===t?new rJ(e,r):new rB(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new rG(e,r):new rK(e,r)}matches(e){let t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(r_(t,this.value)):null!==t&&rv(this.value)===rv(t)&&this.matchesComparison(r_(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ty(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class r$ extends rj{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new r$(e,t)}matches(e){return rz(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Te||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function rz(e){return"and"===e.op}function rq(e){for(let t of e.filters)if(t instanceof r$)return!1;return!0}class rH extends rB{constructor(e,t,r){super(e,t,r),this.key=tq.fromName(r.referenceValue)}matches(e){let t=tq.comparator(e.key,this.key);return this.matchesComparison(t)}}class rG extends rB{constructor(e,t){super(e,"in",t),this.keys=rW("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class rK extends rB{constructor(e,t){super(e,"not-in",t),this.keys=rW("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function rW(e,t){var r;return((null==(r=t.arrayValue)?void 0:r.values)||[]).map(e=>tq.fromName(e.referenceValue))}class rQ extends rB{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return rk(t)&&rb(t.arrayValue,this.value)}}class rY extends rB{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return null!==t&&rb(this.value.arrayValue,t)}}class rX extends rB{constructor(e,t){super(e,"not-in",t)}matches(e){if(rb(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!rb(this.value.arrayValue,t)}}class rJ extends rB{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!rk(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>rb(this.value.arrayValue,e))}}class rZ{constructor(e,t=null,r=[],n=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=n,this.limit=i,this.startAt=s,this.endAt=o,this.Ie=null}}function r0(e,t=null,r=[],n=[],i=null,s=null,o=null){return new rZ(e,t,r,n,i,s,o)}function r1(e){if(null===e.Ie){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(e=>(function e(t){if(t instanceof rB)return t.field.canonicalString()+t.op.toString()+rT(t.value);if(rq(t)&&rz(t))return t.filters.map(t=>e(t)).join(",");{let r=t.filters.map(t=>e(t)).join(",");return`${t.op}(${r})`}})(e)).join(","),t+="|ob:",t+=e.orderBy.map(e=>e.field.canonicalString()+e.dir).join(","),null==e.limit||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>rT(e)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>rT(e)).join(",")),e.Ie=t}return e.Ie}function r2(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let i=0;i<e.orderBy.length;i++){var r,n;if(r=e.orderBy[i],n=t.orderBy[i],!(r.dir===n.dir&&r.field.isEqual(n.field)))return!1}if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!function e(t,r){return t instanceof rB?r instanceof rB&&t.op===r.op&&t.field.isEqual(r.field)&&rw(t.value,r.value):t instanceof r$?r instanceof r$&&t.op===r.op&&t.filters.length===r.filters.length&&t.filters.reduce((t,n,i)=>t&&e(n,r.filters[i]),!0):void ty(19439)}(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!rV(e.startAt,t.startAt)&&rV(e.endAt,t.endAt)}function r6(e){return tq.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class r3{constructor(e,t=null,r=[],n=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=n,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function r5(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function r4(e){return null!==e.collectionGroup}function r8(e){if(null===e.Ee){let t;e.Ee=[];let r=new Set;for(let t of e.explicitOrderBy)e.Ee.push(t),r.add(t.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(t=new t3(tz.comparator),e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t).forEach(t=>{r.has(t.canonicalString())||t.isKeyField()||e.Ee.push(new rF(t,n))}),r.has(tz.keyField().canonicalString())||e.Ee.push(new rF(tz.keyField(),n))}return e.Ee}function r7(e){return e.de||(e.de=function(e,t){if("F"===e.limitType)return r0(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{let t="desc"===e.dir?"asc":"desc";return new rF(e.field,t)});let r=e.endAt?new rM(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new rM(e.startAt.position,e.startAt.inclusive):null;return r0(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}(e,r8(e))),e.de}function r9(e,t){let r=e.filters.concat([t]);return new r3(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function ne(e,t,r){return new r3(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function nt(e,t){return r2(r7(e),r7(t))&&e.limitType===t.limitType}function nr(e){return`${r1(r7(e))}|lt:${e.limitType}`}function nn(e){var t;let r;return`Query(target=${r=(t=r7(e)).path.canonicalString(),null!==t.collectionGroup&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(e=>(function e(t){return t instanceof rB?`${t.field.canonicalString()} ${t.op} ${rT(t.value)}`:t instanceof r$?t.op.toString()+" {"+t.getFilters().map(e).join(" ,")+"}":"Filter"})(e)).join(", ")}]`),null==t.limit||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(e=>`${e.field.canonicalString()} (${e.dir})`).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(e=>rT(e)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(e=>rT(e)).join(",")),`Target(${r})`}; limitType=${e.limitType})`}function ni(e,t){var r,n,i,s;let o,a,l;return t.isFoundDocument()&&(o=t.key.path,null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(o):tq.isDocumentKey(e.path)?e.path.isEqual(o):e.path.isImmediateParentOf(o))&&function(e,t){for(let r of r8(e))if(!r.field.isKeyField()&&null===t.data.field(r.field))return!1;return!0}(e,t)&&function(e,t){for(let r of e.filters)if(!r.matches(t))return!1;return!0}(e,t)&&(r=e,n=t,(!r.startAt||(i=r.startAt,a=rU(i,r8(r),n),i.inclusive?!!(a<=0):!!(a<0)))&&(!r.endAt||(s=r.endAt,l=rU(s,r8(r),n),s.inclusive?!!(l>=0):!!(l>0))))}function ns(e){return(t,r)=>{let n=!1;for(let i of r8(e)){let e=function(e,t,r){var n;let i,s,o=e.field.isKeyField()?tq.comparator(t.key,r.key):(n=e.field,i=t.data.field(n),s=r.data.field(n),null!==i&&null!==s?r_(i,s):ty(42886));switch(e.dir){case"asc":return o;case"desc":return -1*o;default:return ty(19790,{direction:e.dir})}}(i,t,r);if(0!==e)return e;n=n||i.field.isKeyField()}return 0}}class no{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r){for(let[t,n]of r)if(this.equalsFn(t,e))return n}}has(e){return void 0!==this.get(e)}set(e,t){let r=this.mapKeyFn(e),n=this.inner[r];if(void 0===n)return this.inner[r]=[[e,t]],void this.innerSize++;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return void(n[r]=[e,t]);n.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return 1===r.length?delete this.inner[t]:r.splice(n,1),this.innerSize--,!0;return!1}forEach(e){tZ(this.inner,(t,r)=>{for(let[t,n]of r)e(t,n)})}isEmpty(){return t0(this.inner)}size(){return this.innerSize}}let na=new t1(tq.comparator),nl=new t1(tq.comparator);function nu(...e){let t=nl;for(let r of e)t=t.insert(r.key,r);return t}function nc(e){let t=nl;return e.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function nh(){return new no(e=>e.toString(),(e,t)=>e.isEqual(t))}let nd=new t1(tq.comparator),nf=new t3(tq.comparator);function np(...e){let t=nf;for(let r of e)t=t.add(r);return t}let ng=new t3(tD);function nm(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:tX(t)?"-0":t}}function ny(e){return{integerValue:""+e}}class nv{constructor(){this._=void 0}}function nw(e,t){return e instanceof nS?rC(t)||t&&"doubleValue"in t?t:{integerValue:0}:null}class nb extends nv{}class n_ extends nv{constructor(e){super(),this.elements=e}}function nE(e,t){let r=nk(t);for(let t of e.elements)r.some(e=>rw(e,t))||r.push(t);return{arrayValue:{values:r}}}class nI extends nv{constructor(e){super(),this.elements=e}}function nT(e,t){let r=nk(t);for(let t of e.elements)r=r.filter(e=>!rw(e,t));return{arrayValue:{values:r}}}class nS extends nv{constructor(e,t){super(),this.serializer=e,this.Re=t}}function nC(e){return rt(e.integerValue||e.doubleValue)}function nk(e){return rk(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class nA{constructor(e,t){this.field=e,this.transform=t}}class nx{constructor(e,t){this.version=e,this.transformResults=t}}class nR{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new nR}static exists(e){return new nR(void 0,e)}static updateTime(e){return new nR(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nN(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class nO{}function nD(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new nB(e.key,nR.none()):new nM(e.key,e.data,nR.none());{let r=e.data,n=rP.empty(),i=new t3(tz.comparator);for(let e of t.fields)if(!i.has(e)){let t=r.field(e);null===t&&e.length>1&&(e=e.popLast(),t=r.field(e)),null===t?n.delete(e):n.set(e,t),i=i.add(e)}return new nU(e.key,n,new t4(i.toArray()),nR.none())}}function nP(e,t,r,n){return e instanceof nM?function(e,t,r,n){if(!nN(e.precondition,t))return r;let i=e.value.clone(),s=nj(e.fieldTransforms,n,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,r,n):e instanceof nU?function(e,t,r,n){if(!nN(e.precondition,t))return r;let i=nj(e.fieldTransforms,n,t),s=t.data;return(s.setAll(nV(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===r)?null:r.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,r,n):nN(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):r}function nL(e,t){var r,n;return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=e.fieldTransforms,n=t.fieldTransforms,!!(void 0===r&&void 0===n||!(!r||!n)&&tM(r,n,(e,t)=>{var r,n;return e.field.isEqual(t.field)&&(r=e.transform,n=t.transform,r instanceof n_&&n instanceof n_||r instanceof nI&&n instanceof nI?tM(r.elements,n.elements,rw):r instanceof nS&&n instanceof nS?rw(r.Re,n.Re):r instanceof nb&&n instanceof nb)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class nM extends nO{constructor(e,t,r,n=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class nU extends nO{constructor(e,t,r,n,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=n,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function nV(e){let t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){let n=e.data.field(r);t.set(r,n)}}),t}function nF(e,t,r){let n=new Map;tw(e.length===r.length,32656,{Ve:r.length,me:e.length});for(let s=0;s<r.length;s++){var i;let o=e[s],a=o.transform,l=t.data.field(o.field);n.set(o.field,(i=r[s],a instanceof n_?nE(a,l):a instanceof nI?nT(a,l):i))}return n}function nj(e,t,r){let n=new Map;for(let i of e){let e=i.transform,s=r.data.field(i.field);n.set(i.field,function(e,t,r){var n;let i,s,o;return e instanceof nb?(n=t,i={fields:{[ri]:{stringValue:rn},[ro]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}},n&&ra(n)&&(n=rl(n)),n&&(i.fields[rs]=n),{mapValue:i}):e instanceof n_?nE(e,t):e instanceof nI?nT(e,t):(o=nC(s=nw(e,t))+nC(e.Re),rC(s)&&rC(e.Re)?ny(o):nm(e.serializer,o))}(e,s,t))}return n}class nB extends nO{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class n$ extends nO{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class nz{constructor(e,t,r,n){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=n}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let t=0;t<this.mutations.length;t++){let n=this.mutations[t];n.key.isEqual(e.key)&&function(e,t,r){let n,i;e instanceof nM?(n=e.value.clone(),i=nF(e.fieldTransforms,t,r.transformResults),n.setAll(i),t.convertToFoundDocument(r.version,n).setHasCommittedMutations()):e instanceof nU?function(e,t,r){if(!nN(e.precondition,t))return t.convertToUnknownDocument(r.version);let n=nF(e.fieldTransforms,t,r.transformResults),i=t.data;i.setAll(nV(e)),i.setAll(n),t.convertToFoundDocument(r.version,i).setHasCommittedMutations()}(e,t,r):t.convertToNoDocument(r.version).setHasCommittedMutations()}(n,e,r[t])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=nP(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=nP(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=nh();return this.mutations.forEach(n=>{let i=e.get(n.key),s=i.overlayedDocument,o=this.applyToLocalView(s,i.mutatedFields),a=nD(s,o=t.has(n.key)?null:o);null!==a&&r.set(n.key,a),s.isValidDocument()||s.convertToNoDocument(tV.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),np())}isEqual(e){return this.batchId===e.batchId&&tM(this.mutations,e.mutations,(e,t)=>nL(e,t))&&tM(this.baseMutations,e.baseMutations,(e,t)=>nL(e,t))}}class nq{constructor(e,t,r,n){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=n}static from(e,t,r){tw(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let n=nd,i=e.mutations;for(let e=0;e<i.length;e++)n=n.insert(i[e].key,r[e].version);return new nq(e,t,r,n)}}class nH{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class nG{constructor(e,t){this.count=e,this.unchangedNames=t}}function nK(e){if(void 0===e)return tp("GRPC error has no .code"),tb.UNKNOWN;switch(e){case w.OK:return tb.OK;case w.CANCELLED:return tb.CANCELLED;case w.UNKNOWN:return tb.UNKNOWN;case w.DEADLINE_EXCEEDED:return tb.DEADLINE_EXCEEDED;case w.RESOURCE_EXHAUSTED:return tb.RESOURCE_EXHAUSTED;case w.INTERNAL:return tb.INTERNAL;case w.UNAVAILABLE:return tb.UNAVAILABLE;case w.UNAUTHENTICATED:return tb.UNAUTHENTICATED;case w.INVALID_ARGUMENT:return tb.INVALID_ARGUMENT;case w.NOT_FOUND:return tb.NOT_FOUND;case w.ALREADY_EXISTS:return tb.ALREADY_EXISTS;case w.PERMISSION_DENIED:return tb.PERMISSION_DENIED;case w.FAILED_PRECONDITION:return tb.FAILED_PRECONDITION;case w.ABORTED:return tb.ABORTED;case w.OUT_OF_RANGE:return tb.OUT_OF_RANGE;case w.UNIMPLEMENTED:return tb.UNIMPLEMENTED;case w.DATA_LOSS:return tb.DATA_LOSS;default:return ty(39323,{code:e})}}(b=w||(w={}))[b.OK=0]="OK",b[b.CANCELLED=1]="CANCELLED",b[b.UNKNOWN=2]="UNKNOWN",b[b.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",b[b.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",b[b.NOT_FOUND=5]="NOT_FOUND",b[b.ALREADY_EXISTS=6]="ALREADY_EXISTS",b[b.PERMISSION_DENIED=7]="PERMISSION_DENIED",b[b.UNAUTHENTICATED=16]="UNAUTHENTICATED",b[b.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",b[b.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",b[b.ABORTED=10]="ABORTED",b[b.OUT_OF_RANGE=11]="OUT_OF_RANGE",b[b.UNIMPLEMENTED=12]="UNIMPLEMENTED",b[b.INTERNAL=13]="INTERNAL",b[b.UNAVAILABLE=14]="UNAVAILABLE",b[b.DATA_LOSS=15]="DATA_LOSS";let nW=new u([0xffffffff,0xffffffff],0);function nQ(e){let t=tN().encode(e),r=new c;return r.update(t),new Uint8Array(r.digest())}function nY(e){let t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new u([r,n],0),new u([i,s],0)]}class nX{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new nJ(`Invalid padding: ${t}`);if(r<0||e.length>0&&0===this.hashCount)throw new nJ(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new nJ(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=u.fromNumber(this.pe)}we(e,t,r){let n=e.add(t.multiply(u.fromNumber(r)));return 1===n.compare(nW)&&(n=new u([n.getBits(0),n.getBits(1)],0)),n.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.pe)return!1;let[t,r]=nY(nQ(e));for(let e=0;e<this.hashCount;e++){let n=this.we(t,r,e);if(!this.be(n))return!1}return!0}static create(e,t,r){let n=new nX(new Uint8Array(Math.ceil(e/8)),e%8==0?0:8-e%8,t);return r.forEach(e=>n.insert(e)),n}insert(e){if(0===this.pe)return;let[t,r]=nY(nQ(e));for(let e=0;e<this.hashCount;e++){let n=this.we(t,r,e);this.Se(n)}}Se(e){let t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class nJ extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class nZ{constructor(e,t,r,n,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=n,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let n=new Map;return n.set(e,n0.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new nZ(tV.min(),n,new t1(tD),na,np())}}class n0{constructor(e,t,r,n,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=n,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n0(r,t,np(),np(),np())}}class n1{constructor(e,t,r,n){this.De=e,this.removedTargetIds=t,this.key=r,this.ve=n}}class n2{constructor(e,t){this.targetId=e,this.Ce=t}}class n6{constructor(e,t,r=t7.EMPTY_BYTE_STRING,n=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=n}}class n3{constructor(){this.Fe=0,this.Me=n8(),this.xe=t7.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return 0!==this.Fe}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=np(),t=np(),r=np();return this.Me.forEach((n,i)=>{switch(i){case 0:e=e.add(n);break;case 2:t=t.add(n);break;case 1:r=r.add(n);break;default:ty(38017,{changeType:i})}}),new n0(this.xe,this.Oe,e,t,r)}Qe(){this.Ne=!1,this.Me=n8()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,tw(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class n5{constructor(e){this.ze=e,this.je=new Map,this.He=na,this.Je=n4(),this.Ye=n4(),this.Ze=new t1(tD)}Xe(e){for(let t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(let t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{let r=this.rt(t);switch(e.state){case 0:this.it(t)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(t);break;case 3:this.it(t)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),r.ke(e.resumeToken));break;default:ty(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((e,r)=>{this.it(r)&&t(r)})}ot(e){let t=e.targetId,r=e.Ce.count,n=this._t(t);if(n){let i=n.target;if(r6(i))if(0===r){let e=new tq(i.path);this.tt(t,e,rL.newNoDocument(e,tV.min()))}else tw(1===r,20013,{expectedCount:r});else{let n=this.ut(t);if(n!==r){let r=this.ct(e),i=r?this.lt(r,e,n):1;0!==i&&(this.st(t),this.Ze=this.Ze.insert(t,2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}ct(e){let t,r,n=e.Ce.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:i="",padding:s=0},hashCount:o=0}=n;try{t=rr(i).toUint8Array()}catch(e){if(e instanceof t8)return tg("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{r=new nX(t,s,o)}catch(e){return tg(e instanceof nJ?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===r.pe?null:r}lt(e,t,r){return 2*(t.Ce.count!==r-this.Tt(e,t.targetId))}Tt(e,t){let r=this.ze.getRemoteKeysForTarget(t),n=0;return r.forEach(r=>{let i=this.ze.Pt(),s=`projects/${i.projectId}/databases/${i.database}/documents/${r.path.canonicalString()}`;e.mightContain(s)||(this.tt(t,r,null),n++)}),n}It(e){let t=new Map;this.je.forEach((r,n)=>{let i=this._t(n);if(i){if(r.current&&r6(i.target)){let t=new tq(i.target.path);this.Et(t).has(n)||this.dt(n,t)||this.tt(n,t,rL.newNoDocument(t,e))}r.Le&&(t.set(n,r.qe()),r.Qe())}});let r=np();this.Ye.forEach((e,t)=>{let n=!0;t.forEachWhile(e=>{let t=this._t(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(n=!1,!1)}),n&&(r=r.add(e))}),this.He.forEach((t,r)=>r.setReadTime(e));let n=new nZ(e,t,this.Ze,this.He,r);return this.He=na,this.Je=n4(),this.Ye=n4(),this.Ze=new t1(tD),n}et(e,t){if(!this.it(e))return;let r=2*!!this.dt(e,t.key);this.rt(e).$e(t.key,r),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,r){if(!this.it(e))return;let n=this.rt(e);this.dt(e,t)?n.$e(t,1):n.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),r&&(this.He=this.He.insert(t,r))}removeTarget(e){this.je.delete(e)}ut(e){let t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new n3,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new t3(tD),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new t3(tD),this.Je=this.Je.insert(e,t)),t}it(e){let t=null!==this._t(e);return t||tf("WatchChangeAggregator","Detected inactive target",e),t}_t(e){let t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new n3),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function n4(){return new t1(tq.comparator)}function n8(){return new t1(tq.comparator)}let n7={asc:"ASCENDING",desc:"DESCENDING"},n9={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ie={and:"AND",or:"OR"};class it{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ir(e,t){return e.useProto3Json||null==t?t:{value:t}}function ii(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function is(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function io(e){let t;return tw(!!e,49232),tV.fromTimestamp(new tU((t=re(e)).seconds,t.nanos))}function ia(e,t){return il(e,t).canonicalString()}function il(e,t){let r=new tB(["projects",e.projectId,"databases",e.database]).child("documents");return void 0===t?r:r.child(t)}function iu(e){let t=tB.fromString(e);return tw(iw(t),10190,{key:t.toString()}),t}function ic(e,t){return ia(e.databaseId,t.path)}function ih(e,t){let r=iu(t);if(r.get(1)!==e.databaseId.projectId)throw new t_(tb.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new t_(tb.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new tq(ig(r))}function id(e,t){return ia(e.databaseId,t)}function ip(e){return new tB(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function ig(e){return tw(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function im(e,t,r){return{name:ic(e,t),fields:r.value.mapValue.fields}}function iy(e){return{fieldPath:e.canonicalString()}}function iv(e){return tz.fromServerFormat(e.fieldPath)}function iw(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class ib{constructor(e,t,r,n,i=tV.min(),s=tV.min(),o=t7.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=n,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new ib(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ib(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ib(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ib(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class i_{constructor(e){this.wt=e}}class iE{vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(+!!e.booleanValue);else if("integerValue"in e)this.Mt(t,15),t.xt(rt(e.integerValue));else if("doubleValue"in e){let r=rt(e.doubleValue);isNaN(r)?this.Mt(t,13):(this.Mt(t,15),tX(r)?t.xt(0):t.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(t,20),"string"==typeof r&&(r=re(r)),t.Ot(`${r.seconds||""}`),t.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(rr(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Mt(t,45),t.xt(r.latitude||0),t.xt(r.longitude||0)}else"mapValue"in e?rD(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):rN(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):ty(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){let r=e.fields||{};for(let e of(this.Mt(t,55),Object.keys(r)))this.Nt(e,t),this.Ct(r[e],t)}qt(e,t){var r,n;let i=e.fields||{};this.Mt(t,53);let s=(null==(n=null==(r=i[ry].arrayValue)?void 0:r.values)?void 0:n.length)||0;this.Mt(t,15),t.xt(rt(s)),this.Nt(ry,t),this.Ct(i[ry],t)}$t(e,t){let r=e.values||[];for(let e of(this.Mt(t,50),r))this.Ct(e,t)}kt(e,t){this.Mt(t,37),tq.fromName(e).path.forEach(e=>{this.Mt(t,60),this.Kt(e,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}}iE.Wt=new iE;class iI{constructor(){this.Cn=new iT}addToCollectionParentIndex(e,t){return this.Cn.add(t),tW.resolve()}getCollectionParents(e,t){return tW.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return tW.resolve()}deleteFieldIndex(e,t){return tW.resolve()}deleteAllFieldIndexes(e){return tW.resolve()}createTargetIndexes(e,t){return tW.resolve()}getDocumentsMatchingTarget(e,t){return tW.resolve(null)}getIndexType(e,t){return tW.resolve(0)}getFieldIndexes(e,t){return tW.resolve([])}getNextCollectionGroupToUpdate(e){return tW.resolve(null)}getMinOffset(e,t){return tW.resolve(tH.min())}getMinOffsetFromCollectionGroup(e,t){return tW.resolve(tH.min())}updateCollectionGroup(e,t,r){return tW.resolve()}updateIndexEntries(e,t){return tW.resolve()}}class iT{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),n=this.index[t]||new t3(tB.comparator),i=!n.has(r);return this.index[t]=n.add(r),i}has(e){let t=e.lastSegment(),r=e.popLast(),n=this.index[t];return n&&n.has(r)}getEntries(e){return(this.index[e]||new t3(tB.comparator)).toArray()}}new Uint8Array(0);let iS={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class iC{static withCacheSize(e){return new iC(e,iC.DEFAULT_COLLECTION_PERCENTILE,iC.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}iC.DEFAULT_COLLECTION_PERCENTILE=10,iC.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,iC.DEFAULT=new iC(0x2800000,iC.DEFAULT_COLLECTION_PERCENTILE,iC.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),iC.DISABLED=new iC(-1,0,0);class ik{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new ik(0)}static lr(){return new ik(-1)}}let iA="LruGarbageCollector";function ix([e,t],[r,n]){let i=tD(e,r);return 0===i?tD(t,n):i}class iR{constructor(e){this.Er=e,this.buffer=new t3(ix),this.dr=0}Ar(){return++this.dr}Rr(e){let t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{let e=this.buffer.last();0>ix(t,e)&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class iN{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Vr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return null!==this.Vr}mr(e){tf(iA,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){tQ(e)?tf(iA,"Ignoring IndexedDB error during garbage collection: ",e):await tK(e)}await this.mr(3e5)})}}class iO{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return tW.resolve(tY.le);let r=new iR(t);return this.gr.forEachTarget(e,e=>r.Rr(e.sequenceNumber)).next(()=>this.gr.yr(e,e=>r.Rr(e))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.gr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return -1===this.params.cacheSizeCollectionThreshold?(tf("LruGarbageCollector","Garbage collection skipped; disabled"),tW.resolve(iS)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(tf("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),iS):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let r,n,i,s,o,a,u,c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(tf("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),n=this.params.maximumSequenceNumbersToCollect):n=t,s=Date.now(),this.nthSequenceNumber(e,n))).next(n=>(r=n,o=Date.now(),this.removeTargets(e,r,t))).next(t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,r))).next(e=>(u=Date.now(),td()<=l.DEBUG&&tf("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-c}ms
	Determined least recently used ${n} in `+(o-s)+"ms\n"+`	Removed ${i} targets in `+(a-o)+"ms\n"+`	Removed ${e} documents in `+(u-a)+"ms\n"+`Total Duration: ${u-c}ms`),tW.resolve({didRun:!0,sequenceNumbersCollected:n,targetsRemoved:i,documentsRemoved:e})))}}class iD{constructor(){this.changes=new no(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,rL.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return void 0!==r?tW.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class iP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class iL{constructor(e,t,r,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=n}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(n=>(r=n,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==r&&nP(r.mutation,e,t4.empty(),tU.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,np()).next(()=>t))}getLocalViewOfDocuments(e,t,r=np()){let n=nh();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,r).next(e=>{let t=nu();return e.forEach((e,r)=>{t=t.insert(e,r.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){let r=nh();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,np()))}populateOverlays(e,t,r){let n=[];return r.forEach(e=>{t.has(e)||n.push(e)}),this.documentOverlayCache.getOverlays(e,n).next(e=>{e.forEach((e,r)=>{t.set(e,r)})})}computeViews(e,t,r,n){let i=na,s=nh(),o=nh();return t.forEach((e,t)=>{let o=r.get(t.key);n.has(t.key)&&(void 0===o||o.mutation instanceof nU)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),nP(o.mutation,t,o.mutation.getFieldMask(),tU.now())):s.set(t.key,t4.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var r;return o.set(e,new iP(t,null!=(r=s.get(e))?r:null))}),o))}recalculateAndSaveOverlays(e,t){let r=nh(),n=new t1((e,t)=>e-t),i=np();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(let i of e)i.keys().forEach(e=>{let s=t.get(e);if(null===s)return;let o=r.get(e)||t4.empty();o=i.applyToLocalView(s,o),r.set(e,o);let a=(n.get(i.batchId)||np()).add(e);n=n.insert(i.batchId,a)})}).next(()=>{let s=[],o=n.getReverseIterator();for(;o.hasNext();){let n=o.getNext(),a=n.key,l=n.value,u=nh();l.forEach(e=>{if(!i.has(e)){let n=nD(t.get(e),r.get(e));null!==n&&u.set(e,n),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return tW.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,r,n){return tq.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):r4(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,n):this.getDocumentsMatchingCollectionQuery(e,t,r,n)}getNextDocuments(e,t,r,n){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,n).next(i=>{let s=n-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,n-i.size):tW.resolve(nh()),o=-1,a=i;return s.next(t=>tW.forEach(t,(t,r)=>(o<r.largestBatchId&&(o=r.largestBatchId),i.get(t)?tW.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,np())).next(e=>({batchId:o,changes:nc(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new tq(t)).next(e=>{let t=nu();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,r,n){let i=t.collectionGroup,s=nu();return this.indexManager.getCollectionParents(e,i).next(o=>tW.forEach(o,o=>{let a=new r3(o.child(i),null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt);return this.getDocumentsMatchingCollectionQuery(e,a,r,n).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,n))).next(e=>{i.forEach((t,r)=>{let n=r.getKey();null===e.get(n)&&(e=e.insert(n,rL.newInvalidDocument(n)))});let r=nu();return e.forEach((e,n)=>{let s=i.get(e);void 0!==s&&nP(s.mutation,n,t4.empty(),tU.now()),ni(t,n)&&(r=r.insert(e,n))}),r})}}class iM{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return tW.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,{id:t.id,version:t.version,createTime:io(t.createTime)}),tW.resolve()}getNamedQuery(e,t){return tW.resolve(this.qr.get(t))}saveNamedQuery(e,t){var r;let n;return this.qr.set(t.name,{name:t.name,query:(n=function(e){var t,r,n,i;let s,o,a,l,u,c=4===(s=iu(e.parent)).length?tB.emptyPath():ig(s),h=e.structuredQuery,d=h.from?h.from.length:0,f=null;if(d>0){tw(1===d,65062);let e=h.from[0];e.allDescendants?f=e.collectionId:c=c.child(e.collectionId)}let p=[];h.where&&(p=(o=function e(t){return void 0!==t.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":let t=iv(e.unaryFilter.field);return rB.create(t,"==",{doubleValue:NaN});case"IS_NULL":let r=iv(e.unaryFilter.field);return rB.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let n=iv(e.unaryFilter.field);return rB.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let i=iv(e.unaryFilter.field);return rB.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ty(61313);default:return ty(60726)}}(t):void 0!==t.fieldFilter?rB.create(iv(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ty(58110);default:return ty(50506)}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==t.compositeFilter?r$.create(t.compositeFilter.filters.map(t=>e(t)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return ty(1026)}}(t.compositeFilter.op)):ty(30097,{filter:t})}(h.where))instanceof r$&&rq(t=o)&&rz(t)?o.getFilters():[o]);let g=[];h.orderBy&&(g=h.orderBy.map(e=>new rF(iv(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))));let m=null;h.limit&&(m=null==(a="object"==typeof(r=h.limit)?r.value:r)?null:a);let y=null;h.startAt&&(l=!!(n=h.startAt).before,y=new rM(n.values||[],l));let v=null;return h.endAt&&(u=!(i=h.endAt).before,v=new rM(i.values||[],u)),new r3(c,f,g,p,m,"F",y,v)}({parent:(r=t.bundledQuery).parent,structuredQuery:r.structuredQuery}),"LAST"===r.limitType?ne(n,n.limit,"L"):n),readTime:io(t.readTime)}),tW.resolve()}}class iU{constructor(){this.overlays=new t1(tq.comparator),this.Qr=new Map}getOverlay(e,t){return tW.resolve(this.overlays.get(t))}getOverlays(e,t){let r=nh();return tW.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((r,n)=>{this.St(e,t,n)}),tW.resolve()}removeOverlaysForBatchId(e,t,r){let n=this.Qr.get(r);return void 0!==n&&(n.forEach(e=>this.overlays=this.overlays.remove(e)),this.Qr.delete(r)),tW.resolve()}getOverlaysForCollection(e,t,r){let n=nh(),i=t.length+1,s=new tq(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){let e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>r&&n.set(e.getKey(),e)}return tW.resolve(n)}getOverlaysForCollectionGroup(e,t,r,n){let i=new t1((e,t)=>e-t),s=this.overlays.getIterator();for(;s.hasNext();){let e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>r){let t=i.get(e.largestBatchId);null===t&&(t=nh(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}let o=nh(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=n)););return tW.resolve(o)}St(e,t,r){let n=this.overlays.get(r.key);if(null!==n){let e=this.Qr.get(n.largestBatchId).delete(r.key);this.Qr.set(n.largestBatchId,e)}this.overlays=this.overlays.insert(r.key,new nH(t,r));let i=this.Qr.get(t);void 0===i&&(i=np(),this.Qr.set(t,i)),this.Qr.set(t,i.add(r.key))}}class iV{constructor(){this.sessionToken=t7.EMPTY_BYTE_STRING}getSessionToken(e){return tW.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,tW.resolve()}}class iF{constructor(){this.$r=new t3(ij.Ur),this.Kr=new t3(ij.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){let r=new ij(e,t);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.zr(new ij(e,t))}jr(e,t){e.forEach(e=>this.removeReference(e,t))}Hr(e){let t=new tq(new tB([])),r=new ij(t,e),n=new ij(t,e+1),i=[];return this.Kr.forEachInRange([r,n],e=>{this.zr(e),i.push(e.key)}),i}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){let t=new tq(new tB([])),r=new ij(t,e),n=new ij(t,e+1),i=np();return this.Kr.forEachInRange([r,n],e=>{i=i.add(e.key)}),i}containsKey(e){let t=new ij(e,0),r=this.$r.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class ij{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return tq.comparator(e.key,t.key)||tD(e.Zr,t.Zr)}static Wr(e,t){return tD(e.Zr,t.Zr)||tq.comparator(e.key,t.key)}}class iB{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new t3(ij.Ur)}checkEmpty(e){return tW.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,n){let i=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new nz(i,t,r,n);for(let t of(this.mutationQueue.push(s),n))this.Xr=this.Xr.add(new ij(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return tW.resolve(s)}lookupMutationBatch(e,t){return tW.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){let r=this.ti(t+1),n=r<0?0:r;return tW.resolve(this.mutationQueue.length>n?this.mutationQueue[n]:null)}getHighestUnacknowledgedBatchId(){return tW.resolve(0===this.mutationQueue.length?-1:this.nr-1)}getAllMutationBatches(e){return tW.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new ij(t,0),n=new ij(t,1/0),i=[];return this.Xr.forEachInRange([r,n],e=>{let t=this.ei(e.Zr);i.push(t)}),tW.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new t3(tD);return t.forEach(e=>{let t=new ij(e,0),n=new ij(e,1/0);this.Xr.forEachInRange([t,n],e=>{r=r.add(e.Zr)})}),tW.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,n=r.length+1,i=r;tq.isDocumentKey(i)||(i=i.child(""));let s=new ij(new tq(i),0),o=new t3(tD);return this.Xr.forEachWhile(e=>{let t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===n&&(o=o.add(e.Zr)),!0)},s),tW.resolve(this.ni(o))}ni(e){let t=[];return e.forEach(e=>{let r=this.ei(e);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){tw(0===this.ri(t.batchId,"removed"),55003),this.mutationQueue.shift();let r=this.Xr;return tW.forEach(t.mutations,n=>{let i=new ij(n.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,n.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,t){let r=new ij(t,0),n=this.Xr.firstAfterOrEqual(r);return tW.resolve(t.isEqual(n&&n.key))}performConsistencyCheck(e){return this.mutationQueue.length,tW.resolve()}ri(e,t){return this.ti(e)}ti(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ei(e){let t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class i${constructor(e){this.ii=e,this.docs=new t1(tq.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,n=this.docs.get(r),i=n?n.size:0,s=this.ii(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return tW.resolve(r?r.document.mutableCopy():rL.newInvalidDocument(t))}getEntries(e,t){let r=na;return t.forEach(e=>{let t=this.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():rL.newInvalidDocument(e))}),tW.resolve(r)}getDocumentsMatchingQuery(e,t,r,n){let i=na,s=t.path,o=new tq(s.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){let{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||0>=function(e,t){let r=e.readTime.compareTo(t.readTime);return 0!==r||0!==(r=tq.comparator(e.documentKey,t.documentKey))?r:tD(e.largestBatchId,t.largestBatchId)}(new tH(o.readTime,o.key,-1),r)||(n.has(o.key)||ni(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return tW.resolve(i)}getAllFromCollectionGroup(e,t,r,n){ty(9500)}si(e,t){return tW.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new iz(this)}getSize(e){return tW.resolve(this.size)}}class iz extends iD{constructor(e){super(),this.Br=e}applyChanges(e){let t=[];return this.changes.forEach((r,n)=>{n.isValidDocument()?t.push(this.Br.addEntry(e,n)):this.Br.removeEntry(r)}),tW.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}class iq{constructor(e){this.persistence=e,this.oi=new no(e=>r1(e),r2),this.lastRemoteSnapshotVersion=tV.min(),this.highestTargetId=0,this._i=0,this.ai=new iF,this.targetCount=0,this.ui=ik.cr()}forEachTarget(e,t){return this.oi.forEach((e,r)=>t(r)),tW.resolve()}getLastRemoteSnapshotVersion(e){return tW.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return tW.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),tW.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this._i&&(this._i=t),tW.resolve()}Tr(e){this.oi.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ui=new ik(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,tW.resolve()}updateTargetData(e,t){return this.Tr(t),tW.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,tW.resolve()}removeTargets(e,t,r){let n=0,i=[];return this.oi.forEach((s,o)=>{o.sequenceNumber<=t&&null===r.get(o.targetId)&&(this.oi.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),n++)}),tW.waitFor(i).next(()=>n)}getTargetCount(e){return tW.resolve(this.targetCount)}getTargetData(e,t){let r=this.oi.get(t)||null;return tW.resolve(r)}addMatchingKeys(e,t,r){return this.ai.Gr(t,r),tW.resolve()}removeMatchingKeys(e,t,r){this.ai.jr(t,r);let n=this.persistence.referenceDelegate,i=[];return n&&t.forEach(t=>{i.push(n.markPotentiallyOrphaned(e,t))}),tW.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),tW.resolve()}getMatchingKeysForTargetId(e,t){let r=this.ai.Yr(t);return tW.resolve(r)}containsKey(e,t){return tW.resolve(this.ai.containsKey(t))}}class iH{constructor(e,t){this.ci={},this.overlays={},this.li=new tY(0),this.hi=!1,this.hi=!0,this.Pi=new iV,this.referenceDelegate=e(this),this.Ti=new iq(this),this.indexManager=new iI,this.remoteDocumentCache=new i$(e=>this.referenceDelegate.Ii(e)),this.serializer=new i_(t),this.Ei=new iM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new iU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ci[e.toKey()];return r||(r=new iB(t,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,r){tf("MemoryPersistence","Starting transaction:",e);let n=new iG(this.li.next());return this.referenceDelegate.di(),r(n).next(e=>this.referenceDelegate.Ai(n).next(()=>e)).toPromise().then(e=>(n.raiseOnCommittedEvent(),e))}Ri(e,t){return tW.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,t)))}}class iG extends tG{constructor(e){super(),this.currentSequenceNumber=e}}class iK{constructor(e){this.persistence=e,this.Vi=new iF,this.mi=null}static fi(e){return new iK(e)}get gi(){if(this.mi)return this.mi;throw ty(60996)}addReference(e,t,r){return this.Vi.addReference(r,t),this.gi.delete(r.toString()),tW.resolve()}removeReference(e,t,r){return this.Vi.removeReference(r,t),this.gi.add(r.toString()),tW.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),tW.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(e=>this.gi.add(e.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.gi.add(e.toString()))}).next(()=>r.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return tW.forEach(this.gi,r=>{let n=tq.fromPath(r);return this.pi(e,n).next(e=>{e||t.removeEntry(n,tV.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(e=>{e?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return tW.or([()=>tW.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class iW{constructor(e,t){this.persistence=e,this.yi=new no(e=>(function(e){let t="";for(let r=0;r<e.length;r++)t.length>0&&(t+="\x01\x01"),t=function(e,t){let r=t,n=e.length;for(let t=0;t<n;t++){let n=e.charAt(t);switch(n){case"\0":r+="\x01\x10";break;case"\x01":r+="\x01\x11";break;default:r+=n}}return r}(e.get(r),t);return t+"\x01\x01"})(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=new iO(this,t)}static fi(e,t){return new iW(e,t)}di(){}Ai(e){return tW.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){let t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}br(e){let t=0;return this.yr(e,e=>{t++}).next(()=>t)}yr(e,t){return tW.forEach(this.yi,(r,n)=>this.Dr(e,r,n).next(e=>e?tW.resolve():t(n)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,n=this.persistence.getRemoteDocumentCache(),i=n.newChangeBuffer();return n.si(e,n=>this.Dr(e,n,t).next(e=>{e||(r++,i.removeEntry(n,tV.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),tW.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),tW.resolve()}removeReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),tW.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),tW.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=function e(t){switch(rv(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let r=rl(t);return r?16+e(r):16;case 5:return 2*t.stringValue.length;case 6:return rr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(t.arrayValue.values||[]).reduce((t,r)=>t+e(r),0);case 10:case 11:var n;let i;return n=t.mapValue,i=0,tZ(n.fields,(t,r)=>{i+=t.length+e(r)}),i;default:throw ty(13486,{value:t})}}(e.data.value)),t}Dr(e,t,r){return tW.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let e=this.yi.get(t);return tW.resolve(void 0!==e&&e>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class iQ{constructor(e,t,r,n){this.targetId=e,this.fromCache=t,this.ds=r,this.As=n}static Rs(e,t){let r=np(),n=np();for(let e of t.docChanges)switch(e.type){case 0:r=r.add(e.doc.key);break;case 1:n=n.add(e.doc.key)}return new iQ(e,t.fromCache,r,n)}}class iY{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class iX{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){let t;return!function(){var t;let r=null==(t=P())?void 0:t.forceEnvironment;if("node"===r)return!0;if("browser"===r)return!1;try{return"[object process]"===Object.prototype.toString.call(e.g.process)}catch(e){return!1}}()&&navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")?8:Number((t=G().match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1")>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,r,n){let i={result:null};return this.ws(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.bs(e,t,n,r).next(e=>{i.result=e})}).next(()=>{if(i.result)return;let r=new iY;return this.Ss(e,t,r).next(n=>{if(i.result=n,this.fs)return this.Ds(e,t,r,n.size)})}).next(()=>i.result)}Ds(e,t,r,n){return r.documentReadCount<this.gs?(td()<=l.DEBUG&&tf("QueryEngine","SDK will not create cache indexes for query:",nn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),tW.resolve()):(td()<=l.DEBUG&&tf("QueryEngine","Query:",nn(t),"scans",r.documentReadCount,"local documents and returns",n,"documents as results."),r.documentReadCount>this.ps*n?(td()<=l.DEBUG&&tf("QueryEngine","The SDK decides to create cache indexes for query:",nn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,r7(t))):tW.resolve())}ws(e,t){if(r5(t))return tW.resolve(null);let r=r7(t);return this.indexManager.getIndexType(e,r).next(n=>0===n?null:(null!==t.limit&&1===n&&(r=r7(t=ne(t,null,"F"))),this.indexManager.getDocumentsMatchingTarget(e,r).next(n=>{let i=np(...n);return this.ys.getDocuments(e,i).next(n=>this.indexManager.getMinOffset(e,r).next(r=>{let s=this.vs(t,n);return this.Cs(t,s,i,r.readTime)?this.ws(e,ne(t,null,"F")):this.Fs(e,s,t,r)}))})))}bs(e,t,r,n){return r5(t)||n.isEqual(tV.min())?tW.resolve(null):this.ys.getDocuments(e,r).next(i=>{let s,o,a=this.vs(t,i);return this.Cs(t,a,r,n)?tW.resolve(null):(td()<=l.DEBUG&&tf("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),nn(t)),this.Fs(e,a,t,(s=n.toTimestamp().seconds,o=n.toTimestamp().nanoseconds+1,new tH(tV.fromTimestamp(1e9===o?new tU(s+1,0):new tU(s,o)),tq.empty(),-1))).next(e=>e))})}vs(e,t){let r=new t3(ns(e));return t.forEach((t,n)=>{ni(e,n)&&(r=r.add(n))}),r}Cs(e,t,r,n){if(null===e.limit)return!1;if(r.size!==t.size)return!0;let i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(n)>0)}Ss(e,t,r){return td()<=l.DEBUG&&tf("QueryEngine","Using full collection scan to execute query:",nn(t)),this.ys.getDocumentsMatchingQuery(e,t,tH.min(),r)}Fs(e,t,r,n){return this.ys.getDocumentsMatchingQuery(e,r,n).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}let iJ="LocalStore";class iZ{constructor(e,t,r,n){this.persistence=e,this.Ms=t,this.serializer=n,this.xs=new t1(tD),this.Os=new no(e=>r1(e),r2),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new iL(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}async function i0(e,t){return await e.persistence.runTransaction("Handle user change","readonly",r=>{let n;return e.mutationQueue.getAllMutationBatches(r).next(i=>(n=i,e.Ls(t),e.mutationQueue.getAllMutationBatches(r))).next(t=>{let i=[],s=[],o=np();for(let e of n)for(let t of(i.push(e.batchId),e.mutations))o=o.add(t.key);for(let e of t)for(let t of(s.push(e.batchId),e.mutations))o=o.add(t.key);return e.localDocuments.getDocuments(r,o).next(e=>({ks:e,removedBatchIds:i,addedBatchIds:s}))})})}function i1(e){return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}async function i2(e,t,r){let n=e.xs.get(t);try{r||await e.persistence.runTransaction("Release target",r?"readwrite":"readwrite-primary",t=>e.persistence.referenceDelegate.removeTarget(t,n))}catch(e){if(!tQ(e))throw e;tf(iJ,`Failed to update sequence numbers for target ${t}: ${e}`)}e.xs=e.xs.remove(t),e.Os.delete(n.target)}function i6(e,t,r){let n=tV.min(),i=np();return e.persistence.runTransaction("Execute query","readwrite",s=>{var o;let a;return(o=r7(t),void 0!==(a=e.Os.get(o))?tW.resolve(e.xs.get(a)):e.Ti.getTargetData(s,o)).next(t=>{if(t)return n=t.lastLimboFreeSnapshotVersion,e.Ti.getMatchingKeysForTargetId(s,t.targetId).next(e=>{i=e})}).next(()=>e.Ms.getDocumentsMatchingQuery(s,t,r?n:tV.min(),r?i:np())).next(r=>{var n,s,o;let a;return n=e,s=t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2)),o=r,a=n.Ns.get(s)||tV.min(),o.forEach((e,t)=>{t.readTime.compareTo(a)>0&&(a=t.readTime)}),n.Ns.set(s,a),{documents:r,$s:i}})})}class i3{constructor(){this.activeTargetIds=ng}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})}}class i5{constructor(){this.xo=new i3,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,r){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new i3,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class i4{No(e){}shutdown(){}}let i8="ConnectivityMonitor";class i7{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){for(let e of(tf(i8,"Network connectivity changed: AVAILABLE"),this.Qo))e(0)}qo(){for(let e of(tf(i8,"Network connectivity changed: UNAVAILABLE"),this.Qo))e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let i9=null;function se(){return null===i9?i9=0x10000000+Math.round(0x80000000*Math.random()):i9++,"0x"+i9.toString(16)}let st="RestConnection",sr={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class sn{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),n=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${r}/databases/${n}`,this.Go=this.databaseId.database===rh?`project_id=${r}`:`project_id=${r}&database_id=${n}`}zo(e,t,r,n,i){let s=se(),o=this.jo(e,t.toUriEncodedString());tf(st,`Sending RPC '${e}' ${s}:`,o,r);let a={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(a,n,i);let{host:l}=new URL(o),u=j(l);return this.Jo(e,o,a,r,u).then(t=>(tf(st,`Received RPC '${e}' ${s}: `,t),t),t=>{throw tg(st,`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",r),t})}Yo(e,t,r,n,i,s){return this.zo(e,t,r,n,i)}Ho(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+tc,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,r)=>e[r]=t),r&&r.headers.forEach((t,r)=>e[r]=t)}jo(e,t){let r=sr[e];return`${this.Ko}/v1/${t}:${r}`}terminate(){}}class si{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}let ss="WebChannelConnection";class so extends sn{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,n,i){let s=se();return new Promise((i,o)=>{let a=new h;a.setWithCredentials(!0),a.listenOnce(f.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case p.NO_ERROR:let t=a.getResponseJson();tf(ss,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),i(t);break;case p.TIMEOUT:tf(ss,`RPC '${e}' ${s} timed out`),o(new t_(tb.DEADLINE_EXCEEDED,"Request time out"));break;case p.HTTP_ERROR:let r=a.getStatus();if(tf(ss,`RPC '${e}' ${s} failed with status:`,r,"response text:",a.getResponseText()),r>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);let t=null==e?void 0:e.error;if(t&&t.status&&t.message){let e,r=(e=t.status.toLowerCase().replace(/_/g,"-"),Object.values(tb).indexOf(e)>=0?e:tb.UNKNOWN);o(new t_(r,t.message))}else o(new t_(tb.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new t_(tb.UNAVAILABLE,"Connection failed."));break;default:ty(9055,{h_:e,streamId:s,P_:a.getLastErrorCode(),T_:a.getLastError()})}}finally{tf(ss,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(n);tf(ss,`RPC '${e}' ${s} sending request:`,n),a.send(t,"POST",l,r,15)})}I_(e,t,r){let n=se(),i=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=v(),o=y(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Ho(a.initMessageHeaders,t,r),a.encodeInitMessageHeaders=!0;let u=i.join("");tf(ss,`Creating RPC '${e}' stream ${n}: ${u}`,a);let c=s.createWebChannel(u,a);this.E_(c);let h=!1,f=!1,p=new si({Zo:t=>{f?tf(ss,`Not sending because RPC '${e}' stream ${n} is closed:`,t):(h||(tf(ss,`Opening RPC '${e}' stream ${n} transport.`),c.open(),h=!0),tf(ss,`RPC '${e}' stream ${n} sending:`,t),c.send(t))},Xo:()=>c.close()}),b=(e,t,r)=>{e.listen(t,e=>{try{r(e)}catch(e){setTimeout(()=>{throw e},0)}})};return b(c,d.EventType.OPEN,()=>{f||(tf(ss,`RPC '${e}' stream ${n} transport opened.`),p.__())}),b(c,d.EventType.CLOSE,()=>{f||(f=!0,tf(ss,`RPC '${e}' stream ${n} transport closed`),p.u_(),this.d_(c))}),b(c,d.EventType.ERROR,t=>{f||(f=!0,tg(ss,`RPC '${e}' stream ${n} transport errored. Name:`,t.name,"Message:",t.message),p.u_(new t_(tb.UNAVAILABLE,"The operation could not be completed")))}),b(c,d.EventType.MESSAGE,t=>{var r;if(!f){let i=t.data[0];tw(!!i,16349);let s=(null==i?void 0:i.error)||(null==(r=i[0])?void 0:r.error);if(s){tf(ss,`RPC '${e}' stream ${n} received error:`,s);let t=s.status,r=function(e){let t=w[e];if(void 0!==t)return nK(t)}(t),i=s.message;void 0===r&&(r=tb.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),f=!0,p.u_(new t_(r,i)),c.close()}else tf(ss,`RPC '${e}' stream ${n} received:`,i),p.c_(i)}}),b(o,m.STAT_EVENT,t=>{t.stat===g.PROXY?tf(ss,`RPC '${e}' stream ${n} detected buffering proxy`):t.stat===g.NOPROXY&&tf(ss,`RPC '${e}' stream ${n} detected no buffering proxy`)}),setTimeout(()=>{p.a_()},0),p}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function sa(){return"undefined"!=typeof document?document:null}function sl(e){return new it(e,!0)}class su{constructor(e,t,r=1e3,n=1.5,i=6e4){this.xi=e,this.timerId=t,this.A_=r,this.R_=n,this.V_=i,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();let t=Math.floor(this.m_+this.w_()),r=Math.max(0,Date.now()-this.g_),n=Math.max(0,t-r);n>0&&tf("ExponentialBackoff",`Backing off for ${n} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,n,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){null!==this.f_&&(this.f_.skipDelay(),this.f_=null)}cancel(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}let sc="PersistentStream";class sh{constructor(e,t,r,n,i,s,o,a){this.xi=e,this.S_=r,this.D_=n,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new su(e,t)}O_(){return 1===this.state||5===this.state||this.N_()}N_(){return 2===this.state||3===this.state}start(){this.M_=0,4!==this.state?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&null===this.C_&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,4!==e?this.x_.reset():t&&t.code===tb.RESOURCE_EXHAUSTED?(tp(t.toString()),tp("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===tb.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;let e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,r])=>{this.v_===t&&this.z_(e,r)},t=>{e(()=>{let e=new t_(tb.UNKNOWN,"Fetching auth token failed: "+t.message);return this.j_(e)})})}z_(e,t){let r=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(e=>{r(()=>this.j_(e))}),this.stream.onMessage(e=>{r(()=>1==++this.M_?this.J_(e):this.onNext(e))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return tf(sc,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(tf(sc,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class sd extends sh{constructor(e,t,r,n,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();let t=function(e,t){let r;if("targetChange"in t){var n,i;t.targetChange;let s="NO_CHANGE"===(n=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===n?1:"REMOVE"===n?2:"CURRENT"===n?3:"RESET"===n?4:ty(39313,{state:n}),o=t.targetChange.targetIds||[],a=(i=t.targetChange.resumeToken,e.useProto3Json?(tw(void 0===i||"string"==typeof i,58123),t7.fromBase64String(i||"")):(tw(void 0===i||i instanceof C.Buffer||i instanceof Uint8Array,16193),t7.fromUint8Array(i||new Uint8Array))),l=t.targetChange.cause;r=new n6(s,o,a,l&&new t_(void 0===l.code?tb.UNKNOWN:nK(l.code),l.message||"")||null)}else if("documentChange"in t){t.documentChange;let n=t.documentChange;n.document,n.document.name,n.document.updateTime;let i=ih(e,n.document.name),s=io(n.document.updateTime),o=n.document.createTime?io(n.document.createTime):tV.min(),a=new rP({mapValue:{fields:n.document.fields}}),l=rL.newFoundDocument(i,s,o,a);r=new n1(n.targetIds||[],n.removedTargetIds||[],l.key,l)}else if("documentDelete"in t){t.documentDelete;let n=t.documentDelete;n.document;let i=ih(e,n.document),s=n.readTime?io(n.readTime):tV.min(),o=rL.newNoDocument(i,s);r=new n1([],n.removedTargetIds||[],o.key,o)}else if("documentRemove"in t){t.documentRemove;let n=t.documentRemove;n.document;let i=ih(e,n.document);r=new n1([],n.removedTargetIds||[],i,null)}else{if(!("filter"in t))return ty(11601,{Vt:t});{t.filter;let e=t.filter;e.targetId;let{count:n=0,unchangedNames:i}=e,s=new nG(n,i);r=new n2(e.targetId,s)}}return r}(this.serializer,e),r=function(e){if(!("targetChange"in e))return tV.min();let t=e.targetChange;return t.targetIds&&t.targetIds.length?tV.min():t.readTime?io(t.readTime):tV.min()}(e);return this.listener.Y_(t,r)}Z_(e){let t,r={};r.database=ip(this.serializer),r.addTarget=function(e,t){var r,n;let i,s,o,a,l,u,c,h=t.target;if((i=r6(h)?{documents:{documents:[id(e,h.path)]}}:{query:(o={structuredQuery:{}},a=h.path,null!==h.collectionGroup?(s=a,o.structuredQuery.from=[{collectionId:h.collectionGroup,allDescendants:!0}]):(s=a.popLast(),o.structuredQuery.from=[{collectionId:a.lastSegment()}]),o.parent=id(e,s),(l=function(e){if(0!==e.length)return function e(t){var r;let n;return t instanceof rB?function(e){if("=="===e.op){if(rx(e.value))return{unaryFilter:{field:iy(e.field),op:"IS_NAN"}};if(rA(e.value))return{unaryFilter:{field:iy(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(rx(e.value))return{unaryFilter:{field:iy(e.field),op:"IS_NOT_NAN"}};if(rA(e.value))return{unaryFilter:{field:iy(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:iy(e.field),op:n9[e.op],value:e.value}}}(t):t instanceof r$?1===(n=(r=t).getFilters().map(t=>e(t))).length?n[0]:{compositeFilter:{op:ie[r.op],filters:n}}:ty(54877,{filter:t})}(r$.create(e,"and"))}(h.filters))&&(o.structuredQuery.where=l),(u=function(e){if(0!==e.length)return e.map(e=>({field:iy(e.field),direction:n7[e.dir]}))}(h.orderBy))&&(o.structuredQuery.orderBy=u),null!==(c=ir(e,h.limit))&&(o.structuredQuery.limit=c),h.startAt&&(o.structuredQuery.startAt={before:(r=h.startAt).inclusive,values:r.position}),h.endAt&&(o.structuredQuery.endAt={before:!(n=h.endAt).inclusive,values:n.position}),{gt:o,parent:s}).gt}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){i.resumeToken=is(e,t.resumeToken);let r=ir(e,t.expectedCount);null!==r&&(i.expectedCount=r)}else if(t.snapshotVersion.compareTo(tV.min())>0){i.readTime=ii(e,t.snapshotVersion.toTimestamp());let r=ir(e,t.expectedCount);null!==r&&(i.expectedCount=r)}return i}(this.serializer,e);let n=(this.serializer,null==(t=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ty(28987,{purpose:e})}}(e.purpose))?null:{"goog-listen-tags":t});n&&(r.labels=n),this.Q_(r)}X_(e){let t={};t.database=ip(this.serializer),t.removeTarget=e,this.Q_(t)}}class sf extends sh{constructor(e,t,r,n,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return tw(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,tw(!e.writeResults||0===e.writeResults.length,55816),this.listener.na()}onNext(e){var t,r;tw(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();let n=(t=e.writeResults,r=e.commitTime,t&&t.length>0?(tw(void 0!==r,14353),t.map(e=>{let t;return(t=e.updateTime?io(e.updateTime):io(r)).isEqual(tV.min())&&(t=io(r)),new nx(t,e.transformResults||[])})):[]),i=io(e.commitTime);return this.listener.ra(i,n)}ia(){let e={};e.database=ip(this.serializer),this.Q_(e)}ta(e){let t={streamToken:this.lastStreamToken,writes:e.map(e=>(function(e,t){var r,n;let i;if(t instanceof nM)i={update:im(e,t.key,t.value)};else if(t instanceof nB)i={delete:ic(e,t.key)};else if(t instanceof nU){let r;i={update:im(e,t.key,t.data),updateMask:(n=t.fieldMask,r=[],n.fields.forEach(e=>r.push(e.canonicalString())),{fieldPaths:r})}}else{if(!(t instanceof n$))return ty(16599,{ft:t.type});i={verify:ic(e,t.key)}}return t.fieldTransforms.length>0&&(i.updateTransforms=t.fieldTransforms.map(e=>(function(e,t){let r=t.transform;if(r instanceof nb)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(r instanceof n_)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:r.elements}};if(r instanceof nI)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:r.elements}};if(r instanceof nS)return{fieldPath:t.field.canonicalString(),increment:r.Re};throw ty(20930,{transform:t.transform})})(0,e))),t.precondition.isNone||(i.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:ii(e,r.updateTime.toTimestamp())}:void 0!==r.exists?{exists:r.exists}:ty(27497)),i})(this.serializer,e))};this.Q_(t)}}class sp{}class sg extends sp{constructor(e,t,r,n){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=n,this.sa=!1}oa(){if(this.sa)throw new t_(tb.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,r,n){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.zo(e,il(t,r),n,i,s)).catch(e=>{throw"FirebaseError"===e.name?(e.code===tb.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new t_(tb.UNKNOWN,e.toString())})}Yo(e,t,r,n,i){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Yo(e,il(t,r),n,s,o,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===tb.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new t_(tb.UNKNOWN,e.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class sm{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){0===this._a&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){"Online"===this.state?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,"Online"===e&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(tp(t),this.ua=!1):tf("OnlineStateTracker",t)}Ta(){null!==this.aa&&(this.aa.cancel(),this.aa=null)}}let sy="RemoteStore";class sv{constructor(e,t,r,n,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=i,this.Ra.No(e=>{r.enqueueAndForget(async()=>{sk(this)&&(tf(sy,"Restarting streams for network reachability change."),await async function(e){e.da.add(4),await sb(e),e.Va.set("Unknown"),e.da.delete(4),await sw(e)}(this))})}),this.Va=new sm(r,n)}}async function sw(e){if(sk(e))for(let t of e.Aa)await t(!0)}async function sb(e){for(let t of e.Aa)await t(!1)}function s_(e,t){e.Ea.has(t.targetId)||(e.Ea.set(t.targetId,t),sC(e)?sS(e):sz(e).N_()&&sI(e,t))}function sE(e,t){let r=sz(e);e.Ea.delete(t),r.N_()&&sT(e,t),0===e.Ea.size&&(r.N_()?r.k_():sk(e)&&e.Va.set("Unknown"))}function sI(e,t){if(e.ma.Ke(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(tV.min())>0){let r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}sz(e).Z_(t)}function sT(e,t){e.ma.Ke(t),sz(e).X_(t)}function sS(e){e.ma=new n5({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Rt:t=>e.Ea.get(t)||null,Pt:()=>e.datastore.serializer.databaseId}),sz(e).start(),e.Va.ca()}function sC(e){return sk(e)&&!sz(e).O_()&&e.Ea.size>0}function sk(e){return 0===e.da.size}async function sA(e){e.Va.set("Online")}async function sx(e){e.Ea.forEach((t,r)=>{sI(e,t)})}async function sR(e,t){e.ma=void 0,sC(e)?(e.Va.Pa(t),sS(e)):e.Va.set("Unknown")}async function sN(e,t,r){if(e.Va.set("Online"),t instanceof n6&&2===t.state&&t.cause)try{await async function(e,t){let r=t.cause;for(let n of t.targetIds)e.Ea.has(n)&&(await e.remoteSyncer.rejectListen(n,r),e.Ea.delete(n),e.ma.removeTarget(n))}(e,t)}catch(r){tf(sy,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await sO(e,r)}else if(t instanceof n1?e.ma.Xe(t):t instanceof n2?e.ma.ot(t):e.ma.nt(t),!r.isEqual(tV.min()))try{let t,n=await i1(e.localStore);r.compareTo(n)>=0&&await ((t=e.ma.It(r)).targetChanges.forEach((t,n)=>{if(t.resumeToken.approximateByteSize()>0){let i=e.Ea.get(n);i&&e.Ea.set(n,i.withResumeToken(t.resumeToken,r))}}),t.targetMismatches.forEach((t,r)=>{let n=e.Ea.get(t);if(!n)return;e.Ea.set(t,n.withResumeToken(t7.EMPTY_BYTE_STRING,n.snapshotVersion)),sT(e,t);let i=new ib(n.target,t,r,n.sequenceNumber);sI(e,i)}),e.remoteSyncer.applyRemoteEvent(t))}catch(t){tf(sy,"Failed to raise snapshot:",t),await sO(e,t)}}async function sO(e,t,r){if(!tQ(t))throw t;e.da.add(1),await sb(e),e.Va.set("Offline"),r||(r=()=>i1(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{tf(sy,"Retrying IndexedDB access"),await r(),e.da.delete(1),await sw(e)})}function sD(e,t){return t().catch(r=>sO(e,r,t))}async function sP(e){var t;let r=sq(e),n=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:-1;for(;sk(t=e)&&t.Ia.length<10;)try{let t=await function(e,t){return e.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}(e.localStore,n);if(null===t){0===e.Ia.length&&r.k_();break}n=t.batchId,function(e,t){e.Ia.push(t);let r=sq(e);r.N_()&&r.ea&&r.ta(t.mutations)}(e,t)}catch(t){await sO(e,t)}sL(e)&&sM(e)}function sL(e){return sk(e)&&!sq(e).O_()&&e.Ia.length>0}function sM(e){sq(e).start()}async function sU(e){sq(e).ia()}async function sV(e){let t=sq(e);for(let r of e.Ia)t.ta(r.mutations)}async function sF(e,t,r){let n=e.Ia.shift(),i=nq.from(n,t,r);await sD(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await sP(e)}async function sj(e,t){t&&sq(e).ea&&await async function(e,t){var r;if(function(e){switch(e){case tb.OK:return ty(64938);case tb.CANCELLED:case tb.UNKNOWN:case tb.DEADLINE_EXCEEDED:case tb.RESOURCE_EXHAUSTED:case tb.INTERNAL:case tb.UNAVAILABLE:case tb.UNAUTHENTICATED:return!1;case tb.INVALID_ARGUMENT:case tb.NOT_FOUND:case tb.ALREADY_EXISTS:case tb.PERMISSION_DENIED:case tb.FAILED_PRECONDITION:case tb.ABORTED:case tb.OUT_OF_RANGE:case tb.UNIMPLEMENTED:case tb.DATA_LOSS:return!0;default:return ty(15467,{code:e})}}(r=t.code)&&r!==tb.ABORTED){let r=e.Ia.shift();sq(e).L_(),await sD(e,()=>e.remoteSyncer.rejectFailedWrite(r.batchId,t)),await sP(e)}}(e,t),sL(e)&&sM(e)}async function sB(e,t){e.asyncQueue.verifyOperationInProgress(),tf(sy,"RemoteStore received new credentials");let r=sk(e);e.da.add(3),await sb(e),r&&e.Va.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.da.delete(3),await sw(e)}async function s$(e,t){t?(e.da.delete(2),await sw(e)):t||(e.da.add(2),await sb(e),e.Va.set("Unknown"))}function sz(e){var t,r,n;return e.fa||(t=e.datastore,r=e.asyncQueue,n={e_:sA.bind(null,e),n_:sx.bind(null,e),i_:sR.bind(null,e),Y_:sN.bind(null,e)},t.oa(),e.fa=new sd(r,t.connection,t.authCredentials,t.appCheckCredentials,t.serializer,n),e.Aa.push(async t=>{t?(e.fa.L_(),sC(e)?sS(e):e.Va.set("Unknown")):(await e.fa.stop(),e.ma=void 0)})),e.fa}function sq(e){var t,r,n;return e.ga||(t=e.datastore,r=e.asyncQueue,n={e_:()=>Promise.resolve(),n_:sU.bind(null,e),i_:sj.bind(null,e),na:sV.bind(null,e),ra:sF.bind(null,e)},t.oa(),e.ga=new sf(r,t.connection,t.authCredentials,t.appCheckCredentials,t.serializer,n),e.Aa.push(async t=>{t?(e.ga.L_(),await sP(e)):(await e.ga.stop(),e.Ia.length>0&&(tf(sy,`Stopping write stream with ${e.Ia.length} pending writes`),e.Ia=[]))})),e.ga}class sH{constructor(e,t,r,n,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=n,this.removalCallback=i,this.deferred=new tE,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,n,i){let s=new sH(e,t,Date.now()+r,n,i);return s.start(r),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new t_(tb.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sG(e,t){if(tp("AsyncQueue",`${t}: ${e}`),tQ(e))return new t_(tb.UNAVAILABLE,`${t}: ${e}`);throw e}class sK{static emptySet(e){return new sK(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||tq.comparator(t.key,r.key):(e,t)=>tq.comparator(e.key,t.key),this.keyedMap=nu(),this.sortedSet=new t1(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof sK)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let e=t.getNext().key,n=r.getNext().key;if(!e.isEqual(n))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){let r=new sK;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class sW{constructor(){this.pa=new t1(tq.comparator)}track(e){let t=e.doc.key,r=this.pa.get(t);r?0!==e.type&&3===r.type?this.pa=this.pa.insert(t,e):3===e.type&&1!==r.type?this.pa=this.pa.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.pa=this.pa.remove(t):1===e.type&&2===r.type?this.pa=this.pa.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):ty(63341,{Vt:e,ya:r}):this.pa=this.pa.insert(t,e)}wa(){let e=[];return this.pa.inorderTraversal((t,r)=>{e.push(r)}),e}}class sQ{constructor(e,t,r,n,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=n,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,n,i){let s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new sQ(e,t,sK.emptySet(t),s,r,n,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&nt(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==r[e].type||!t[e].doc.isEqual(r[e].doc))return!1;return!0}}class sY{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class sX{constructor(){this.queries=sJ(),this.onlineState="Unknown",this.Ca=new Set}terminate(){var e;let t;e=new t_(tb.ABORTED,"Firestore shutting down"),t=this.queries,this.queries=sJ(),t.forEach((t,r)=>{for(let t of r.Sa)t.onError(e)})}}function sJ(){return new no(e=>nr(e),nt)}async function sZ(e,t){let r=3,n=t.query,i=e.queries.get(n);i?!i.Da()&&t.va()&&(r=2):(i=new sY,r=+!t.va());try{switch(r){case 0:i.ba=await e.onListen(n,!0);break;case 1:i.ba=await e.onListen(n,!1);break;case 2:await e.onFirstRemoteStoreListen(n)}}catch(r){let e=sG(r,`Initialization of query '${nn(t.query)}' failed`);return void t.onError(e)}e.queries.set(n,i),i.Sa.push(t),t.Fa(e.onlineState),i.ba&&t.Ma(i.ba)&&s6(e)}async function s0(e,t){let r=t.query,n=3,i=e.queries.get(r);if(i){let e=i.Sa.indexOf(t);e>=0&&(i.Sa.splice(e,1),0===i.Sa.length?n=+!t.va():!i.Da()&&t.va()&&(n=2))}switch(n){case 0:return e.queries.delete(r),e.onUnlisten(r,!0);case 1:return e.queries.delete(r),e.onUnlisten(r,!1);case 2:return e.onLastRemoteStoreUnlisten(r);default:return}}function s1(e,t){let r=!1;for(let n of t){let t=n.query,i=e.queries.get(t);if(i){for(let e of i.Sa)e.Ma(n)&&(r=!0);i.ba=n}}r&&s6(e)}function s2(e,t,r){let n=e.queries.get(t);if(n)for(let e of n.Sa)e.onError(r);e.queries.delete(t)}function s6(e){e.Ca.forEach(e=>{e.next()})}(E=_||(_={})).xa="default",E.Cache="cache";class s3{constructor(e,t,r){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=r||{}}Ma(e){if(!this.options.includeMetadataChanges){let t=[];for(let r of e.docChanges)3!==r.type&&t.push(r);e=new sQ(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){return!(e.fromCache&&this.va())||(!this.options.Qa||"Offline"===t)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}La(e){if(e.docChanges.length>0)return!0;let t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}qa(e){e=sQ.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==_.Cache}}class s5{constructor(e){this.key=e}}class s4{constructor(e){this.key=e}}class s8{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=np(),this.mutatedKeys=np(),this.Za=ns(e),this.Xa=new sK(this.Za)}get eu(){return this.Ha}tu(e,t){let r=t?t.nu:new sW,n=t?t.Xa:this.Xa,i=t?t.mutatedKeys:this.mutatedKeys,s=n,o=!1,a="F"===this.query.limitType&&n.size===this.query.limit?n.last():null,l="L"===this.query.limitType&&n.size===this.query.limit?n.first():null;if(e.inorderTraversal((e,t)=>{let u=n.get(e),c=ni(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations),f=!1;u&&c?u.data.isEqual(c.data)?h!==d&&(r.track({type:3,doc:c}),f=!0):this.ru(u,c)||(r.track({type:2,doc:c}),f=!0,(a&&this.Za(c,a)>0||l&&0>this.Za(c,l))&&(o=!0)):!u&&c?(r.track({type:0,doc:c}),f=!0):u&&!c&&(r.track({type:1,doc:u}),f=!0,(a||l)&&(o=!0)),f&&(c?(s=s.add(c),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){let e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),r.track({type:1,doc:e})}return{Xa:s,nu:r,Cs:o,mutatedKeys:i}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,n){let i=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;let s=e.nu.wa();s.sort((e,t)=>{var r,n;let i;return r=e.type,n=t.type,(i=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ty(20277,{Vt:e})}})(r)-i(n)||this.Za(e.doc,t.doc)}),this.iu(r),n=null!=n&&n;let o=t&&!n?this.su():[],a=0===this.Ya.size&&this.current&&!n?1:0,l=a!==this.Ja;return(this.Ja=a,0!==s.length||l)?{snapshot:new sQ(this.query,e.Xa,i,s,e.mutatedKeys,0===a,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),ou:o}:{ou:o}}Fa(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new sW,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(e=>this.Ha=this.Ha.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ha=this.Ha.delete(e)),this.current=e.current)}su(){if(!this.current)return[];let e=this.Ya;this.Ya=np(),this.Xa.forEach(e=>{this._u(e.key)&&(this.Ya=this.Ya.add(e.key))});let t=[];return e.forEach(e=>{this.Ya.has(e)||t.push(new s4(e))}),this.Ya.forEach(r=>{e.has(r)||t.push(new s5(r))}),t}au(e){this.Ha=e.$s,this.Ya=np();let t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return sQ.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,0===this.Ja,this.hasCachedResults)}}let s7="SyncEngine";class s9{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class oe{constructor(e){this.key=e,this.cu=!1}}class ot{constructor(e,t,r,n,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=n,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.lu={},this.hu=new no(e=>nr(e),nt),this.Pu=new Map,this.Tu=new Set,this.Iu=new t1(tq.comparator),this.Eu=new Map,this.du=new iF,this.Au={},this.Ru=new Map,this.Vu=ik.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return!0===this.mu}}async function or(e,t,r=!0){let n,i=oI(e),s=i.hu.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),n=s.view.uu()):n=await oi(i,t,r,!0),n}async function on(e,t){let r=oI(e);await oi(r,t,!0,!1)}async function oi(e,t,r,n){var i,s;let o,a=await (i=e.localStore,s=r7(t),i.persistence.runTransaction("Allocate target","readwrite",e=>{let t;return i.Ti.getTargetData(e,s).next(r=>r?(t=r,tW.resolve(t)):i.Ti.allocateTargetId(e).next(r=>(t=new ib(s,r,"TargetPurposeListen",e.currentSequenceNumber),i.Ti.addTargetData(e,t).next(()=>t))))}).then(e=>{let t=i.xs.get(e.targetId);return(null===t||e.snapshotVersion.compareTo(t.snapshotVersion)>0)&&(i.xs=i.xs.insert(e.targetId,e),i.Os.set(s,e.targetId)),e})),l=a.targetId,u=e.sharedClientState.addLocalQueryTarget(l,r);return n&&(o=await os(e,t,l,"current"===u,a.resumeToken)),e.isPrimaryClient&&r&&s_(e.remoteStore,a),o}async function os(e,t,r,n,i){e.fu=(t,r,n)=>(async function(e,t,r,n){let i=t.view.tu(r);i.Cs&&(i=await i6(e.localStore,t.query,!1).then(({documents:e})=>t.view.tu(e,i)));let s=n&&n.targetChanges.get(t.targetId),o=n&&null!=n.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return ov(e,t.targetId,a.ou),a.snapshot})(e,t,r,n);let s=await i6(e.localStore,t,!0),o=new s8(t,s.$s),a=o.tu(s.documents),l=n0.createSynthesizedTargetChangeForCurrentChange(r,n&&"Offline"!==e.onlineState,i),u=o.applyChanges(a,e.isPrimaryClient,l);ov(e,r,u.ou);let c=new s9(t,r,o);return e.hu.set(t,c),e.Pu.has(r)?e.Pu.get(r).push(t):e.Pu.set(r,[t]),u.snapshot}async function oo(e,t,r){let n=e.hu.get(t),i=e.Pu.get(n.targetId);i.length>1?(e.Pu.set(n.targetId,i.filter(e=>!nt(e,t))),e.hu.delete(t)):e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(n.targetId),e.sharedClientState.isActiveQueryTarget(n.targetId)||await i2(e.localStore,n.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(n.targetId),r&&sE(e.remoteStore,n.targetId),om(e,n.targetId)}).catch(tK)):(om(e,n.targetId),await i2(e.localStore,n.targetId,!0))}async function oa(e,t){let r=e.hu.get(t),n=e.Pu.get(r.targetId);e.isPrimaryClient&&1===n.length&&(e.sharedClientState.removeLocalQueryTarget(r.targetId),sE(e.remoteStore,r.targetId))}async function ol(e,t,r){var n,i,s;let o=((n=e).remoteStore.remoteSyncer.applySuccessfulWrite=od.bind(null,n),n.remoteStore.remoteSyncer.rejectFailedWrite=of.bind(null,n),n);try{let e,n,a,l,u,c=await (i=o.localStore,a=tU.now(),l=t.reduce((e,t)=>e.add(t.key),np()),i.persistence.runTransaction("Locally write mutations","readwrite",r=>{let s=na,o=np();return i.Bs.getEntries(r,l).next(e=>{(s=e).forEach((e,t)=>{t.isValidDocument()||(o=o.add(e))})}).next(()=>i.localDocuments.getOverlayedDocuments(r,s)).next(n=>{e=n;let s=[];for(let r of t){let t=function(e,t){let r=null;for(let n of e.fieldTransforms){let e=t.data.field(n.field),i=nw(n.transform,e||null);null!=i&&(null===r&&(r=rP.empty()),r.set(n.field,i))}return r||null}(r,e.get(r.key).overlayedDocument);null!=t&&s.push(new nU(r.key,t,function e(t){let r=[];return tZ(t.fields,(t,n)=>{let i=new tz([t]);if(rR(n)){let t=e(n.mapValue).fields;if(0===t.length)r.push(i);else for(let e of t)r.push(i.child(e))}else r.push(i)}),new t4(r)}(t.value.mapValue),nR.exists(!0)))}return i.mutationQueue.addMutationBatch(r,a,s,t)}).next(t=>{n=t;let s=t.applyToLocalDocumentSet(e,o);return i.documentOverlayCache.saveOverlays(r,t.batchId,s)})}).then(()=>({batchId:n.batchId,changes:nc(e)})));o.sharedClientState.addPendingMutation(c.batchId),s=c.batchId,(u=o.Au[o.currentUser.toKey()])||(u=new t1(tD)),u=u.insert(s,r),o.Au[o.currentUser.toKey()]=u,await ob(o,c.changes),await sP(o.remoteStore)}catch(t){let e=sG(t,"Failed to persist write");r.reject(e)}}async function ou(e,t){var r;try{let n,i,s=await (r=e.localStore,n=t.snapshotVersion,i=r.xs,r.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{var s,o,a;let l,u,c=r.Bs.newChangeBuffer({trackRemovals:!0});i=r.xs;let h=[];t.targetChanges.forEach((s,o)=>{var a;let l=i.get(o);if(!l)return;h.push(r.Ti.removeMatchingKeys(e,s.removedDocuments,o).next(()=>r.Ti.addMatchingKeys(e,s.addedDocuments,o)));let u=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?u=u.withResumeToken(t7.EMPTY_BYTE_STRING,tV.min()).withLastLimboFreeSnapshotVersion(tV.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,n)),i=i.insert(o,u),a=u,(0===l.resumeToken.approximateByteSize()||a.snapshotVersion.toMicroseconds()-l.snapshotVersion.toMicroseconds()>=3e8||s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size>0)&&h.push(r.Ti.updateTargetData(e,u))});let d=na,f=np();if(t.documentUpdates.forEach(n=>{t.resolvedLimboDocuments.has(n)&&h.push(r.persistence.referenceDelegate.updateLimboDocument(e,n))}),h.push((s=e,o=c,a=t.documentUpdates,l=np(),u=np(),a.forEach(e=>l=l.add(e)),o.getEntries(s,l).next(e=>{let t=na;return a.forEach((r,n)=>{let i=e.get(r);n.isFoundDocument()!==i.isFoundDocument()&&(u=u.add(r)),n.isNoDocument()&&n.version.isEqual(tV.min())?(o.removeEntry(r,n.readTime),t=t.insert(r,n)):!i.isValidDocument()||n.version.compareTo(i.version)>0||0===n.version.compareTo(i.version)&&i.hasPendingWrites?(o.addEntry(n),t=t.insert(r,n)):tf(iJ,"Ignoring outdated watch update for ",r,". Current version:",i.version," Watch version:",n.version)}),{qs:t,Qs:u}})).next(e=>{d=e.qs,f=e.Qs})),!n.isEqual(tV.min())){let t=r.Ti.getLastRemoteSnapshotVersion(e).next(t=>r.Ti.setTargetsMetadata(e,e.currentSequenceNumber,n));h.push(t)}return tW.waitFor(h).next(()=>c.apply(e)).next(()=>r.localDocuments.getLocalViewOfDocuments(e,d,f)).next(()=>d)}).then(e=>(r.xs=i,e)));t.targetChanges.forEach((t,r)=>{let n=e.Eu.get(r);n&&(tw(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,22616),t.addedDocuments.size>0?n.cu=!0:t.modifiedDocuments.size>0?tw(n.cu,14607):t.removedDocuments.size>0&&(tw(n.cu,42227),n.cu=!1))}),await ob(e,s,t)}catch(e){await tK(e)}}function oc(e,t,r){var n;if(e.isPrimaryClient&&0===r||!e.isPrimaryClient&&1===r){let r,i=[];e.hu.forEach((e,r)=>{let n=r.view.Fa(t);n.snapshot&&i.push(n.snapshot)}),(n=e.eventManager).onlineState=t,r=!1,n.queries.forEach((e,n)=>{for(let e of n.Sa)e.Fa(t)&&(r=!0)}),r&&s6(n),i.length&&e.lu.Y_(i),e.onlineState=t,e.isPrimaryClient&&e.sharedClientState.setOnlineState(t)}}async function oh(e,t,r){e.sharedClientState.updateQueryState(t,"rejected",r);let n=e.Eu.get(t),i=n&&n.key;if(i){let r=new t1(tq.comparator);r=r.insert(i,rL.newNoDocument(i,tV.min()));let n=np().add(i),s=new nZ(tV.min(),new Map,new t1(tD),r,n);await ou(e,s),e.Iu=e.Iu.remove(i),e.Eu.delete(t),ow(e)}else await i2(e.localStore,t,!1).then(()=>om(e,t,r)).catch(tK)}async function od(e,t){var r;let n=t.batch.batchId;try{let i=await (r=e.localStore,r.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{let n,i,s,o=t.batch.keys(),a=r.Bs.newChangeBuffer({trackRemovals:!0});return(i=(n=t.batch).keys(),s=tW.resolve(),i.forEach(r=>{s=s.next(()=>a.getEntry(e,r)).next(e=>{let i=t.docVersions.get(r);tw(null!==i,48541),0>e.version.compareTo(i)&&(n.applyToRemoteDocument(e,t),e.isValidDocument()&&(e.setReadTime(t.commitVersion),a.addEntry(e)))})}),s.next(()=>r.mutationQueue.removeMutationBatch(e,n))).next(()=>a.apply(e)).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,o,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=np();for(let r=0;r<e.mutationResults.length;++r)e.mutationResults[r].transformResults.length>0&&(t=t.add(e.batch.mutations[r].key));return t}(t))).next(()=>r.localDocuments.getDocuments(e,o))}));og(e,n,null),op(e,n),e.sharedClientState.updateMutationState(n,"acknowledged"),await ob(e,i)}catch(e){await tK(e)}}async function of(e,t,r){var n;try{let i=await (n=e.localStore,n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(tw(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))}));og(e,t,r),op(e,t),e.sharedClientState.updateMutationState(t,"rejected",r),await ob(e,i)}catch(e){await tK(e)}}function op(e,t){(e.Ru.get(t)||[]).forEach(e=>{e.resolve()}),e.Ru.delete(t)}function og(e,t,r){let n=e.Au[e.currentUser.toKey()];if(n){let i=n.get(t);i&&(r?i.reject(r):i.resolve(),n=n.remove(t)),e.Au[e.currentUser.toKey()]=n}}function om(e,t,r=null){for(let n of(e.sharedClientState.removeLocalQueryTarget(t),e.Pu.get(t)))e.hu.delete(n),r&&e.lu.gu(n,r);e.Pu.delete(t),e.isPrimaryClient&&e.du.Hr(t).forEach(t=>{e.du.containsKey(t)||oy(e,t)})}function oy(e,t){e.Tu.delete(t.path.canonicalString());let r=e.Iu.get(t);null!==r&&(sE(e.remoteStore,r),e.Iu=e.Iu.remove(t),e.Eu.delete(r),ow(e))}function ov(e,t,r){for(let n of r)n instanceof s5?(e.du.addReference(n.key,t),function(e,t){let r=t.key,n=r.path.canonicalString();e.Iu.get(r)||e.Tu.has(n)||(tf(s7,"New document in limbo: "+r),e.Tu.add(n),ow(e))}(e,n)):n instanceof s4?(tf(s7,"Document no longer in limbo: "+n.key),e.du.removeReference(n.key,t),e.du.containsKey(n.key)||oy(e,n.key)):ty(19791,{pu:n})}function ow(e){for(;e.Tu.size>0&&e.Iu.size<e.maxConcurrentLimboResolutions;){let t=e.Tu.values().next().value;e.Tu.delete(t);let r=new tq(tB.fromString(t)),n=e.Vu.next();e.Eu.set(n,new oe(r)),e.Iu=e.Iu.insert(r,n),s_(e.remoteStore,new ib(r7(new r3(r.path)),n,"TargetPurposeLimboResolution",tY.le))}}async function ob(e,t,r){let n=[],i=[],s=[];e.hu.isEmpty()||(e.hu.forEach((o,a)=>{s.push(e.fu(a,t,r).then(t=>{var s;if((t||r)&&e.isPrimaryClient){let n=t?!t.fromCache:null==(s=null==r?void 0:r.targetChanges.get(a.targetId))?void 0:s.current;e.sharedClientState.updateQueryState(a.targetId,n?"current":"not-current")}if(t){n.push(t);let e=iQ.Rs(a.targetId,t);i.push(e)}}))}),await Promise.all(s),e.lu.Y_(n),await async function(e,t){try{await e.persistence.runTransaction("notifyLocalViewChanges","readwrite",r=>tW.forEach(t,t=>tW.forEach(t.ds,n=>e.persistence.referenceDelegate.addReference(r,t.targetId,n)).next(()=>tW.forEach(t.As,n=>e.persistence.referenceDelegate.removeReference(r,t.targetId,n)))))}catch(e){if(!tQ(e))throw e;tf(iJ,"Failed to update sequence numbers: "+e)}for(let r of t){let t=r.targetId;if(!r.fromCache){let r=e.xs.get(t),n=r.snapshotVersion,i=r.withLastLimboFreeSnapshotVersion(n);e.xs=e.xs.insert(t,i)}}}(e.localStore,i))}async function o_(e,t){if(!e.currentUser.isEqual(t)){tf(s7,"User change. New user:",t.toKey());let r=await i0(e.localStore,t);e.currentUser=t,e.Ru.forEach(e=>{e.forEach(e=>{e.reject(new t_(tb.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Ru.clear(),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await ob(e,r.ks)}}function oE(e,t){let r=e.Eu.get(t);if(r&&r.cu)return np().add(r.key);{let r=np(),n=e.Pu.get(t);if(!n)return r;for(let t of n){let n=e.hu.get(t);r=r.unionWith(n.view.eu)}return r}}function oI(e){return e.remoteStore.remoteSyncer.applyRemoteEvent=ou.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=oE.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=oh.bind(null,e),e.lu.Y_=s1.bind(null,e.eventManager),e.lu.gu=s2.bind(null,e.eventManager),e}class oT{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=sl(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){var t,r;return t=this.persistence,r=new iX,new iZ(t,r,e.initialUser,this.serializer)}Su(e){return new iH(iK.fi,this.serializer)}bu(e){return new i5}async terminate(){var e,t;null==(e=this.gcScheduler)||e.stop(),null==(t=this.indexBackfillerScheduler)||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}oT.provider={build:()=>new oT};class oS extends oT{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){return tw(this.persistence.referenceDelegate instanceof iW,46915),new iN(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Su(e){let t=void 0!==this.cacheSizeBytes?iC.withCacheSize(this.cacheSizeBytes):iC.DEFAULT;return new iH(e=>iW.fi(e,t),this.serializer)}}class oC{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>oc(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=o_.bind(null,this.syncEngine),await s$(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new sX}createDatastore(e){var t;let r=sl(e.databaseInfo.databaseId),n=new so(e.databaseInfo);return t=e.authCredentials,new sg(t,e.appCheckCredentials,n,r)}createRemoteStore(e){var t,r;return t=this.localStore,r=this.datastore,new sv(t,r,e.asyncQueue,e=>oc(this.syncEngine,e,0),i7.C()?new i7:new i4)}createSyncEngine(e,t){var r,n,i,s,o,a;let l;return r=this.localStore,n=this.remoteStore,i=this.eventManager,s=this.sharedClientState,o=e.initialUser,a=e.maxConcurrentLimboResolutions,l=new ot(r,n,i,s,o,a),t&&(l.mu=!0),l}async terminate(){var e,t;await async function(e){tf(sy,"RemoteStore shutting down."),e.da.add(5),await sb(e),e.Ra.shutdown(),e.Va.set("Unknown")}(this.remoteStore),null==(e=this.datastore)||e.terminate(),null==(t=this.eventManager)||t.terminate()}}oC.provider={build:()=>new oC};class ok{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):tp("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}let oA="FirestoreClient";class ox{constructor(e,t,r,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=n,this.user=tu.UNAUTHENTICATED,this.clientId=tO.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async e=>{tf(oA,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(r,e=>(tf(oA,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new tE;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){let t=sG(r,"Failed to shutdown persistence");e.reject(t)}}),e.promise}}async function oR(e,t){e.asyncQueue.verifyOperationInProgress(),tf(oA,"Initializing OfflineComponentProvider");let r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async e=>{n.isEqual(e)||(await i0(t.localStore,e),n=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function oN(e,t){e.asyncQueue.verifyOperationInProgress();let r=await oO(e);tf(oA,"Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(e=>sB(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,r)=>sB(t.remoteStore,r)),e._onlineComponents=t}async function oO(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){tf(oA,"Using user provided OfflineComponentProvider");try{await oR(e,e._uninitializedComponentsProvider._offline)}catch(t){if(!("FirebaseError"===t.name?t.code===tb.FAILED_PRECONDITION||t.code===tb.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw t;tg("Error using user provided cache. Falling back to memory cache: "+t),await oR(e,new oT)}}else tf(oA,"Using default OfflineComponentProvider"),await oR(e,new oS(void 0));return e._offlineComponents}async function oD(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(tf(oA,"Using user provided OnlineComponentProvider"),await oN(e,e._uninitializedComponentsProvider._online)):(tf(oA,"Using default OnlineComponentProvider"),await oN(e,new oC))),e._onlineComponents}async function oP(e){let t=await oD(e),r=t.eventManager;return r.onListen=or.bind(null,t.syncEngine),r.onUnlisten=oo.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=on.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=oa.bind(null,t.syncEngine),r}function oL(e){let t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}let oM=new Map;function oU(e,t,r){if(!r)throw new t_(tb.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function oV(e){if(!tq.isDocumentKey(e))throw new t_(tb.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function oF(e){if(tq.isDocumentKey(e))throw new t_(tb.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function oj(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{var t;let r=(t=e).constructor?t.constructor.name:null;return r?`a custom ${r} object`:"an object"}}return"function"==typeof e?"a function":ty(12329,{type:typeof e})}function oB(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new t_(tb.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let r=oj(e);throw new t_(tb.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}let o$="firestore.googleapis.com";class oz{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new t_(tb.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=o$,this.ssl=!0}else this.host=e.host,this.ssl=null==(t=e.ssl)||t;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=0x2800000;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new t_(tb.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,r,n){if(!0===t&&!0===n)throw new t_(tb.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=oL(null!=(r=e.experimentalLongPollingOptions)?r:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new t_(tb.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new t_(tb.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new t_(tb.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){var t,r;return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,t.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class oq{constructor(e,t,r,n){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new oz({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new t_(tb.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new t_(tb.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new oz(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new tT;switch(e.type){case"firstParty":return new tA(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new t_(tb.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){let e;return(e=oM.get(this))&&(tf("ComponentProvider","Removing Datastore"),oM.delete(this),e.terminate()),Promise.resolve()}}class oH{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new oH(this.firestore,e,this._query)}}class oG{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new oK(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new oG(this.firestore,e,this._key)}}class oK extends oH{constructor(e,t,r){super(e,t,new r3(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new oG(this.firestore,null,new tq(e))}withConverter(e){return new oK(this.firestore,e,this._path)}}function oW(e,t,...r){if(e=ei(e),oU("collection","path",t),e instanceof oq){let n=tB.fromString(t,...r);return oF(n),new oK(e,null,n)}{if(!(e instanceof oG||e instanceof oK))throw new t_(tb.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=e._path.child(tB.fromString(t,...r));return oF(n),new oK(e.firestore,null,n)}}function oQ(e,t,...r){if(e=ei(e),1==arguments.length&&(t=tO.newId()),oU("doc","path",t),e instanceof oq){let n=tB.fromString(t,...r);return oV(n),new oG(e,null,new tq(n))}{if(!(e instanceof oG||e instanceof oK))throw new t_(tb.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=e._path.child(tB.fromString(t,...r));return oV(n),new oG(e.firestore,e instanceof oK?e.converter:null,new tq(n))}}let oY="AsyncQueue";class oX{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new su(this,"async_queue_retry"),this.rc=()=>{let e=sa();e&&tf(oY,"Visibility state changed to "+e.visibilityState),this.x_.b_()},this.sc=e;const t=sa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;let t=sa();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});let t=new tE;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(0!==this.Ju.length){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!tQ(e))throw e;tf(oY,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){let t=this.sc.then(()=>(this.ec=!0,e().catch(e=>{throw this.Xu=e,this.ec=!1,tp("INTERNAL UNHANDLED ERROR: ",oJ(e)),e}).then(e=>(this.ec=!1,e))));return this.sc=t,t}enqueueAfterDelay(e,t,r){this.oc(),this.nc.indexOf(e)>-1&&(t=0);let n=sH.createAndSchedule(this,e,t,r,e=>this.uc(e));return this.Zu.push(n),n}oc(){this.Xu&&ty(47125,{cc:oJ(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(let t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{for(let t of(this.Zu.sort((e,t)=>e.targetTimeMs-t.targetTimeMs),this.Zu))if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){let t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function oJ(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function oZ(e){if("object"!=typeof e||null===e)return!1;for(let t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}class o0 extends oq{constructor(e,t,r,n){super(e,t,r,n),this.type="firestore",this._queue=new oX,this._persistenceKey=(null==n?void 0:n.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new oX(e),this._firestoreClient=void 0,await e}}}function o1(e,t){let r=eF("object"==typeof e?e:eX(),"firestore").getImmediate({identifier:"string"==typeof e?e:t||rh});if(!r._initialized){let e=M("firestore");e&&function(e,t,r,n={}){var i;e=oB(e,oq);let s=j(t),o=e._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),l=`${t}:${r}`;s&&(B(`https://${l}`),H("Firestore",!0)),o.host!==o$&&o.host!==l&&tg("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let u=Object.assign(Object.assign({},o),{host:l,ssl:s,emulatorOptions:n});if(!X(u,a)&&(e._setSettings(u),n.mockUserToken)){let t,r;if("string"==typeof n.mockUserToken)t=n.mockUserToken,r=tu.MOCK_USER;else{t=$(n.mockUserToken,null==(i=e._app)?void 0:i.options.projectId);let s=n.mockUserToken.sub||n.mockUserToken.user_id;if(!s)throw new t_(tb.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");r=new tu(s)}e._authCredentials=new tS(new tI(t,r))}}(r,...e)}return r}function o2(e){if(e._terminated)throw new t_(tb.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||function(e){var t,r,n,i,s,o;let a,l=e._freezeSettings(),u=(i=e._databaseId,s=(null==(t=e._app)?void 0:t.options.appId)||"",new rc(i,s,e._persistenceKey,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,oL(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator));e._componentsProvider||(null==(r=l.localCache)?void 0:r._offlineComponentProvider)&&(null==(n=l.localCache)?void 0:n._onlineComponentProvider)&&(e._componentsProvider={_offline:l.localCache._offlineComponentProvider,_online:l.localCache._onlineComponentProvider}),e._firestoreClient=new ox(e._authCredentials,e._appCheckCredentials,e._queue,u,e._componentsProvider&&(a=null==(o=e._componentsProvider)?void 0:o._online.build(),{_offline:null==o?void 0:o._offline.build(a),_online:a}))}(e),e._firestoreClient}class o6{constructor(e){this._byteString=e}static fromBase64String(e){try{return new o6(t7.fromBase64String(e))}catch(e){throw new t_(tb.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new o6(t7.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class o3{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new t_(tb.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tz(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class o5{constructor(e){this._methodName=e}}class o4{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new t_(tb.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new t_(tb.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return tD(this._lat,e._lat)||tD(this._long,e._long)}}class o8{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(this._values,e._values)}}let o7=/^__.*__$/;class o9{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new nU(e,this.data,this.fieldMask,t,this.fieldTransforms):new nM(e,this.data,t,this.fieldTransforms)}}function ae(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ty(40011,{Ic:e})}}class at{constructor(e,t,r,n,i,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=n,void 0===i&&this.Ec(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new at(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;let r=null==(t=this.path)?void 0:t.child(e),n=this.dc({path:r,Rc:!1});return n.Vc(e),n}mc(e){var t;let r=null==(t=this.path)?void 0:t.child(e),n=this.dc({path:r,Rc:!1});return n.Ec(),n}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return ad(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(0===e.length)throw this.gc("Document fields must not be empty");if(ae(this.Ic)&&o7.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class ar{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||sl(e)}bc(e,t,r,n=!1){return new at({Ic:e,methodName:t,wc:r,path:tz.emptyPath(),Rc:!1,yc:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function an(e){let t=e._freezeSettings(),r=sl(e._databaseId);return new ar(e._databaseId,!!t.ignoreUndefinedProperties,r)}function ai(e,t,r,n,i,s={}){let o,a,l=e.bc(s.merge||s.mergeFields?2:0,t,r,i);au("Data must be an object, but it was:",l,n);let u=aa(n,l);if(s.merge)o=new t4(l.fieldMask),a=l.fieldTransforms;else if(s.mergeFields){let e=[];for(let n of s.mergeFields){let i=function(e,t,r){if((t=ei(t))instanceof o3)return t._internalPath;if("string"==typeof t)return ah(e,t);throw ad("Field path arguments must be of type string or ",e,!1,void 0,r)}(t,n,r);if(!l.contains(i))throw new t_(tb.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);(function(e,t){return e.some(e=>e.isEqual(t))})(e,i)||e.push(i)}o=new t4(e),a=l.fieldTransforms.filter(e=>o.covers(e.field))}else o=null,a=l.fieldTransforms;return new o9(new rP(u),o,a)}class as extends o5{_toFieldTransform(e){return new nA(e.path,new nb)}isEqual(e){return e instanceof as}}function ao(e,t){if(al(e=ei(e)))return au("Unsupported field value:",t,e),aa(e,t);if(e instanceof o5)return function(e,t){if(!ae(t.Ic))throw t.gc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.gc(`${e._methodName}() is not currently supported inside arrays`);let r=e._toFieldTransform(t);r&&t.fieldTransforms.push(r)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Rc&&4!==t.Ic)throw t.gc("Nested arrays are not supported");let r=[],n=0;for(let i of e){let e=ao(i,t.fc(n));null==e&&(e={nullValue:"NULL_VALUE"}),r.push(e),n++}return{arrayValue:{values:r}}}return function(e,t){var r,n,i;if(null===(e=ei(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return r=t.serializer,"number"==typeof(i=n=e)&&Number.isInteger(i)&&!tX(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER?ny(n):nm(r,n);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){let r=tU.fromDate(e);return{timestampValue:ii(t.serializer,r)}}if(e instanceof tU){let r=new tU(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:ii(t.serializer,r)}}if(e instanceof o4)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof o6)return{bytesValue:is(t.serializer,e._byteString)};if(e instanceof oG){let r=t.databaseId,n=e.firestore._databaseId;if(!n.isEqual(r))throw t.gc(`Document reference is for database ${n.projectId}/${n.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:ia(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof o8)return{mapValue:{fields:{[rf]:{stringValue:rm},[ry]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.gc("VectorValues must only contain numeric values.");return nm(t.serializer,e)})}}}}};throw t.gc(`Unsupported field value: ${oj(e)}`)}(e,t)}function aa(e,t){let r={};return t0(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):tZ(e,(e,n)=>{let i=ao(n,t.Ac(e));null!=i&&(r[e]=i)}),{mapValue:{fields:r}}}function al(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof tU||e instanceof o4||e instanceof o6||e instanceof oG||e instanceof o5||e instanceof o8)}function au(e,t,r){if(!al(r)||"object"!=typeof r||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){let n=oj(r);throw"an object"===n?t.gc(e+" a custom object"):t.gc(e+" "+n)}}let ac=RegExp("[~\\*/\\[\\]]");function ah(e,t,r){if(t.search(ac)>=0)throw ad(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new o3(...t.split("."))._internalPath}catch(n){throw ad(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function ad(e,t,r,n,i){let s=n&&!n.isEmpty(),o=void 0!==i,a=`Function ${t}() called with invalid data`;r&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${n}`),o&&(l+=` in document ${i}`),l+=")"),new t_(tb.INVALID_ARGUMENT,a+e+l)}class af{constructor(e,t,r,n,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=n,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new oG(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){let e=new ap(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(ag("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class ap extends af{data(){return super.data()}}function ag(e,t){return"string"==typeof t?ah(e,t):t instanceof o3?t._internalPath:t._delegate._internalPath}class am{}class ay extends am{}function av(e,t,...r){let n=[];for(let i of(t instanceof am&&n.push(t),function(e){let t=e.filter(e=>e instanceof ab).length,r=e.filter(e=>e instanceof aw).length;if(t>1||t>0&&r>0)throw new t_(tb.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n=n.concat(r)),n))e=i._apply(e);return e}class aw extends ay{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new aw(e,t,r)}_apply(e){let t=this._parse(e);return aS(e._query,t),new oH(e.firestore,e.converter,r9(e._query,t))}_parse(e){let t=an(e.firestore);return function(e,t,r,n,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new t_(tb.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){aT(o,s);let t=[];for(let r of o)t.push(aI(n,e,r));a={arrayValue:{values:t}}}else a=aI(n,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||aT(o,s),a=function(e,t,r,n=!1){return ao(r,e.bc(n?4:3,t))}(r,t,o,"in"===s||"not-in"===s);return rB.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class ab extends am{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new ab(e,t)}_parse(e){let t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:r$.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let r=e;for(let e of t.getFlattenedFilters())aS(r,e),r=r9(r,e)}(e._query,t),new oH(e.firestore,e.converter,r9(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class a_ extends ay{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new a_(e,t)}_apply(e){var t;let r,n=function(e,t,r){if(null!==e.startAt)throw new t_(tb.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new t_(tb.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new rF(t,r)}(e._query,this._field,this._direction);return new oH(e.firestore,e.converter,(t=e._query,r=t.explicitOrderBy.concat([n]),new r3(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}function aE(e,t="asc"){let r=ag("orderBy",e);return a_._create(r,t)}function aI(e,t,r){if("string"==typeof(r=ei(r))){if(""===r)throw new t_(tb.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!r4(t)&&-1!==r.indexOf("/"))throw new t_(tb.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);let n=t.path.child(tB.fromString(r));if(!tq.isDocumentKey(n))throw new t_(tb.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return rS(e,new tq(n))}if(r instanceof oG)return rS(e,r._key);throw new t_(tb.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${oj(r)}.`)}function aT(e,t){if(!Array.isArray(e)||0===e.length)throw new t_(tb.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function aS(e,t){let r=function(e,t){for(let r of e)for(let e of r.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==r)throw r===t.op?new t_(tb.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new t_(tb.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}class aC{convertValue(e,t="none"){switch(rv(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(rr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ty(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return tZ(e,(e,n)=>{r[e]=this.convertValue(n,t)}),r}convertVectorValue(e){var t,r,n;return new o8(null==(n=null==(r=null==(t=e.fields)?void 0:t[ry].arrayValue)?void 0:r.values)?void 0:n.map(e=>rt(e.doubleValue)))}convertGeoPoint(e){return new o4(rt(e.latitude),rt(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=rl(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ru(e));default:return null}}convertTimestamp(e){let t=re(e);return new tU(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=tB.fromString(e);tw(iw(r),9688,{name:e});let n=new rd(r.get(1),r.get(3)),i=new tq(r.popFirst(5));return n.isEqual(t)||tp(`Document ${i} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function ak(e,t,r){return e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t}class aA{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ax extends af{constructor(e,t,r,n,i,s){super(e,t,r,n,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new aR(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(ag("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class aR extends ax{data(e={}){return super.data(e)}}class aN{constructor(e,t,r,n){this._firestore=e,this._userDataWriter=t,this._snapshot=n,this.metadata=new aA(n.hasPendingWrites,n.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new aR(this._firestore,this._userDataWriter,r.key,r,new aA(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new t_(tb.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(r=>{let n=new aR(e._firestore,e._userDataWriter,r.doc.key,r.doc,new aA(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter);return r.doc,{type:"added",doc:n,oldIndex:-1,newIndex:t++}})}{let r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{let n=new aR(e._firestore,e._userDataWriter,t.doc.key,t.doc,new aA(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,s=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(s=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:function(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ty(61501,{type:e})}}(t.type),doc:n,oldIndex:i,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}class aO extends aC{constructor(e){super(),this.firestore=e}convertBytes(e){return new o6(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new oG(this.firestore,null,t)}}function aD(e,t,r){e=oB(e,oG);let n=oB(e.firestore,o0),i=ak(e.converter,t,r);return aU(n,[ai(an(n),"setDoc",e._key,i,null!==e.converter,r).toMutation(e._key,nR.none())])}function aP(e){return aU(oB(e.firestore,o0),[new nB(e._key,nR.none())])}function aL(e,t){let r=oB(e.firestore,o0),n=oQ(e),i=ak(e.converter,t);return aU(r,[ai(an(e.firestore),"addDoc",n._key,i,null!==e.converter,{}).toMutation(n._key,nR.exists(!1))]).then(()=>n)}function aM(e,...t){var r,n,i,s;let o,a,l,u,c;e=ei(e);let h={includeMetadataChanges:!1,source:"default"},d=0;"object"!=typeof t[0]||oZ(t[d])||(h=t[d],d++);let f={includeMetadataChanges:h.includeMetadataChanges,source:h.source};if(oZ(t[d])){let e=t[d];t[d]=null==(r=e.next)?void 0:r.bind(e),t[d+1]=null==(n=e.error)?void 0:n.bind(e),t[d+2]=null==(i=e.complete)?void 0:i.bind(e)}if(e instanceof oG)a=oB(e.firestore,o0),l=new r3(e._key.path),o={next:r=>{var n,i,s;let o,l;t[d]&&t[d]((n=a,i=e,o=(s=r).docs.get(i._key),l=new aO(n),new ax(n,l,i._key,o,new aA(s.hasPendingWrites,s.fromCache),i.converter)))},error:t[d+1],complete:t[d+2]};else{let r=oB(e,oH);a=oB(r.firestore,o0),l=r._query;let n=new aO(a);o={next:e=>{t[d]&&t[d](new aN(a,n,r,e))},error:t[d+1],complete:t[d+2]},function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new t_(tb.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query)}return s=o2(a),c=new s3(l,u=new ok(o),f),s.asyncQueue.enqueueAndForget(async()=>sZ(await oP(s),c)),()=>{u.xu(),s.asyncQueue.enqueueAndForget(async()=>s0(await oP(s),c))}}function aU(e,t){var r;let n;return r=o2(e),n=new tE,r.asyncQueue.enqueueAndForget(async()=>ol(await oD(r).then(e=>e.syncEngine),t,n)),n.promise}function aV(){return new as("serverTimestamp")}new WeakMap,function(e=!0){tc=eW,eV(new es("firestore",(t,{instanceIdentifier:r,options:n})=>{let i=t.getProvider("app").getImmediate(),s=new o0(new tC(t.getProvider("auth-internal")),new tR(i,t.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new t_(tb.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new rd(e.options.projectId,t)}(i,r),i);return n=Object.assign({useFetchStreams:e},n),s._setSettings(n),s},"PUBLIC").setMultipleInstances(!0)),e0(ta,tl,void 0),e0(ta,tl,"esm2017")}(),e.s(["addDoc",()=>aL,"collection",()=>oW,"deleteDoc",()=>aP,"doc",()=>oQ,"getFirestore",()=>o1,"onSnapshot",()=>aM,"orderBy",()=>aE,"query",()=>av,"serverTimestamp",()=>aV,"setDoc",()=>aD],17875),e.s([],36180),e0("firebase","11.9.1","app"),e.i(85086);let aF="firebasestorage.googleapis.com";class aj extends W{constructor(e,t,r=0){super(aB(e),`Firebase Storage: ${t} (${aB(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,aj.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return aB(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function aB(e){return"storage/"+e}function a$(e){return new aj(I.INVALID_ARGUMENT,e)}function az(){return new aj(I.APP_DELETED,"The Firebase app was deleted.")}(s=I||(I={})).UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment";class aq{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=aq.makeFromUrl(e,t)}catch(t){return new aq(e,"")}if(""===r.path)return r;throw new aj(I.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){let r=null,n="([A-Za-z0-9.\\-_]+)",i=RegExp("^gs://"+n+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}let o=t.replace(/[.]/g,"\\."),a=RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${n}/o(/([^?#]*).*)?$`,"i"),l=t===aF?"(?:storage.googleapis.com|storage.cloud.google.com)":t,u=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:a,indices:{bucket:1,path:3},postModify:s},{regex:RegExp(`^https?://${l}/${n}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let t=0;t<u.length;t++){let n=u[t],i=n.regex.exec(e);if(i){let e=i[n.indices.bucket],t=i[n.indices.path];t||(t=""),r=new aq(e,t),n.postModify(r);break}}if(null==r)throw new aj(I.INVALID_URL,"Invalid URL '"+e+"'.");return r}}class aH{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function aG(e,t,r,n){if(n<t)throw a$(`Invalid value for '${e}'. Expected ${t} or greater.`);if(n>r)throw a$(`Invalid value for '${e}'. Expected ${r} or less.`)}(o=T||(T={}))[o.NO_ERROR=0]="NO_ERROR",o[o.NETWORK_ERROR=1]="NETWORK_ERROR",o[o.ABORT=2]="ABORT";class aK{constructor(e,t,r,n,i,s,o,a,l,u,c,h=!0,d=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=n,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=c,this.retry=h,this.isUsingEmulator=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){let e=(e,t)=>{if(t)return void e(!1,new aW(!1,null,!0));let r=this.connectionFactory_();this.pendingConnection_=r;let n=e=>{let t=e.loaded,r=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,r)};null!==this.progressCallback_&&r.addUploadProgressListener(n),r.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{var t;let i,s,o;null!==this.progressCallback_&&r.removeUploadProgressListener(n),this.pendingConnection_=null;let a=r.getErrorCode()===T.NO_ERROR,l=r.getStatus();!a||(t=this.additionalRetryCodes_,i=l>=500&&l<600,s=-1!==[408,429].indexOf(l),o=-1!==t.indexOf(l),(i||s||o)&&this.retry)?e(!1,new aW(!1,null,r.getErrorCode()===T.ABORT)):e(!0,new aW(-1!==this.successCodes_.indexOf(l),r))})},t=(e,t)=>{let r=this.resolve_,n=this.reject_,i=t.connection;if(t.wasSuccessCode)try{let e=this.callback_(i,i.getResponse());void 0!==e?r(e):r()}catch(e){n(e)}else if(null!==i){let e=new aj(I.UNKNOWN,"An unknown error occurred, please check the error payload for server response.");e.serverResponse=i.getErrorText(),n(this.errorCallback_?this.errorCallback_(i,e):e)}else n(t.canceled?this.appDelete_?az():new aj(I.CANCELED,"User canceled the upload/download."):new aj(I.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))};this.canceled_?t(!1,new aW(!1,null,!0)):this.backoffId_=function(e,t,r){let n=1,i=null,s=null,o=!1,a=0,l=!1;function u(...e){l||(l=!0,t.apply(null,e))}function c(t){i=setTimeout(()=>{i=null,e(d,2===a)},t)}function h(){s&&clearTimeout(s)}function d(e,...t){let r;if(l)return void h();if(e||2===a||o){h(),u.call(null,e,...t);return}n<64&&(n*=2),1===a?(a=2,r=0):r=(n+Math.random())*1e3,c(r)}let f=!1;function p(e){f||(f=!0,h(),!l&&(null!==i?(e||(a=2),clearTimeout(i),c(0)):e||(a=1)))}return c(0),s=setTimeout(()=>{o=!0,p(!0)},r),p}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class aW{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}class aQ{constructor(e,t){this._service=e,t instanceof aq?this._location=t:this._location=aq.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new aQ(e,t)}get root(){let e=new aq(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){var e;let t;return -1===(t=(e=this._location.path).lastIndexOf("/",e.length-2))?e:e.slice(t+1)}get storage(){return this._service}get parent(){let e=function(e){if(0===e.length)return null;let t=e.lastIndexOf("/");return -1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;let t=new aq(this._location.bucket,e);return new aQ(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw new aj(I.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}}function aY(e,t){let r=null==t?void 0:t.storageBucket;return null==r?null:aq.makeFromBucketSpec(r,e)}class aX{constructor(e,t,r,n,i,s=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=n,this._firebaseVersion=i,this._isUsingEmulator=s,this._bucket=null,this._host=aF,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,null!=n?this._bucket=aq.makeFromBucketSpec(n,this._host):this._bucket=aY(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=aq.makeFromBucketSpec(this._url,e):this._bucket=aY(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){aG("time",0,1/0,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){aG("time",0,1/0,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){if(e$(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new aQ(this,e)}_makeRequest(e,t,r,n,i=!0){if(this._deleted)return new aH(az());{let s=function(e,t,r,n,i,s,o=!0,a=!1){let l=function(e){let t=encodeURIComponent,r="?";for(let n in e)e.hasOwnProperty(n)&&(r=r+(t(n)+"=")+t(e[n])+"&");return r.slice(0,-1)}(e.urlParams),u=e.url+l,c=Object.assign({},e.headers);return t&&(c["X-Firebase-GMPID"]=t),null!==r&&r.length>0&&(c.Authorization="Firebase "+r),c["X-Firebase-Storage-Version"]="webjs/"+(null!=s?s:"AppManager"),null!==n&&(c["X-Firebase-AppCheck"]=n),new aK(u,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o,a)}(e,this._appId,r,n,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,t){let[r,n]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,n).getPromise()}}let aJ="@firebase/storage",aZ="0.13.13",a0="storage";eV(new es(a0,function(e,{instanceIdentifier:t}){return new aX(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t,eW)},"PUBLIC").setMultipleInstances(!0)),e0(aJ,aZ,""),e0(aJ,aZ,"esm2017");var a1=function(){return(a1=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a2(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function a6(e,t,r){if(r||2==arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function a3(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}"function"==typeof SuppressedError&&SuppressedError,e.s(["__assign",()=>a1,"__rest",()=>a2,"__spreadArray",()=>a6],90571);let a5=new Q("auth","Firebase",a3()),a4=new ep("@firebase/auth");function a8(e,...t){a4.logLevel<=l.ERROR&&a4.error(`Auth (${eW}): ${e}`,...t)}function a7(e,...t){throw lr(e,...t)}function a9(e,...t){return lr(e,...t)}function le(e,t,r){return new Q("auth","Firebase",Object.assign(Object.assign({},a3()),{[t]:r})).create(t,{appName:e.name})}function lt(e){return le(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function lr(e,...t){if("string"!=typeof e){let r=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)}return a5.create(e,...t)}function ln(e,t,...r){if(!e)throw lr(t,...r)}function li(e){let t="INTERNAL ASSERTION FAILED: "+e;throw a8(t),Error(t)}function ls(){var e;return"undefined"!=typeof self&&(null==(e=self.location)?void 0:e.href)||""}function lo(){var e;return"undefined"!=typeof self&&(null==(e=self.location)?void 0:e.protocol)||null}class la{constructor(e,t){var r;this.shortDelay=e,this.longDelay=t,r="Short delay should be less than long delay!",t>e||li(r),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(G())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){let e;return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===lo()||"https:"===lo()||"object"==typeof(e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==e.id||"connection"in navigator))||navigator.onLine?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function ll(e,t){var r,n;r=e.emulator,n="Emulator should always be set here",r||li(n);let{url:i}=e.emulator;return t?`${i}${t.startsWith("/")?t.slice(1):t}`:i}class lu{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void li("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void li("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void li("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}let lc={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},lh=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ld=new la(3e4,6e4);function lf(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function lp(e,t,r,n,i={}){return lg(e,i,async()=>{let i={},s={};n&&("GET"===t?s=n:i={body:JSON.stringify(n)});let o=Z(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);let l=Object.assign({method:t,headers:a},i);return("undefined"==typeof navigator||"Cloudflare-Workers"!==navigator.userAgent)&&(l.referrerPolicy="no-referrer"),e.emulatorConfig&&j(e.emulatorConfig.host)&&(l.credentials="include"),lu.fetch()(await ly(e,e.config.apiHost,r,o),l)})}async function lg(e,t,r){e._canInitEmulator=!1;let n=Object.assign(Object.assign({},lc),t);try{let t=new lv(e),i=await Promise.race([r(),t.promise]);t.clearNetworkTimeout();let s=await i.json();if("needConfirmation"in s)throw lw(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{let[t,r]=(i.ok?s.errorMessage:s.error.message).split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===t)throw lw(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===t)throw lw(e,"email-already-in-use",s);if("USER_DISABLED"===t)throw lw(e,"user-disabled",s);let o=n[t]||t.toLowerCase().replace(/[_\s]+/g,"-");if(r)throw le(e,o,r);a7(e,o)}}catch(t){if(t instanceof W)throw t;a7(e,"network-request-failed",{message:String(t)})}}async function lm(e,t,r,n,i={}){let s=await lp(e,t,r,n,i);return"mfaPendingCredential"in s&&a7(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function ly(e,t,r,n){let i=`${t}${r}?${n}`,s=e.config.emulator?ll(e.config,i):`${e.config.apiScheme}://${i}`;return lh.includes(r)&&(await e._persistenceManagerAvailable,"COOKIE"===e._getPersistenceType())?e._getPersistence()._getFinalTarget(s).toString():s}class lv{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(a9(this.auth,"network-request-failed")),ld.get())})}}function lw(e,t,r){let n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);let i=a9(e,t,n);return i.customData._tokenResponse=r,i}function lb(e){return void 0!==e&&void 0!==e.enterprise}class l_{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)switch(t.enforcementState){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function lE(e,t){return lp(e,"GET","/v2/recaptchaConfig",lf(e,t))}async function lI(e,t){return lp(e,"POST","/v1/accounts:delete",t)}async function lT(e,t){return lp(e,"POST","/v1/accounts:lookup",t)}function lS(e){if(e)try{let t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}async function lC(e,t=!1){let r=ei(e),n=await r.getIdToken(t),i=lA(n);ln(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");let s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:lS(lk(i.auth_time)),issuedAtTime:lS(lk(i.iat)),expirationTime:lS(lk(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}function lk(e){return 1e3*Number(e)}function lA(e){let[t,r,n]=e.split(".");if(void 0===t||void 0===r||void 0===n)return a8("JWT malformed, contained fewer than 3 sections"),null;try{let e=D(r);if(!e)return a8("Failed to decode base64 JWT payload"),null;return JSON.parse(e)}catch(e){return a8("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}function lx(e){let t=lA(e);return ln(t,"internal-error"),ln(void 0!==t.exp,"internal-error"),ln(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function lR(e,t,r=!1){if(r)return t;try{return await t}catch(t){throw t instanceof W&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class lN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(!e)return this.errorBackoff=3e4,Math.max(0,(null!=(t=this.user.stsTokenManager.expirationTime)?t:0)-Date.now()-3e5);{let e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(null==e?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class lO{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=lS(this.lastLoginAt),this.creationTime=lS(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function lD(e){var t,r,n;let i=e.auth,s=await e.getIdToken(),o=await lR(e,lT(i,{idToken:s}));ln(null==o?void 0:o.users.length,i,"internal-error");let a=o.users[0];e._notifyReloadListener(a);let l=(null==(t=a.providerUserInfo)?void 0:t.length)?lL(a.providerUserInfo):[],u=(r=e.providerData,n=l,[...r.filter(e=>!n.some(t=>t.providerId===e.providerId)),...n]),c=e.isAnonymous,h=!(e.email&&a.passwordHash)&&!(null==u?void 0:u.length);Object.assign(e,{uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new lO(a.createdAt,a.lastLoginAt),isAnonymous:!!c&&h})}async function lP(e){let t=ei(e);await lD(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function lL(e){return e.map(e=>{var{providerId:t}=e,r=a2(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function lM(e,t){let r=await lg(e,{},async()=>{let r=Z({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:n,apiKey:i}=e.config,s=await ly(e,n,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";let a={method:"POST",headers:o,body:r};return e.emulatorConfig&&j(e.emulatorConfig.host)&&(a.credentials="include"),lu.fetch()(s,a)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function lU(e,t){return lp(e,"POST","/v2/accounts:revokeToken",lf(e,t))}class lV{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ln(e.idToken,"internal-error"),ln(void 0!==e.idToken,"internal-error"),ln(void 0!==e.refreshToken,"internal-error");let t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):lx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ln(0!==e.length,"internal-error");let t=lx(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(ln(this.refreshToken,e,"user-token-expired"),this.refreshToken)?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:n,expiresIn:i}=await lM(e,t);this.updateTokensAndExpiration(r,n,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(e,t){let{refreshToken:r,accessToken:n,expirationTime:i}=t,s=new lV;return r&&(ln("string"==typeof r,"internal-error",{appName:e}),s.refreshToken=r),n&&(ln("string"==typeof n,"internal-error",{appName:e}),s.accessToken=n),i&&(ln("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new lV,this.toJSON())}_performRefresh(){return li("not implemented")}}function lF(e,t){ln("string"==typeof e||void 0===e,"internal-error",{appName:t})}class lj{constructor(e){var{uid:t,auth:r,stsTokenManager:n}=e,i=a2(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new lN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new lO(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){let t=await lR(this,this.stsTokenManager.getToken(this.auth,e));return ln(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return lC(this,e)}reload(){return lP(this)}_assign(e){this!==e&&(ln(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new lj(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ln(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await lD(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(e$(this.auth.app))return Promise.reject(lt(this.auth));let e=await this.getIdToken();return await lR(this,lI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,n,i,s,o,a,l,u;let c=null!=(r=t.displayName)?r:void 0,h=null!=(n=t.email)?n:void 0,d=null!=(i=t.phoneNumber)?i:void 0,f=null!=(s=t.photoURL)?s:void 0,p=null!=(o=t.tenantId)?o:void 0,g=null!=(a=t._redirectEventId)?a:void 0,m=null!=(l=t.createdAt)?l:void 0,y=null!=(u=t.lastLoginAt)?u:void 0,{uid:v,emailVerified:w,isAnonymous:b,providerData:_,stsTokenManager:E}=t;ln(v&&E,e,"internal-error");let I=lV.fromJSON(this.name,E);ln("string"==typeof v,e,"internal-error"),lF(c,e.name),lF(h,e.name),ln("boolean"==typeof w,e,"internal-error"),ln("boolean"==typeof b,e,"internal-error"),lF(d,e.name),lF(f,e.name),lF(p,e.name),lF(g,e.name),lF(m,e.name),lF(y,e.name);let T=new lj({uid:v,auth:e,email:h,emailVerified:w,displayName:c,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:I,createdAt:m,lastLoginAt:y});return _&&Array.isArray(_)&&(T.providerData=_.map(e=>Object.assign({},e))),g&&(T._redirectEventId=g),T}static async _fromIdTokenResponse(e,t,r=!1){let n=new lV;n.updateFromServerResponse(t);let i=new lj({uid:t.localId,auth:e,stsTokenManager:n,isAnonymous:r});return await lD(i),i}static async _fromGetAccountInfoResponse(e,t,r){let n=t.users[0];ln(void 0!==n.localId,"internal-error");let i=void 0!==n.providerUserInfo?lL(n.providerUserInfo):[],s=!(n.email&&n.passwordHash)&&!(null==i?void 0:i.length),o=new lV;o.updateFromIdToken(r);let a=new lj({uid:n.localId,auth:e,stsTokenManager:o,isAnonymous:s});return Object.assign(a,{uid:n.localId,displayName:n.displayName||null,photoURL:n.photoUrl||null,email:n.email||null,emailVerified:n.emailVerified||!1,phoneNumber:n.phoneNumber||null,tenantId:n.tenantId||null,providerData:i,metadata:new lO(n.createdAt,n.lastLoginAt),isAnonymous:!(n.email&&n.passwordHash)&&!(null==i?void 0:i.length)}),a}}let lB=new Map;function l$(e){var t,r;t="Expected a class definition",e instanceof Function||li(t);let n=lB.get(e);return n?(r="Instance stored in cache mismatched with class",n instanceof e||li(r)):(n=new e,lB.set(e,n)),n}class lz{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}function lq(e,t,r){return`firebase:${e}:${t}:${r}`}lz.type="NONE";class lH{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:n,name:i}=this.auth;this.fullUserKey=lq(this.userKey,n.apiKey,i),this.fullPersistenceKey=lq("persistence",n.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){let t=await lT(this.auth,{idToken:e}).catch(()=>void 0);return t?lj._fromGetAccountInfoResponse(this.auth,t,e):null}return lj._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new lH(l$(lz),e,r);let n=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e),i=n[0]||l$(lz),s=lq(r,e.config.apiKey,e.name),o=null;for(let r of t)try{let t=await r._get(s);if(t){let n;if("string"==typeof t){let r=await lT(e,{idToken:t}).catch(()=>void 0);if(!r)break;n=await lj._fromGetAccountInfoResponse(e,r,t)}else n=lj._fromJSON(e,t);r!==i&&(o=n),i=r;break}}catch(e){}let a=n.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&a.length&&(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(e){}}))),new lH(i,e,r)}}function lG(e){let t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";{if(lY(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(lK(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(lJ(t))return"Blackberry";if(lZ(t))return"Webos";if(lW(t))return"Safari";if((t.includes("chrome/")||lQ(t))&&!t.includes("edge/"))return"Chrome";if(lX(t))return"Android";let r=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if((null==r?void 0:r.length)===2)return r[1]}return"Other"}function lK(e=G()){return/firefox\//i.test(e)}function lW(e=G()){let t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function lQ(e=G()){return/crios\//i.test(e)}function lY(e=G()){return/iemobile/i.test(e)}function lX(e=G()){return/android/i.test(e)}function lJ(e=G()){return/blackberry/i.test(e)}function lZ(e=G()){return/webos/i.test(e)}function l0(e=G()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function l1(e=G()){return l0(e)||lX(e)||lZ(e)||lJ(e)||/windows phone/i.test(e)||lY(e)}function l2(e,t=[]){let r;switch(e){case"Browser":r=lG(G());break;case"Worker":r=`${lG(G())}-${e}`;break;default:r=e}let n=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${eW}/${n}`}class l6{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=t=>new Promise((r,n)=>{try{let n=e(t);r(n)}catch(e){n(e)}});r.onAbort=t,this.queue.push(r);let n=this.queue.length-1;return()=>{this.queue[n]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(e){for(let e of(t.reverse(),t))try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}async function l3(e,t={}){return lp(e,"GET","/v2/passwordPolicy",lf(e,t))}class l5{constructor(e){var t,r,n,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!=(t=s.minPasswordLength)?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!=(n=null==(r=e.allowedNonAlphanumericCharacters)?void 0:r.join(""))?n:"",this.forceUpgradeOnSignin=null!=(i=e.forceUpgradeOnSignin)&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,n,i,s,o;let a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null==(t=a.meetsMinPasswordLength)||t),a.isValid&&(a.isValid=null==(r=a.meetsMaxPasswordLength)||r),a.isValid&&(a.isValid=null==(n=a.containsLowercaseLetter)||n),a.isValid&&(a.isValid=null==(i=a.containsUppercaseLetter)||i),a.isValid&&(a.isValid=null==(s=a.containsNumericCharacter)||s),a.isValid&&(a.isValid=null==(o=a.containsNonAlphanumericCharacter)||o),a}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,n=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),n&&(t.meetsMaxPasswordLength=e.length<=n)}validatePasswordCharacterOptions(e,t){let r;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let n=0;n<e.length;n++)r=e.charAt(n),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,n,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=n)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class l4{constructor(e,t,r,n){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new l8(this),this.idTokenSubscription=new l8(this),this.beforeStateQueue=new l6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=a5,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=l$(t)),this._initializationPromise=this.queue(async()=>{var r,n,i;if(!this._deleted){if(this.persistenceManager=await lH.create(this,e),null==(r=this._resolvePersistenceManagerAvailable)||r.call(this),!this._deleted){if(null==(n=this._popupRedirectResolver)?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null==(i=this.currentUser)?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(this.currentUser||e){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await lT(this,{idToken:e}),r=await lj._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(e$(this.app)){let e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}let r=await this.assertedPersistence.getCurrentUser(),n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let r=null==(t=this.redirectUser)?void 0:t._redirectEventId,s=null==n?void 0:n._redirectEventId,o=await this.tryRedirectSignIn(e);(!r||r===s)&&(null==o?void 0:o.user)&&(n=o.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(e){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return(ln(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId)?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await lD(e)}catch(e){if((null==e?void 0:e.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;let e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(e$(this.app))return Promise.reject(lt(this));let t=e?ei(e):null;return t&&ln(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ln(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return e$(this.app)?Promise.reject(lt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return e$(this.app)?Promise.reject(lt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(l$(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=new l5(await l3(this));null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Q("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await lU(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null==(e=this._currentUser)?void 0:e.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return null===e?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&l$(e)||this._popupRedirectResolver;ln(t,this,"argument-error"),this.redirectPersistenceManager=await lH.create(this,[l$(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return(this._isInitialized&&await this.queue(async()=>{}),(null==(t=this._currentUser)?void 0:t._redirectEventId)===e)?this._currentUser:(null==(r=this.redirectUser)?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=null!=(t=null==(e=this.currentUser)?void 0:e.uid)?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,n){if(this._deleted)return()=>{};let i="function"==typeof t?t:t.next.bind(t),s=!1,o=this._isInitialized?Promise.resolve():this._initializationPromise;if(ln(o,this,"internal-error"),o.then(()=>{s||i(this.currentUser)}),"function"==typeof t){let i=e.addObserver(t,r,n);return()=>{s=!0,i()}}{let r=e.addObserver(t);return()=>{s=!0,r()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ln(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=l2(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=await (null==(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);let n=await this._getAppCheckToken();return n&&(t["X-Firebase-AppCheck"]=n),t}async _getAppCheckToken(){var e;if(e$(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=await (null==(e=this.appCheckServiceProvider.getImmediate({optional:!0}))?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){a4.logLevel<=l.WARN&&a4.warn(`Auth (${eW}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}class l8{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){let r=new er(e,void 0);return r.subscribe.bind(r)}(e=>this.observer=e)}get next(){return ln(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let l7={async loadJS(){throw Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function l9(e){return`__${e}${Math.floor(1e6*Math.random())}`}class ue{constructor(){this.enterprise=new ut}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class ut{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}let ur="NO_RECAPTCHA";class un{constructor(e){this.type="recaptcha-enterprise",this.auth=ei(e)}async verify(e="verify",t=!1){async function r(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,r)=>{lE(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(n=>{if(void 0===n.recaptchaKey)r(Error("recaptcha Enterprise site key undefined"));else{let r=new l_(n);return null==e.tenantId?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,t(r.siteKey)}}).catch(e=>{r(e)})})}function n(t,r,n){let i=window.grecaptcha;lb(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{r(e)}).catch(()=>{r(ur)})}):n(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new ue().execute("siteKey",{action:"verify"}):new Promise((e,i)=>{r(this.auth).then(r=>{if(!t&&lb(window.grecaptcha))n(r,e,i);else{var s;if("undefined"==typeof window)return void i(Error("RecaptchaVerifier is only supported in browser"));let t=l7.recaptchaEnterpriseScript;0!==t.length&&(t+=r),(s=t,l7.loadJS(s)).then(()=>{n(r,e,i)}).catch(e=>{i(e)})}}).catch(e=>{i(e)})})}}async function ui(e,t,r,n=!1,i=!1){let s,o=new un(e);if(i)s=ur;else try{s=await o.verify(r)}catch(e){s=await o.verify(r,!0)}let a=Object.assign({},t);if("mfaSmsEnrollment"===r||"mfaSmsSignIn"===r){if("phoneEnrollmentInfo"in a){let e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){let e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return n?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function us(e,t,r,n,i){var s,o;if("EMAIL_PASSWORD_PROVIDER"===i)if(null==(s=e._getRecaptchaConfig())||!s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return n(e,t).catch(async i=>{if("auth/missing-recaptcha-token"!==i.code)return Promise.reject(i);{console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let i=await ui(e,t,r,"getOobCode"===r);return n(e,i)}});else{let i=await ui(e,t,r,"getOobCode"===r);return n(e,i)}if("PHONE_PROVIDER"!==i)return Promise.reject(i+" provider is not supported.");if(null==(o=e._getRecaptchaConfig())?void 0:o.isProviderEnabled("PHONE_PROVIDER")){let i=await ui(e,t,r);return n(e,i).catch(async i=>{var s;if((null==(s=e._getRecaptchaConfig())?void 0:s.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&("auth/missing-recaptcha-token"===i.code||"auth/invalid-app-credential"===i.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${r} flow.`);let i=await ui(e,t,r,!1,!0);return n(e,i)}return Promise.reject(i)})}{let i=await ui(e,t,r,!1,!0);return n(e,i)}}async function uo(e){let t=ei(e),r=new l_(await lE(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}));null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()&&new un(t).verify()}function ua(e){let t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ul(e){if(!e)return null;let t=Number(e);return isNaN(t)?null:t}class uu{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return li("not implemented")}_getIdTokenResponse(e){return li("not implemented")}_linkToIdToken(e,t){return li("not implemented")}_getReauthenticationResolver(e){return li("not implemented")}}async function uc(e,t){return lp(e,"POST","/v1/accounts:signUp",t)}async function uh(e,t){return lm(e,"POST","/v1/accounts:signInWithPassword",lf(e,t))}async function ud(e,t){return lm(e,"POST","/v1/accounts:signInWithEmailLink",lf(e,t))}async function uf(e,t){return lm(e,"POST","/v1/accounts:signInWithEmailLink",lf(e,t))}class up extends uu{constructor(e,t,r,n=null){super("password",r),this._email=e,this._password=t,this._tenantId=n}static _fromEmailAndPassword(e,t){return new up(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new up(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);else if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return us(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",uh,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return ud(e,{email:this._email,oobCode:this._password});default:a7(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return us(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",uc,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return uf(e,{idToken:t,email:this._email,oobCode:this._password});default:a7(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ug(e,t){return lm(e,"POST","/v1/accounts:signInWithIdp",lf(e,t))}class um extends uu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new um(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):a7("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t="string"==typeof e?JSON.parse(e):e,{providerId:r,signInMethod:n}=t,i=a2(t,["providerId","signInMethod"]);if(!r||!n)return null;let s=new um(r,n);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return ug(e,this.buildRequest())}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,ug(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,ug(e,t)}buildRequest(){let e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Z(t)}return e}}async function uy(e,t){return lp(e,"POST","/v1/accounts:sendVerificationCode",lf(e,t))}async function uv(e,t){return lm(e,"POST","/v1/accounts:signInWithPhoneNumber",lf(e,t))}async function uw(e,t){let r=await lm(e,"POST","/v1/accounts:signInWithPhoneNumber",lf(e,t));if(r.temporaryProof)throw lw(e,"account-exists-with-different-credential",r);return r}let ub={USER_NOT_FOUND:"user-not-found"};async function u_(e,t){return lm(e,"POST","/v1/accounts:signInWithPhoneNumber",lf(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),ub)}class uE extends uu{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new uE({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new uE({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return uv(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return uw(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return u_(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:n}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:n}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:n,temporaryProof:i}=e;return r||t||n||i?new uE({verificationId:t,verificationCode:r,phoneNumber:n,temporaryProof:i}):null}}class uI{constructor(e){var t,r,n,i,s,o;const a=ee(et(e)),l=null!=(t=a.apiKey)?t:null,u=null!=(r=a.oobCode)?r:null,c=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!=(n=a.mode)?n:null);ln(l&&u&&c,"argument-error"),this.apiKey=l,this.operation=c,this.code=u,this.continueUrl=null!=(i=a.continueUrl)?i:null,this.languageCode=null!=(s=a.lang)?s:null,this.tenantId=null!=(o=a.tenantId)?o:null}static parseLink(e){let t,r,n,i=(r=(t=ee(et(e)).link)?ee(et(t)).deep_link_id:null,((n=ee(et(e)).deep_link_id)?ee(et(n)).link:null)||n||r||t||e);try{return new uI(i)}catch(e){return null}}}class uT{constructor(){this.providerId=uT.PROVIDER_ID}static credential(e,t){return up._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let r=uI.parseLink(t);return ln(r,"argument-error"),up._fromEmailAndCode(e,r.code,r.tenantId)}}uT.PROVIDER_ID="password",uT.EMAIL_PASSWORD_SIGN_IN_METHOD="password",uT.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class uS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class uC extends uS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class uk extends uC{constructor(){super("facebook.com")}static credential(e){return um._fromParams({providerId:uk.PROVIDER_ID,signInMethod:uk.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return uk.credentialFromTaggedObject(e)}static credentialFromError(e){return uk.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return uk.credential(e.oauthAccessToken)}catch(e){return null}}}uk.FACEBOOK_SIGN_IN_METHOD="facebook.com",uk.PROVIDER_ID="facebook.com";class uA extends uC{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return um._fromParams({providerId:uA.PROVIDER_ID,signInMethod:uA.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return uA.credentialFromTaggedObject(e)}static credentialFromError(e){return uA.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return uA.credential(t,r)}catch(e){return null}}}uA.GOOGLE_SIGN_IN_METHOD="google.com",uA.PROVIDER_ID="google.com";class ux extends uC{constructor(){super("github.com")}static credential(e){return um._fromParams({providerId:ux.PROVIDER_ID,signInMethod:ux.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ux.credentialFromTaggedObject(e)}static credentialFromError(e){return ux.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ux.credential(e.oauthAccessToken)}catch(e){return null}}}ux.GITHUB_SIGN_IN_METHOD="github.com",ux.PROVIDER_ID="github.com";class uR extends uC{constructor(){super("twitter.com")}static credential(e,t){return um._fromParams({providerId:uR.PROVIDER_ID,signInMethod:uR.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return uR.credentialFromTaggedObject(e)}static credentialFromError(e){return uR.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return uR.credential(t,r)}catch(e){return null}}}async function uN(e,t){return lm(e,"POST","/v1/accounts:signUp",lf(e,t))}uR.TWITTER_SIGN_IN_METHOD="twitter.com",uR.PROVIDER_ID="twitter.com";class uO{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,n=!1){return new uO({user:await lj._fromIdTokenResponse(e,r,n),providerId:uD(r),_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){return await e._updateTokensIfNecessary(r,!0),new uO({user:e,providerId:uD(r),_tokenResponse:r,operationType:t})}}function uD(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class uP extends W{constructor(e,t,r,n){var i;super(t.code,t.message),this.operationType=r,this.user=n,Object.setPrototypeOf(this,uP.prototype),this.customData={appName:e.name,tenantId:null!=(i=e.tenantId)?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,n){return new uP(e,t,r,n)}}function uL(e,t,r,n){return("reauthenticate"===t?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(r=>{if("auth/multi-factor-auth-required"===r.code)throw uP._fromErrorAndOperation(e,r,t,n);throw r})}async function uM(e,t,r=!1){let n=await lR(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return uO._forOperation(e,"link",n)}async function uU(e,t,r=!1){let{auth:n}=e;if(e$(n.app))return Promise.reject(lt(n));let i="reauthenticate";try{let s=await lR(e,uL(n,i,t,e),r);ln(s.idToken,n,"internal-error");let o=lA(s.idToken);ln(o,n,"internal-error");let{sub:a}=o;return ln(e.uid===a,n,"user-mismatch"),uO._forOperation(e,i,s)}catch(e){throw(null==e?void 0:e.code)==="auth/user-not-found"&&a7(n,"user-mismatch"),e}}async function uV(e,t,r=!1){if(e$(e.app))return Promise.reject(lt(e));let n="signIn",i=await uL(e,n,t),s=await uO._fromIdTokenResponse(e,n,i);return r||await e._updateCurrentUser(s.user),s}async function uF(e,t){return uV(ei(e),t)}class uj{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?uB._fromServerResponse(e,t):"totpInfo"in t?u$._fromServerResponse(e,t):a7(e,"internal-error")}}class uB extends uj{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new uB(t)}}class u$ extends uj{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new u$(t)}}async function uz(e){let t=ei(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function uq(e,t,r){if(e$(e.app))return Promise.reject(lt(e));let n=ei(e),i=us(n,{returnSecureToken:!0,email:t,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",uN,"EMAIL_PASSWORD_PROVIDER"),s=await i.catch(t=>{throw"auth/password-does-not-meet-requirements"===t.code&&uz(e),t}),o=await uO._fromIdTokenResponse(n,"signIn",s);return await n._updateCurrentUser(o.user),o}function uH(e,t,r){return e$(e.app)?Promise.reject(lt(e)):uF(ei(e),uT.credential(t,r)).catch(async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&uz(e),t})}function uG(e,t,r,n){return ei(e).onAuthStateChanged(t,r,n)}function uK(e){return ei(e).signOut()}function uW(e,t){return lp(e,"POST","/v2/accounts/mfaEnrollment:start",lf(e,t))}new WeakMap;let uQ="__sak";class uY{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{if(!this.storage)return Promise.resolve(!1);return this.storage.setItem(uQ,"1"),this.storage.removeItem(uQ),Promise.resolve(!0)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class uX extends uY{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=l1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let t of Object.keys(this.listeners)){let r=this.storage.getItem(t),n=this.localCache[t];r!==n&&e(t,n,r)}}onStorageEvent(e,t=!1){let r;if(!e.key)return void this.forAllChangedKeys((e,t,r)=>{this.notifyListeners(e,r)});let n=e.key;t?this.detachListener():this.stopPolling();let i=()=>{let e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);((r=G()).indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0)&&10===document.documentMode&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let e of Array.from(r))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){let t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}uX.type="LOCAL";class uJ extends uY{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}uJ.type="SESSION";class uZ{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;let r=new uZ(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let{eventId:t,eventType:r,data:n}=e.data,i=this.handlersMap[r];if(!(null==i?void 0:i.size))return;e.ports[0].postMessage({status:"ack",eventId:t,eventType:r});let s=Array.from(i).map(async t=>t(e.origin,n)),o=await Promise.all(s.map(async e=>{try{let t=await e;return{fulfilled:!0,value:t}}catch(e){return{fulfilled:!1,reason:e}}}));e.ports[0].postMessage({status:"done",eventId:t,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function u0(e="",t=10){let r="";for(let e=0;e<t;e++)r+=Math.floor(10*Math.random());return e+r}uZ.receivers=[];class u1{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let n,i,s="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!s)throw Error("connection_unavailable");return new Promise((o,a)=>{let l=u0("",20);s.port1.start();let u=setTimeout(()=>{a(Error("unsupported_event"))},r);i={messageChannel:s,onMessage(e){if(e.data.eventId===l)switch(e.data.status){case"ack":clearTimeout(u),n=setTimeout(()=>{a(Error("timeout"))},3e3);break;case"done":clearTimeout(n),o(e.data.response);break;default:clearTimeout(u),clearTimeout(n),a(Error("invalid_response"))}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}function u2(){return window}function u6(){return void 0!==u2().WorkerGlobalScope&&"function"==typeof u2().importScripts}async function u3(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}let u5="firebaseLocalStorageDb",u4="firebaseLocalStorage",u8="fbase_key";class u7{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function u9(e,t){return e.transaction([u4],t?"readwrite":"readonly").objectStore(u4)}function ce(){let e=indexedDB.open(u5,1);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{let t=e.result;try{t.createObjectStore(u4,{keyPath:u8})}catch(e){r(e)}}),e.addEventListener("success",async()=>{let r=e.result;r.objectStoreNames.contains(u4)?t(r):(r.close(),await new u7(indexedDB.deleteDatabase(u5)).toPromise(),t(await ce()))})})}async function ct(e,t,r){return new u7(u9(e,!0).put({[u8]:t,value:r})).toPromise()}async function cr(e,t){let r=u9(e,!1).get(t),n=await new u7(r).toPromise();return void 0===n?null:n.value}function cn(e,t){return new u7(u9(e,!0).delete(t)).toPromise()}class ci{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await ce()),this.db}async _withRetries(e){let t=0;for(;;)try{let t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return u6()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=uZ._getInstance(u6()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await u3(),!this.activeServiceWorker)return;this.sender=new u1(this.activeServiceWorker);let r=await this.sender._send("ping",{},800);r&&(null==(e=r[0])?void 0:e.fulfilled)&&(null==(t=r[0])?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null==(t=null==navigator?void 0:navigator.serviceWorker)?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await ce();return await ct(e,uQ,"1"),await cn(e,uQ),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>ct(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){let t=await this._withRetries(t=>cr(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>cn(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(e=>new u7(u9(e,!1).getAll()).toPromise());if(!e||0!==this.pendingWrites)return[];let t=[],r=new Set;if(0!==e.length)for(let{fbase_key:n,value:i}of e)r.add(n),JSON.stringify(this.localCache[n])!==JSON.stringify(i)&&(this.notifyListeners(n,i),t.push(n));for(let e of Object.keys(this.localCache))this.localCache[e]&&!r.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let e of Array.from(r))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}function cs(e,t){return lp(e,"POST","/v2/accounts/mfaSignIn:start",lf(e,t))}ci.type="LOCAL",l9("rcb"),new la(3e4,6e4);let co="recaptcha";async function ca(e,t,r){var n;if(!e._getRecaptchaConfig())try{await uo(e)}catch(e){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(i="string"==typeof t?{phoneNumber:t}:t,"session"in i){let t=i.session;if("phoneNumber"in i){ln("enroll"===t.type,e,"internal-error");let n={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},s=async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===ur){ln((null==r?void 0:r.type)===co,e,"argument-error");let n=await cl(e,t,r);return uW(e,n)}return uW(e,t)},o=us(e,n,"mfaSmsEnrollment",s,"PHONE_PROVIDER");return(await o.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{ln("signin"===t.type,e,"internal-error");let s=(null==(n=i.multiFactorHint)?void 0:n.uid)||i.multiFactorUid;ln(s,e,"missing-multi-factor-info");let o={mfaPendingCredential:t.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},a=async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===ur){ln((null==r?void 0:r.type)===co,e,"argument-error");let n=await cl(e,t,r);return cs(e,n)}return cs(e,t)},l=us(e,o,"mfaSmsSignIn",a,"PHONE_PROVIDER");return(await l.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{let t={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"},n=async(e,t)=>{if(t.captchaResponse===ur){ln((null==r?void 0:r.type)===co,e,"argument-error");let n=await cl(e,t,r);return uy(e,n)}return uy(e,t)},s=us(e,t,"sendVerificationCode",n,"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).sessionInfo}}finally{null==r||r._reset()}}async function cl(e,t,r){ln(r.type===co,e,"argument-error");let n=await r.verify();ln("string"==typeof n,e,"argument-error");let i=Object.assign({},t);if("phoneEnrollmentInfo"in i){let e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,r=i.phoneEnrollmentInfo.clientType,s=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:n,captchaResponse:t,clientType:r,recaptchaVersion:s}}),i}if(!("phoneSignInInfo"in i))return Object.assign(i,{recaptchaToken:n}),i;{let e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,r=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:n,captchaResponse:e,clientType:t,recaptchaVersion:r}}),i}}class cu{constructor(e){this.providerId=cu.PROVIDER_ID,this.auth=ei(e)}verifyPhoneNumber(e,t){return ca(this.auth,e,ei(t))}static credential(e,t){return uE._fromVerification(e,t)}static credentialFromResult(e){return cu.credentialFromTaggedObject(e)}static credentialFromError(e){return cu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:t,temporaryProof:r}=e;return t&&r?uE._fromTokenResponse(t,r):null}}function cc(e,t){return t?l$(t):(ln(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}cu.PROVIDER_ID="phone",cu.PHONE_SIGN_IN_METHOD="phone";class ch extends uu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ug(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ug(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ug(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function cd(e){return uV(e.auth,new ch(e),e.bypassAuthState)}function cf(e){let{auth:t,user:r}=e;return ln(r,t,"internal-error"),uU(r,new ch(e),e.bypassAuthState)}async function cp(e){let{auth:t,user:r}=e;return ln(r,t,"internal-error"),uM(r,new ch(e),e.bypassAuthState)}class cg{constructor(e,t,r,n,i=!1){this.auth=e,this.resolver=r,this.user=n,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:n,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);let a={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:n||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return cd;case"linkViaPopup":case"linkViaRedirect":return cp;case"reauthViaPopup":case"reauthViaRedirect":return cf;default:a7(this.auth,"internal-error")}}resolve(e){var t,r;t=this.pendingPromise,r="Pending promise was never set",t||li(r),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){var t,r;t=this.pendingPromise,r="Pending promise was never set",t||li(r),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}let cm=new la(2e3,1e4);async function cy(e,t,r){if(e$(e.app))return Promise.reject(a9(e,"operation-not-supported-in-this-environment"));let n=ei(e);if(!(t instanceof uS))throw uS.name!==t.constructor.name&&a7(e,"argument-error"),le(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`);let i=cc(n,r);return new cv(n,"signInViaPopup",t,i).executeNotNull()}class cv extends cg{constructor(e,t,r,n,i){super(e,t,n,i),this.provider=r,this.authWindow=null,this.pollId=null,cv.currentPopupAction&&cv.currentPopupAction.cancel(),cv.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return ln(e,this.auth,"internal-error"),e}async onExecution(){var e,t;e=1===this.filter.length,t="Popup operations only handle one event",e||li(t);let r=u0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],r),this.authWindow.associatedEvent=r,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(a9(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null==(e=this.authWindow)?void 0:e.associatedEvent)||null}cancel(){this.reject(a9(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,cv.currentPopupAction=null}pollUserCancellation(){let e=()=>{var t,r;if(null==(r=null==(t=this.authWindow)?void 0:t.window)?void 0:r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(a9(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,cm.get())};e()}}cv.currentPopupAction=null;let cw=new Map;class cb extends cg{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=cw.get(this.auth._key());if(!e){try{let t=await c_(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}cw.set(this.auth._key(),e)}return this.bypassAuthState||cw.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"===e.type)return void this.resolve(null);if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function c_(e,t){var r;let n=lq("pendingRedirect",(r=t).config.apiKey,r.name),i=l$(e._redirectPersistence);if(!await i._isAvailable())return!1;let s=await i._get(n)==="true";return await i._remove(n),s}function cE(e,t){cw.set(e._key(),t)}async function cI(e,t,r=!1){if(e$(e.app))return Promise.reject(lt(e));let n=ei(e),i=cc(n,t),s=new cb(n,i,r),o=await s.execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,t)),o}class cT{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return cC(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!cC(e)){let n=(null==(r=e.error.code)?void 0:r.split("auth/")[1])||"internal-error";t.onError(a9(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(cS(e))}saveEventToCache(e){this.cachedEventUids.add(cS(e)),this.lastProcessedEventTime=Date.now()}}function cS(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function cC({type:e,error:t}){return"unknown"===e&&(null==t?void 0:t.code)==="auth/no-auth-event"}async function ck(e,t={}){return lp(e,"GET","/v1/projects",t)}let cA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,cx=/^https?/;async function cR(e){if(e.config.emulator)return;let{authorizedDomains:t}=await ck(e);for(let e of t)try{if(function(e){let t=ls(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){let i=new URL(e);return""===i.hostname&&""===n?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&i.hostname===n}if(!cx.test(r))return!1;if(cA.test(e))return n===e;let i=e.replace(/\./g,"\\.");return RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}(e))return}catch(e){}a7(e,"unauthorized-domain")}let cN=new la(3e4,6e4);function cO(){let e=u2().___jsl;if(null==e?void 0:e.H){for(let t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}}let cD=null,cP=new la(5e3,15e3),cL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);async function cU(e){let t,r,n,i,s,o=await (cD=cD||new Promise((t,r)=>{var n,i,s,o;function a(){cO(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{cO(),r(a9(e,"network-request-failed"))},timeout:cN.get()})}if(null==(i=null==(n=u2().gapi)?void 0:n.iframes)?void 0:i.Iframe)t(gapi.iframes.getContext());else if(null==(s=u2().gapi)?void 0:s.load)a();else{let t=l9("iframefcb");return u2()[t]=()=>{gapi.load?a():r(a9(e,"network-request-failed"))},(o=`${l7.gapiScript}?onload=${t}`,l7.loadJS(o)).catch(e=>r(e))}}).catch(e=>{throw cD=null,e})),a=u2().gapi;return ln(a,e,"internal-error"),o.open({where:document.body,url:(ln((t=e.config).authDomain,e,"auth-domain-config-required"),r=t.emulator?ll(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,n={apiKey:t.apiKey,appName:e.name,v:eW},(i=cM.get(e.config.apiHost))&&(n.eid=i),(s=e._getFrameworks()).length&&(n.fw=s.join(",")),`${r}?${Z(n).slice(1)}`),messageHandlersFilter:a.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:cL,dontclear:!0},t=>new Promise(async(r,n)=>{await t.restyle({setHideOnLeave:!1});let i=a9(e,"network-request-failed"),s=u2().setTimeout(()=>{n(i)},cP.get());function o(){u2().clearTimeout(s),r(t)}t.ping(o).then(o,()=>{n(i)})}))}let cV={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class cF{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}let cj=encodeURIComponent("fac");async function cB(e,t,r,n,i,s){ln(e.config.authDomain,e,"auth-domain-config-required"),ln(e.config.apiKey,e,"invalid-api-key");let o={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:eW,eventId:i};if(t instanceof uS)for(let[r,n]of(t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",!function(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())&&(o.customParameters=JSON.stringify(t.getCustomParameters())),Object.entries(s||{})))o[r]=n;if(t instanceof uC){let e=t.getScopes().filter(e=>""!==e);e.length>0&&(o.scopes=e.join(","))}for(let t of(e.tenantId&&(o.tid=e.tenantId),Object.keys(o)))void 0===o[t]&&delete o[t];let a=await e._getAppCheckToken(),l=a?`#${cj}=${encodeURIComponent(a)}`:"";return`${function({config:e}){return e.emulator?ll(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${Z(o).slice(1)}${l}`}let c$="webStorageSupport",cz=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=uJ,this._completeRedirectFn=cI,this._overrideRedirectResult=cE}async _openPopup(e,t,r,n){var i,s,o;s=null==(i=this.eventManagers[e._key()])?void 0:i.manager,o="_initialize() not called before _openPopup()",s||li(o);let a=await cB(e,t,r,ls(),n);return function(e,t,r,n=500,i=600){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString(),a="",l=Object.assign(Object.assign({},cV),{width:n.toString(),height:i.toString(),top:s,left:o}),u=G().toLowerCase();r&&(a=lQ(u)?"_blank":r),lK(u)&&(t=t||"http://localhost",l.scrollbars="yes");let c=Object.entries(l).reduce((e,[t,r])=>`${e}${t}=${r},`,"");if(function(e=G()){var t;return l0(e)&&!!(null==(t=window.navigator)?void 0:t.standalone)}(u)&&"_self"!==a){var h,d;let e,r;return h=t||"",d=a,(e=document.createElement("a")).href=h,e.target=d,(r=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r),new cF(null)}let f=window.open(t||"",a,c);ln(f,e,"popup-blocked");try{f.focus()}catch(e){}return new cF(f)}(e,a,u0())}async _openRedirect(e,t,r,n){var i;return await this._originValidation(e),i=await cB(e,t,r,ls(),n),u2().location.href=i,new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){var r;let{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(r="If manager is not set, promise should be",n||li(r),n)}let n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){let t=await cU(e),r=new cT(e);return t.register("authEvent",t=>(ln(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:r.onEvent(t.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(c$,{type:c$},r=>{var n;let i=null==(n=null==r?void 0:r[0])?void 0:n[c$];void 0!==i&&t(!!i),a7(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=cR(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return l1()||lW()||l0()}};var cq="@firebase/auth",cH="1.10.7";class cG{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null==(e=this.auth.currentUser)?void 0:e.uid)||null}async getToken(e){return(this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser)?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ln(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}let cK=V("authIdTokenMaxAge")||300,cW=null;function cQ(e=eX()){let t=eF(e,"auth");if(t.isInitialized())return t.getImmediate();let r=function(e,t){let r=eF(e,"auth");if(r.isInitialized()){let e=r.getImmediate();if(X(r.getOptions(),null!=t?t:{}))return e;a7(e,"already-initialized")}return r.initialize({options:t})}(e,{popupRedirectResolver:cz,persistence:[ci,uX,uJ]}),n=V("authTokenSyncURL");if(n&&"boolean"==typeof isSecureContext&&isSecureContext){let e=new URL(n,location.origin);if(location.origin===e.origin){let t,n=(t=e.toString(),async e=>{let r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>cK)return;let i=null==r?void 0:r.token;cW!==i&&(cW=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});ei(r).beforeAuthStateChanged(n,()=>n(r.currentUser)),ei(r).onIdTokenChanged(e=>n(e),void 0,void 0)}}let i=L("auth");return i&&function(e,t,r){let n=ei(e);ln(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");let i=ua(t),{host:s,port:o}=function(e){let t=ua(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};let n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){let e=i[1];return{host:e,port:ul(n.substr(e.length+1))}}{let[e,t]=n.split(":");return{host:e,port:ul(t)}}}(t),a=null===o?"":`:${o}`,l={url:`${i}//${s}${a}/`},u=Object.freeze({host:s,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:!1})});if(!n._canInitEmulator){ln(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ln(X(l,n.config.emulator)&&X(u,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=l,n.emulatorConfig=u,n.settings.appVerificationDisabledForTesting=!0,j(s)?(B(`${i}//${s}${a}`),H("Auth",!0)):function(){function e(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(r,`http://${i}`),r}l7={loadJS:e=>new Promise((t,r)=>{var n,i;let s=document.createElement("script");s.setAttribute("src",e),s.onload=t,s.onerror=e=>{let t=a9("internal-error");t.customData=e,r(t)},s.type="text/javascript",s.charset="UTF-8",(null!=(i=null==(n=document.getElementsByTagName("head"))?void 0:n[0])?i:document).appendChild(s)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},a="Browser",eV(new es("auth",(e,{options:t})=>{let r,n,i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=i.options;ln(l&&!l.includes(":"),"invalid-api-key",{appName:i.name});let c=new l4(i,s,o,{apiKey:l,authDomain:u,clientPlatform:a,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:l2(a)});return n=(Array.isArray(r=(null==t?void 0:t.persistence)||[])?r:[r]).map(l$),(null==t?void 0:t.errorMap)&&c._updateErrorMap(t.errorMap),c._initializeWithPersistence(n,null==t?void 0:t.popupRedirectResolver),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),eV(new es("auth-internal",e=>new cG(ei(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),e0(cq,cH,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(a)),e0(cq,cH,"esm2017"),e.s([],5731),e.s([],51718),e.i(5731),e.s(["GoogleAuthProvider",()=>uA,"createUserWithEmailAndPassword",()=>uq,"getAuth",()=>cQ,"onAuthStateChanged",()=>uG,"signInWithEmailAndPassword",()=>uH,"signInWithPopup",()=>cy,"signOut",()=>uK],41264);let cY=eJ().length?eX():eQ({projectId:"studio-7242952701-d91b7",appId:"1:38049613185:web:e22afec7ccf8ef0e4c1480",apiKey:"AIzaSyDNbU6GsF43hHVbfuNJprugyB9_q4gSit0",authDomain:"studio-7242952701-d91b7.firebaseapp.com",messagingSenderId:"38049613185"}),cX=o1(cY);!function(e=eX(),t){let r=eF(e=ei(e),a0).getImmediate({identifier:void 0}),n=M("storage");n&&function(e,t,r,n={}){!function(e,t,r,n={}){e.host=`${t}:${r}`;let i=j(t);i&&(B(`https://${e.host}/b`),H("Storage",!0)),e._isUsingEmulator=!0,e._protocol=i?"https":"http";let{mockUserToken:s}=n;s&&(e._overrideAuthToken="string"==typeof s?s:$(s,e.app.options.projectId))}(e,t,r,n)}(r,...n)}(cY);let cJ=cQ(cY);e.s(["auth",()=>cJ,"db",()=>cX],30450)},18621,e=>{"use strict";var t=e.i(43476),r=e.i(71645),n=e.i(26683);let i=r.forwardRef(({className:e,type:r,...i},s)=>(0,t.jsx)("input",{type:r,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...i}));i.displayName="Input",e.s(["Input",()=>i])},79473,e=>{"use strict";let t=e=>r=>{try{let n=e(r);if(n instanceof Promise)return n;return{then:e=>t(e)(n),catch(e){return this}}}catch(e){return{then(e){return this},catch:r=>t(r)(e)}}},r=(e,r)=>(n,i,s)=>{let o,a={storage:function(e,t){let r;try{r=e()}catch(e){return}return{getItem:e=>{var t;let n=e=>null===e?null:JSON.parse(e,void 0),i=null!=(t=r.getItem(e))?t:null;return i instanceof Promise?i.then(n):n(i)},setItem:(e,t)=>r.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>r.removeItem(e)}}(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...r},l=!1,u=new Set,c=new Set,h=a.storage;if(!h)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),n(...e)},i,s);let d=()=>{let e=a.partialize({...i()});return h.setItem(a.name,{state:e,version:a.version})},f=s.setState;s.setState=(e,t)=>(f(e,t),d());let p=e((...e)=>(n(...e),d()),i,s);s.getInitialState=()=>p;let g=()=>{var e,r;if(!h)return;l=!1,u.forEach(e=>{var t;return e(null!=(t=i())?t:p)});let s=(null==(r=a.onRehydrateStorage)?void 0:r.call(a,null!=(e=i())?e:p))||void 0;return t(h.getItem.bind(h))(a.name).then(e=>{if(e)if("number"!=typeof e.version||e.version===a.version)return[!1,e.state];else{if(a.migrate){let t=a.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var t;let[r,s]=e;if(n(o=a.merge(s,null!=(t=i())?t:p),!0),r)return d()}).then(()=>{null==s||s(o,void 0),o=i(),l=!0,c.forEach(e=>e(o))}).catch(e=>{null==s||s(void 0,e)})};return s.persist={setOptions:e=>{a={...a,...e},e.storage&&(h=e.storage)},clearStorage:()=>{null==h||h.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>g(),hasHydrated:()=>l,onHydrate:e=>(u.add(e),()=>{u.delete(e)}),onFinishHydration:e=>(c.add(e),()=>{c.delete(e)})},a.skipHydration||g(),o||p};e.s(["persist",()=>r])},66879,e=>{"use strict";e.s(["useTimerStore",()=>eW],66879);var t,r,n,i=e.i(68834);class s{constructor(e){this._process=e,this._active=!1,this._current=null,this._last=null}start(){this._active=!0,this.flush()}clear(){this._current&&(this._current.next=null,this._last=this._current)}enqueue(e){let t={value:e,next:null};if(this._current){this._last.next=t,this._last=t;return}this._current=t,this._last=t,this._active&&this.flush()}flush(){for(;this._current;){let e=this._current;this._process(e.value),this._current=e.next}this._last=null}}let o="xstate.init",a="xstate.stop";function l(e,t){return{type:`xstate.done.state.${e}`,output:t}}function u(e,t){return{type:`xstate.error.actor.${e}`,error:t,actorId:e}}function c(e){return{type:o,input:e}}function h(e){setTimeout(()=>{throw e})}let d="function"==typeof Symbol&&Symbol.observable||"@@observable";function f(e){if(v(e))return e;let t=[],r="";for(let n=0;n<e.length;n++){switch(e.charCodeAt(n)){case 92:r+=e[n+1],n++;continue;case 46:t.push(r),r="";continue}r+=e[n]}return t.push(r),t}function p(e){var t;return(t=e)&&"object"==typeof t&&"machine"in t&&"value"in t?e.value:"string"!=typeof e?e:function(e){if(1===e.length)return e[0];let t={},r=t;for(let t=0;t<e.length-1;t++)if(t===e.length-2)r[e[t]]=e[t+1];else{let n=r;r={},n[e[t]]=r}return t}(f(e))}function g(e,t){let r={},n=Object.keys(e);for(let i=0;i<n.length;i++){let s=n[i];r[s]=t(e[s],s,e,i)}return r}function m(e){var t;return void 0===e?[]:v(t=e)?t:[t]}function y(e,t,r,n){return"function"==typeof e?e({context:t,event:r,self:n}):e}function v(e){return Array.isArray(e)}function w(e){var t;return(v(t=e)?t:[t]).map(e=>void 0===e||"string"==typeof e?{target:e}:e)}function b(e){if(void 0!==e&&""!==e)return m(e)}function _(e,t,r){let n="object"==typeof e,i=n?e:void 0;return{next:(n?e.next:e)?.bind(i),error:(n?e.error:t)?.bind(i),complete:(n?e.complete:r)?.bind(i)}}function E(e,t){let r=t.match(/^xstate\.invoke\.(\d+)\.(.*)/);if(!r)return e.implementations.actors[t];let[,n,i]=r,s=e.getStateNodeById(i).config.invoke;return(Array.isArray(s)?s[n]:s).src}function I(e,t){return`${e.sessionId}.${t}`}let T=0,S=!1,C=((t={})[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped",t),k={clock:{setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e)},logger:console.log.bind(console),devTools:!1};class A{constructor(e,t){this.logic=e,this._snapshot=void 0,this.clock=void 0,this.options=void 0,this.id=void 0,this.mailbox=new s(this._process.bind(this)),this.observers=new Set,this.eventListeners=new Map,this.logger=void 0,this._processingStatus=C.NotStarted,this._parent=void 0,this._syncSnapshot=void 0,this.ref=void 0,this._actorScope=void 0,this.systemId=void 0,this.sessionId=void 0,this.system=void 0,this._doneEvent=void 0,this.src=void 0,this._deferred=[];const r={...k,...t},{clock:n,logger:i,parent:o,syncSnapshot:a,id:l,systemId:u,inspect:c}=r;this.system=o?o.system:function(e,t){let r=new Map,n=new Map,i=new WeakMap,s=new Set,o={},{clock:a,logger:l}=t,u={schedule:(e,t,r,n,i=Math.random().toString(36).slice(2))=>{let s={source:e,target:t,event:r,delay:n,id:i,startedAt:Date.now()},l=I(e,i);c._snapshot._scheduledEvents[l]=s;let u=a.setTimeout(()=>{delete o[l],delete c._snapshot._scheduledEvents[l],c._relay(e,t,r)},n);o[l]=u},cancel:(e,t)=>{let r=I(e,t),n=o[r];delete o[r],delete c._snapshot._scheduledEvents[r],void 0!==n&&a.clearTimeout(n)},cancelAll:e=>{for(let t in c._snapshot._scheduledEvents){let r=c._snapshot._scheduledEvents[t];r.source===e&&u.cancel(e,r.id)}}},c={_snapshot:{_scheduledEvents:(t?.snapshot&&t.snapshot.scheduler)??{}},_bookId:()=>`x:${T++}`,_register:(e,t)=>(r.set(e,t),e),_unregister:e=>{r.delete(e.sessionId);let t=i.get(e);void 0!==t&&(n.delete(t),i.delete(e))},get:e=>n.get(e),getAll:()=>Object.fromEntries(n.entries()),_set:(e,t)=>{let r=n.get(e);if(r&&r!==t)throw Error(`Actor with system ID '${e}' already exists.`);n.set(e,t),i.set(t,e)},inspect:e=>{let t=_(e);return s.add(t),{unsubscribe(){s.delete(t)}}},_sendInspectionEvent:t=>{if(!s.size)return;let r={...t,rootId:e.sessionId};s.forEach(e=>e.next?.(r))},_relay:(e,t,r)=>{c._sendInspectionEvent({type:"@xstate.event",sourceRef:e,actorRef:t,event:r}),t._send(r)},scheduler:u,getSnapshot:()=>({_scheduledEvents:{...c._snapshot._scheduledEvents}}),start:()=>{let e=c._snapshot._scheduledEvents;for(let t in c._snapshot._scheduledEvents={},e){let{source:r,target:n,event:i,delay:s,id:o}=e[t];u.schedule(r,n,i,s,o)}},_clock:a,_logger:l};return c}(this,{clock:n,logger:i}),c&&!o&&this.system.inspect(_(c)),this.sessionId=this.system._bookId(),this.id=l??this.sessionId,this.logger=t?.logger??this.system._logger,this.clock=t?.clock??this.system._clock,this._parent=o,this._syncSnapshot=a,this.options=r,this.src=r.src??e,this.ref=this,this._actorScope={self:this,id:this.id,sessionId:this.sessionId,logger:this.logger,defer:e=>{this._deferred.push(e)},system:this.system,stopChild:e=>{if(e._parent!==this)throw Error(`Cannot stop child actor ${e.id} of ${this.id} because it is not a child`);e._stop()},emit:e=>{let t=this.eventListeners.get(e.type),r=this.eventListeners.get("*");if(t||r)for(let n of[...t?t.values():[],...r?r.values():[]])try{n(e)}catch(e){h(e)}},actionExecutor:e=>{let t=()=>{if(this._actorScope.system._sendInspectionEvent({type:"@xstate.action",actorRef:this,action:{type:e.type,params:e.params}}),!e.exec)return;let t=S;try{S=!0,e.exec(e.info,e.params)}finally{S=t}};this._processingStatus===C.Running?t():this._deferred.push(t)}},this.send=this.send.bind(this),this.system._sendInspectionEvent({type:"@xstate.actor",actorRef:this}),u&&(this.systemId=u,this.system._set(u,this)),this._initState(t?.snapshot??t?.state),u&&"active"!==this._snapshot.status&&this.system._unregister(this)}_initState(e){try{this._snapshot=e?this.logic.restoreSnapshot?this.logic.restoreSnapshot(e,this._actorScope):e:this.logic.getInitialSnapshot(this._actorScope,this.options?.input)}catch(e){this._snapshot={status:"error",output:void 0,error:e}}}update(e,t){let r;for(this._snapshot=e;r=this._deferred.shift();)try{r()}catch(t){this._deferred.length=0,this._snapshot={...e,status:"error",error:t}}switch(this._snapshot.status){case"active":for(let t of this.observers)try{t.next?.(e)}catch(e){h(e)}break;case"done":var n;for(let t of this.observers)try{t.next?.(e)}catch(e){h(e)}this._stopProcedure(),this._complete(),this._doneEvent=(n=this.id,{type:`xstate.done.actor.${n}`,output:this._snapshot.output,actorId:n}),this._parent&&this.system._relay(this,this._parent,this._doneEvent);break;case"error":this._error(this._snapshot.error)}this.system._sendInspectionEvent({type:"@xstate.snapshot",actorRef:this,event:t,snapshot:e})}subscribe(e,t,r){let n=_(e,t,r);if(this._processingStatus!==C.Stopped)this.observers.add(n);else switch(this._snapshot.status){case"done":try{n.complete?.()}catch(e){h(e)}break;case"error":{let e=this._snapshot.error;if(n.error)try{n.error(e)}catch(e){h(e)}else h(e)}}return{unsubscribe:()=>{this.observers.delete(n)}}}on(e,t){let r=this.eventListeners.get(e);r||(r=new Set,this.eventListeners.set(e,r));let n=t.bind(void 0);return r.add(n),{unsubscribe:()=>{r.delete(n)}}}start(){if(this._processingStatus===C.Running)return this;this._syncSnapshot&&this.subscribe({next:e=>{"active"===e.status&&this.system._relay(this,this._parent,{type:`xstate.snapshot.${this.id}`,snapshot:e})},error:()=>{}}),this.system._register(this.sessionId,this),this.systemId&&this.system._set(this.systemId,this),this._processingStatus=C.Running;let e=c(this.options.input);switch(this.system._sendInspectionEvent({type:"@xstate.event",sourceRef:this._parent,actorRef:this,event:e}),this._snapshot.status){case"done":return this.update(this._snapshot,e),this;case"error":return this._error(this._snapshot.error),this}if(this._parent||this.system.start(),this.logic.start)try{this.logic.start(this._snapshot,this._actorScope)}catch(e){return this._snapshot={...this._snapshot,status:"error",error:e},this._error(e),this}return this.update(this._snapshot,e),this.options.devTools&&this.attachDevTools(),this.mailbox.start(),this}_process(e){let t,r;try{t=this.logic.transition(this._snapshot,e,this._actorScope)}catch(e){r={err:e}}if(r){let{err:e}=r;this._snapshot={...this._snapshot,status:"error",error:e},this._error(e);return}this.update(t,e),e.type===a&&(this._stopProcedure(),this._complete())}_stop(){return this._processingStatus===C.Stopped||((this.mailbox.clear(),this._processingStatus===C.NotStarted)?this._processingStatus=C.Stopped:this.mailbox.enqueue({type:a})),this}stop(){if(this._parent)throw Error("A non-root actor cannot be stopped directly.");return this._stop()}_complete(){for(let e of this.observers)try{e.complete?.()}catch(e){h(e)}this.observers.clear()}_reportError(e){if(!this.observers.size){this._parent||h(e);return}let t=!1;for(let r of this.observers){let n=r.error;t||=!n;try{n?.(e)}catch(e){h(e)}}this.observers.clear(),t&&h(e)}_error(e){this._stopProcedure(),this._reportError(e),this._parent&&this.system._relay(this,this._parent,u(this.id,e))}_stopProcedure(){return this._processingStatus!==C.Running||(this.system.scheduler.cancelAll(this),this.mailbox.clear(),this.mailbox=new s(this._process.bind(this)),this._processingStatus=C.Stopped,this.system._unregister(this)),this}_send(e){this._processingStatus!==C.Stopped&&this.mailbox.enqueue(e)}send(e){this.system._relay(void 0,this,e)}attachDevTools(){let{devTools:t}=this.options;t&&("function"==typeof t?t:t=>{if("undefined"==typeof window)return;let r=function(){let t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:e.g;if(t.__xstate__)return t.__xstate__}();r&&r.register(t)})(this)}toJSON(){return{xstate$$type:1,id:this.id}}getPersistedSnapshot(e){return this.logic.getPersistedSnapshot(this._snapshot,e)}[d](){return this}getSnapshot(){return this._snapshot}}function x(e,...[t]){return new A(e,t)}function R(e,t,r,n,{sendId:i}){return[t,{sendId:"function"==typeof i?i(r,n):i},void 0]}function N(e,t){e.defer(()=>{e.system.scheduler.cancel(e.self,t.sendId)})}function O(e){function t(e,t){}return t.type="xstate.cancel",t.sendId=e,t.resolve=R,t.execute=N,t}function D(e,t,r,n,{id:i,systemId:s,src:o,input:a,syncSnapshot:l}){let u,c,h="string"==typeof o?E(t.machine,o):o,d="function"==typeof i?i(r):i;return h&&(c="function"==typeof a?a({context:t.context,event:r.event,self:e.self}):a,u=x(h,{id:d,src:o,parent:e.self,syncSnapshot:l,systemId:s,input:c})),[eb(t,{children:{...t.children,[d]:u}}),{id:i,systemId:s,actorRef:u,src:o,input:c},void 0]}function P(e,{actorRef:t}){t&&e.defer(()=>{t._processingStatus!==C.Stopped&&t.start()})}function L(...[e,{id:t,systemId:r,input:n,syncSnapshot:i=!1}={}]){function s(e,t){}return s.type="xstate.spawnChild",s.id=t,s.systemId=r,s.src=e,s.input=n,s.syncSnapshot=i,s.resolve=D,s.execute=P,s}function M(e,t,r,n,{actorRef:i}){let s="function"==typeof i?i(r,n):i,o="string"==typeof s?t.children[s]:s,a=t.children;return o&&(a={...a},delete a[o.id]),[eb(t,{children:a}),o,void 0]}function U(e,t){if(t){if(e.system._unregister(t),t._processingStatus!==C.Running)return void e.stopChild(t);e.defer(()=>{e.stopChild(t)})}}function V(e){function t(e,t){}return t.type="xstate.stopChild",t.actorRef=e,t.resolve=M,t.execute=U,t}function F(e,t,r,n){let{machine:i}=n,s="function"==typeof e,o=s?e:i.implementations.guards["string"==typeof e?e:e.type];if(!s&&!o)throw Error(`Guard '${"string"==typeof e?e:e.type}' is not implemented.'.`);if("function"!=typeof o)return F(o,t,r,n);let a={context:t,event:r},l=s||"string"==typeof e?void 0:"params"in e?"function"==typeof e.params?e.params({context:t,event:r}):e.params:void 0;return"check"in o?o.check(n,a,o):o(a,l)}let j=e=>"atomic"===e.type||"final"===e.type;function B(e){return Object.values(e.states).filter(e=>"history"!==e.type)}function $(e,t){let r=[];if(t===e)return r;let n=e.parent;for(;n&&n!==t;)r.push(n),n=n.parent;return r}function z(e){let t=new Set(e),r=q(t);for(let e of t)if("compound"!==e.type||r.get(e)&&r.get(e).length){if("parallel"===e.type){for(let r of B(e))if("history"!==r.type&&!t.has(r))for(let e of X(r))t.add(e)}}else X(e).forEach(e=>t.add(e));for(let e of t){let r=e.parent;for(;r;)t.add(r),r=r.parent}return t}function q(e){let t=new Map;for(let r of e)t.has(r)||t.set(r,[]),r.parent&&(t.has(r.parent)||t.set(r.parent,[]),t.get(r.parent).push(r));return t}function H(e,t){return function e(t,r){let n=r.get(t);if(!n)return{};if("compound"===t.type){let e=n[0];if(!e)return{};if(j(e))return e.key}let i={};for(let t of n)i[t.key]=e(t,r);return i}(e,q(z(t)))}function G(e,t){return"compound"===t.type?B(t).some(t=>"final"===t.type&&e.has(t)):"parallel"===t.type?B(t).every(t=>G(e,t)):"final"===t.type}let K=e=>"#"===e[0];function W(e,t,r){let n=b(r.target),i=r.reenter??!1,s=function(e,t){if(void 0!==t)return t.map(t=>{if("string"!=typeof t)return t;if(K(t))return e.machine.getStateNodeById(t);let r="."===t[0];if(r&&!e.parent)return ee(e,t.slice(1));let n=r?e.key+t:t;if(e.parent)try{return ee(e.parent,n)}catch(t){throw Error(`Invalid transition definition for state node '${e.id}':
${t.message}`)}throw Error(`Invalid target: "${t}" is not a valid target from the root node. Did you mean ".${t}"?`)})}(e,n),o={...r,actions:m(r.actions),guard:r.guard,target:s,source:e,reenter:i,eventType:t,toJSON:()=>({...o,source:`#${e.id}`,target:s?s.map(e=>`#${e.id}`):void 0})};return o}function Q(e){let t=b(e.config.target);return t?{target:t.map(t=>"string"==typeof t?ee(e.parent,t):t)}:e.parent.initial}function Y(e){return"history"===e.type}function X(e){let t=J(e);for(let r of t)for(let n of $(r,e))t.add(n);return t}function J(e){let t=new Set;return!function e(r){if(!t.has(r)){if(t.add(r),"compound"===r.type)e(r.initial.target[0]);else if("parallel"===r.type)for(let t of B(r))e(t)}}(e),t}function Z(e,t){if(K(t))return e.machine.getStateNodeById(t);if(!e.states)throw Error(`Unable to retrieve child state '${t}' from '${e.id}'; no child states exist.`);let r=e.states[t];if(!r)throw Error(`Child state '${t}' does not exist on '${e.id}'`);return r}function ee(e,t){if("string"==typeof t&&K(t))try{return e.machine.getStateNodeById(t)}catch{}let r=f(t).slice(),n=e;for(;r.length;){let e=r.shift();if(!e.length)break;n=Z(n,e)}return n}function et(e,t){if("string"==typeof t){let r=e.states[t];if(!r)throw Error(`State '${t}' does not exist on '${e.id}'`);return[e,r]}let r=Object.keys(t),n=r.map(t=>Z(e,t)).filter(Boolean);return[e.machine.root,e].concat(n,r.reduce((r,n)=>{let i=Z(e,n);if(!i)return r;let s=et(i,t[n]);return r.concat(s)},[]))}function er(e,t){let r=e;for(;r.parent&&r.parent!==t;)r=r.parent;return r.parent===t}function en(e,t,r){let n=new Set;for(let i of e){let e=!1,s=new Set;for(let o of n)if(function(e,t){let r=new Set(e),n=new Set(t);for(let e of r)if(n.has(e))return!0;for(let e of n)if(r.has(e))return!0;return!1}(eo([i],t,r),eo([o],t,r)))if(er(i.source,o.source))s.add(o);else{e=!0;break}if(!e){for(let e of s)n.delete(e);n.add(i)}}return Array.from(n)}function ei(e,t){if(!e.target)return[];let r=new Set;for(let n of e.target)if(Y(n))if(t[n.id])for(let e of t[n.id])r.add(e);else for(let e of ei(Q(n),t))r.add(e);else r.add(n);return[...r]}function es(e,t){let r=ei(e,t);if(!r)return;if(!e.reenter&&r.every(t=>t===e.source||er(t,e.source)))return e.source;let n=function(e){let[t,...r]=e;for(let e of $(t,void 0))if(r.every(t=>er(t,e)))return e}(r.concat(e.source));return n||(e.reenter?void 0:e.source.machine.root)}function eo(e,t,r){let n=new Set;for(let i of e)if(i.target?.length){let e=es(i,r);for(let r of(i.reenter&&i.source===e&&n.add(e),t))er(r,e)&&n.add(r)}return[...n]}function ea(e,t,r,n,i,s){if(!e.length)return t;let o=new Set(t._nodes),a=t.historyValue,u=en(e,o,a),c=t;i||([c,a]=function(e,t,r,n,i,s,o,a){let l,u=e,c=eo(n,i,s);for(let e of(c.sort((e,t)=>t.order-e.order),c))for(let t of function(e){return Object.keys(e.states).map(t=>e.states[t]).filter(e=>"history"===e.type)}(e)){let r;r="deep"===t.history?t=>j(t)&&er(t,e):t=>t.parent===e,(l??={...s})[t.id]=Array.from(i).filter(r)}for(let e of c)u=ec(u,t,r,[...e.exit,...e.invoke.map(e=>V(e.id))],o,void 0),i.delete(e);return[u,l||s]}(c,n,r,u,o,a,s,r.actionExecutor)),c=function(e,t,r,n,i,s,o,a){let u=e,c=new Set,h=new Set;(function(e,t,r,n){for(let i of e){let e=es(i,t);for(let s of i.target||[])!Y(s)&&(i.source!==s||i.source!==e||i.reenter)&&(n.add(s),r.add(s)),el(s,t,r,n);for(let s of ei(i,t)){let o=$(s,e);e?.type==="parallel"&&o.push(e),eu(n,t,r,o,!i.source.parent&&i.reenter?void 0:e)}}})(n,o,h,c),a&&h.add(e.machine.root);let d=new Set;for(let e of[...c].sort((e,t)=>e.order-t.order)){i.add(e);let n=[];for(let t of(n.push(...e.entry),e.invoke))n.push(L(t.src,{...t,syncSnapshot:!!t.onSnapshot}));if(h.has(e)){let t=e.initial.actions;n.push(...t)}if(u=ec(u,t,r,n,s,e.invoke.map(e=>e.id)),"final"===e.type){let n=e.parent,o=n?.type==="parallel"?n:n?.parent,a=o||e;for(n?.type==="compound"&&s.push(l(n.id,void 0!==e.output?y(e.output,u.context,t,r.self):void 0));o?.type==="parallel"&&!d.has(o)&&G(i,o);)d.add(o),s.push(l(o.id)),a=o,o=o.parent;if(o)continue;u=eb(u,{status:"done",output:function(e,t,r,n,i){if(void 0===n.output)return;let s=l(i.id,void 0!==i.output&&i.parent?y(i.output,e.context,t,r.self):void 0);return y(n.output,e.context,s,r.self)}(u,t,r,u.machine.root,a)})}}return u}(c=ec(c,n,r,u.flatMap(e=>e.actions),s,void 0),n,r,u,o,s,a,i);let h=[...o];"done"===c.status&&(c=ec(c,n,r,h.sort((e,t)=>t.order-e.order).flatMap(e=>e.exit),s,void 0));try{if(a===t.historyValue&&function(e,t){if(e.length!==t.size)return!1;for(let r of e)if(!t.has(r))return!1;return!0}(t._nodes,o))return c;return eb(c,{_nodes:h,historyValue:a})}catch(e){throw e}}function el(e,t,r,n){var i,s,o,a;if(Y(e))if(t[e.id]){let o=t[e.id];for(let e of o)n.add(e),el(e,t,r,n);for(let a of o){i=a,s=e.parent,eu(n,t,r,$(i,s))}}else{let i=Q(e);for(let s of i.target)n.add(s),i===e.parent?.initial&&r.add(e.parent),el(s,t,r,n);for(let s of i.target){o=s,a=e.parent,eu(n,t,r,$(o,a))}}else if("compound"===e.type){let[i]=e.initial.target;Y(i)||(n.add(i),r.add(i)),el(i,t,r,n),eu(n,t,r,$(i,e))}else if("parallel"===e.type)for(let i of B(e).filter(e=>!Y(e)))[...n].some(e=>er(e,i))||(Y(i)||(n.add(i),r.add(i)),el(i,t,r,n))}function eu(e,t,r,n,i){for(let s of n)if((!i||er(s,i))&&e.add(s),"parallel"===s.type)for(let n of B(s).filter(e=>!Y(e)))[...e].some(e=>er(e,n))||(e.add(n),el(n,t,r,e))}function ec(e,t,r,n,i,s){let o=s?[]:void 0,a=function e(t,r,n,i,s,o){let{machine:a}=t,l=t;for(let t of i){var u;let i="function"==typeof t,c=i?t:(u="string"==typeof t?t:t.type,a.implementations.actions[u]),h={context:l.context,event:r,self:n.self,system:n.system},d=i||"string"==typeof t?void 0:"params"in t?"function"==typeof t.params?t.params({context:l.context,event:r}):t.params:void 0;if(!c||!("resolve"in c)){n.actionExecutor({type:"string"==typeof t?t:"object"==typeof t?t.type:t.name||"(anonymous)",info:h,params:d,exec:c});continue}let[f,p,g]=c.resolve(n,l,h,d,c,s);l=f,"retryResolve"in c&&o?.push([c,p]),"execute"in c&&n.actionExecutor({type:c.type,info:h,params:p,exec:c.execute.bind(null,n,p)}),g&&(l=e(l,r,n,g,s,o))}return l}(e,t,r,n,{internalQueue:i,deferredActorIds:s},o);return o?.forEach(([e,t])=>{e.retryResolve(r,a,t)}),a}function eh(e,t,r,n){let i=e,s=[];function l(e,t,n){r.system._sendInspectionEvent({type:"@xstate.microstep",actorRef:r.self,event:t,snapshot:e,_transitions:n}),s.push(e)}if(t.type===a)return l(i=eb(ed(i,t,r),{status:"stopped"}),t,[]),{snapshot:i,microstates:s};let u=t;if(u.type!==o){let t=u,o=t.type.startsWith("xstate.error.actor"),a=ef(t,i);if(o&&!a.length)return l(i=eb(e,{status:"error",error:t.error}),t,[]),{snapshot:i,microstates:s};l(i=ea(a,e,r,u,!1,n),t,a)}let c=!0;for(;"active"===i.status;){let e=c?function(e,t){let r=new Set;for(let n of e._nodes.filter(j))r:for(let i of[n].concat($(n,void 0)))if(i.always){for(let n of i.always)if(void 0===n.guard||F(n.guard,e.context,t,e)){r.add(n);break r}}return en(Array.from(r),new Set(e._nodes),e.historyValue)}(i,u):[],t=e.length?i:void 0;if(!e.length){if(!n.length)break;e=ef(u=n.shift(),i)}c=(i=ea(e,i,r,u,!1,n))!==t,l(i,u,e)}return"active"!==i.status&&ed(i,u,r),{snapshot:i,microstates:s}}function ed(e,t,r){return ec(e,t,r,Object.values(e.children).map(e=>V(e)),[],void 0)}function ef(e,t){return t.machine.getTransitionData(t,e)}let ep=function(e){return function e(t,r){let n=p(t),i=p(r);return"string"==typeof i?"string"==typeof n&&i===n:"string"==typeof n?n in i:Object.keys(n).every(t=>t in i&&e(n[t],i[t]))}(e,this.value)},eg=function(e){return this.tags.has(e)},em=function(e){let t=this.machine.getTransitionData(this,e);return!!t?.length&&t.some(e=>void 0!==e.target||e.actions.length)},ey=function(){let{_nodes:e,tags:t,machine:r,getMeta:n,toJSON:i,can:s,hasTag:o,matches:a,...l}=this;return{...l,tags:Array.from(t)}},ev=function(){return this._nodes.reduce((e,t)=>(void 0!==t.meta&&(e[t.id]=t.meta),e),{})};function ew(e,t){return{status:e.status,output:e.output,error:e.error,machine:t,context:e.context,_nodes:e._nodes,value:H(t.root,e._nodes),tags:new Set(e._nodes.flatMap(e=>e.tags)),children:e.children,historyValue:e.historyValue||{},matches:ep,hasTag:eg,can:em,getMeta:ev,toJSON:ey}}function eb(e,t={}){return ew({...e,...t},e.machine)}function e_(e,t,r,n,{event:i,id:s,delay:o},{internalQueue:a}){let l,u=t.machine.implementations.delays;if("string"==typeof i)throw Error(`Only event objects may be used with raise; use raise({ type: "${i}" }) instead`);let c="function"==typeof i?i(r,n):i;if("string"==typeof o){let e=u&&u[o];l="function"==typeof e?e(r,n):e}else l="function"==typeof o?o(r,n):o;return"number"!=typeof l&&a.push(c),[t,{event:c,id:s,delay:l},void 0]}function eE(e,t){let{event:r,delay:n,id:i}=t;if("number"==typeof n)return void e.defer(()=>{let t=e.self;e.system.scheduler.schedule(t,t,r,n,i)})}function eI(e,t){function r(e,t){}return r.type="xstate.raise",r.event=e,r.id=t?.id,r.delay=t?.delay,r.resolve=e_,r.execute=eE,r}let eT=new WeakMap;function eS(e,t,r,n,{assignment:i}){if(!t.context)throw Error("Cannot assign to undefined `context`. Ensure that `context` is defined in the machine config.");let s={},o={context:t.context,event:r.event,spawn:function(e,{machine:t,context:r},n,i){return(s,o)=>{let a=((s,o)=>{if("string"!=typeof s)return x(s,{id:o?.id,parent:e.self,syncSnapshot:o?.syncSnapshot,input:o?.input,src:s,systemId:o?.systemId});{let a=E(t,s);if(!a)throw Error(`Actor logic '${s}' not implemented in machine '${t.id}'`);let l=x(a,{id:o?.id,parent:e.self,syncSnapshot:o?.syncSnapshot,input:"function"==typeof o?.input?o.input({context:r,event:n,self:e.self}):o?.input,src:s,systemId:o?.systemId});return i[l.id]=l,l}})(s,o);return i[a.id]=a,e.defer(()=>{a._processingStatus!==C.Stopped&&a.start()}),a}}(e,t,r.event,s),self:e.self,system:e.system},a={};if("function"==typeof i)a=i(o,n);else for(let e of Object.keys(i)){let t=i[e];a[e]="function"==typeof t?t(o,n):t}let l=Object.assign({},t.context,a);return[eb(t,{context:l,children:Object.keys(s).length?{...t.children,...s}:t.children}),void 0,void 0]}function eC(e){function t(e,t){}return t.type="xstate.assign",t.assignment=e,t.resolve=eS,t}new WeakMap;let ek=new WeakMap;function eA(e,t,r){let n=ek.get(e);return n?t in n||(n[t]=r()):(n={[t]:r()},ek.set(e,n)),n[t]}let ex={},eR=e=>"string"==typeof e?{type:e}:"function"==typeof e?"resolve"in e?{type:e.type}:{type:e.name}:e;class eN{constructor(e,t){if(this.config=e,this.key=void 0,this.id=void 0,this.type=void 0,this.path=void 0,this.states=void 0,this.history=void 0,this.entry=void 0,this.exit=void 0,this.parent=void 0,this.machine=void 0,this.meta=void 0,this.output=void 0,this.order=-1,this.description=void 0,this.tags=[],this.transitions=void 0,this.always=void 0,this.parent=t._parent,this.key=t._key,this.machine=t._machine,this.path=this.parent?this.parent.path.concat(this.key):[],this.id=this.config.id||[this.machine.id,...this.path].join("."),this.type=this.config.type||(this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.description=this.config.description,this.order=this.machine.idMap.size,this.machine.idMap.set(this.id,this),this.states=this.config.states?g(this.config.states,(e,t)=>new eN(e,{_parent:this,_key:t,_machine:this.machine})):ex,"compound"===this.type&&!this.config.initial)throw Error(`No initial state specified for compound state node "#${this.id}". Try adding { initial: "${Object.keys(this.states)[0]}" } to the state config.`);this.history=!0===this.config.history?"shallow":this.config.history||!1,this.entry=m(this.config.entry).slice(),this.exit=m(this.config.exit).slice(),this.meta=this.config.meta,this.output="final"!==this.type&&this.parent?void 0:this.config.output,this.tags=m(e.tags).slice()}_initialize(){this.transitions=function(e){let t=new Map;if(e.config.on)for(let r of Object.keys(e.config.on)){if(""===r)throw Error('Null events ("") cannot be specified as a transition key. Use `always: { ... }` instead.');let n=e.config.on[r];t.set(r,w(n).map(t=>W(e,r,t)))}if(e.config.onDone){let r=`xstate.done.state.${e.id}`;t.set(r,w(e.config.onDone).map(t=>W(e,r,t)))}for(let r of e.invoke){if(r.onDone){let n=`xstate.done.actor.${r.id}`;t.set(n,w(r.onDone).map(t=>W(e,n,t)))}if(r.onError){let n=`xstate.error.actor.${r.id}`;t.set(n,w(r.onError).map(t=>W(e,n,t)))}if(r.onSnapshot){let n=`xstate.snapshot.${r.id}`;t.set(n,w(r.onSnapshot).map(t=>W(e,n,t)))}}for(let r of e.after){let e=t.get(r.eventType);e||(e=[],t.set(r.eventType,e)),e.push(r)}return t}(this),this.config.always&&(this.always=w(this.config.always).map(e=>W(this,"",e))),Object.keys(this.states).forEach(e=>{this.states[e]._initialize()})}get definition(){return{id:this.id,key:this.key,version:this.machine.version,type:this.type,initial:this.initial?{target:this.initial.target,source:this,actions:this.initial.actions.map(eR),eventType:null,reenter:!1,toJSON:()=>({target:this.initial.target.map(e=>`#${e.id}`),source:`#${this.id}`,actions:this.initial.actions.map(eR),eventType:null})}:void 0,history:this.history,states:g(this.states,e=>e.definition),on:this.on,transitions:[...this.transitions.values()].flat().map(e=>({...e,actions:e.actions.map(eR)})),entry:this.entry.map(eR),exit:this.exit.map(eR),meta:this.meta,order:this.order||-1,output:this.output,invoke:this.invoke,description:this.description,tags:this.tags}}toJSON(){return this.definition}get invoke(){return eA(this,"invoke",()=>m(this.config.invoke).map((e,t)=>{var r,n;let{src:i,systemId:s}=e,o=e.id??(r=this.id,`${t}.${r}`),a="string"==typeof i?i:`xstate.invoke.${n=this.id,`${t}.${n}`}`;return{...e,src:a,id:o,systemId:s,toJSON(){let{onDone:t,onError:r,...n}=e;return{...n,type:"xstate.invoke",src:a,id:o}}}}))}get on(){return eA(this,"on",()=>[...this.transitions].flatMap(([e,t])=>t.map(t=>[e,t])).reduce((e,[t,r])=>(e[t]=e[t]||[],e[t].push(r),e),{}))}get after(){return eA(this,"delayedTransitions",()=>{var e;let t;return e=this,(t=e.config.after)?Object.keys(t).flatMap(r=>{var n;let i,s,o=t[r],a=Number.isNaN(+r)?r:+r,l=(n=e.id,s=(i={type:`xstate.after.${a}.${n}`}).type,e.entry.push(eI(i,{id:s,delay:a})),e.exit.push(O(s)),s);return m("string"==typeof o?{target:o}:o).map(e=>({...e,event:l,delay:a}))}).map(t=>{let{delay:r}=t;return{...W(e,t.event,t),delay:r}}):[]})}get initial(){return eA(this,"initial",()=>(function(e,t){let r="string"==typeof t?e.states[t]:t?e.states[t.target]:void 0;if(!r&&t)throw Error(`Initial state node "${t}" not found on parent state node #${e.id}`);let n={source:e,actions:t&&"string"!=typeof t?m(t.actions):[],eventType:null,reenter:!1,target:r?[r]:[],toJSON:()=>({...n,source:`#${e.id}`,target:r?[`#${r.id}`]:[]})};return n})(this,this.config.initial))}next(e,t){let r,n=t.type,i=[];for(let s of eA(this,`candidates-${n}`,()=>{var e;return e=this,e.transitions.get(n)||[...e.transitions.keys()].filter(e=>(function(e,t){if(t===e||"*"===t)return!0;if(!t.endsWith(".*"))return!1;let r=t.split("."),n=e.split(".");for(let e=0;e<r.length;e++){let t=r[e],i=n[e];if("*"===t)return e===r.length-1;if(t!==i)return!1}return!0})(n,e)).sort((e,t)=>t.length-e.length).flatMap(t=>e.transitions.get(t))})){let{guard:o}=s,a=e.context,l=!1;try{l=!o||F(o,a,t,e)}catch(t){let e="string"==typeof o?o:"object"==typeof o?o.type:void 0;throw Error(`Unable to evaluate guard ${e?`'${e}' `:""}in transition for event '${n}' in state node '${this.id}':
${t.message}`)}if(l){i.push(...s.actions),r=s;break}}return r?[r]:void 0}get events(){return eA(this,"events",()=>{let{states:e}=this,t=new Set(this.ownEvents);if(e)for(let r of Object.keys(e)){let n=e[r];if(n.states)for(let e of n.events)t.add(`${e}`)}return Array.from(t)})}get ownEvents(){return Array.from(new Set(Object.keys(Object.fromEntries(this.transitions)).filter(e=>this.transitions.get(e).some(e=>!(!e.target&&!e.actions.length&&!e.reenter)))))}}class eO{constructor(e,t){this.config=e,this.version=void 0,this.schemas=void 0,this.implementations=void 0,this.__xstatenode=!0,this.idMap=new Map,this.root=void 0,this.id=void 0,this.states=void 0,this.events=void 0,this.id=e.id||"(machine)",this.implementations={actors:t?.actors??{},actions:t?.actions??{},delays:t?.delays??{},guards:t?.guards??{}},this.version=this.config.version,this.schemas=this.config.schemas,this.transition=this.transition.bind(this),this.getInitialSnapshot=this.getInitialSnapshot.bind(this),this.getPersistedSnapshot=this.getPersistedSnapshot.bind(this),this.restoreSnapshot=this.restoreSnapshot.bind(this),this.start=this.start.bind(this),this.root=new eN(e,{_key:this.id,_machine:this}),this.root._initialize(),this.states=this.root.states,this.events=this.root.events}provide(e){let{actions:t,guards:r,actors:n,delays:i}=this.implementations;return new eO(this.config,{actions:{...t,...e.actions},guards:{...r,...e.guards},actors:{...n,...e.actors},delays:{...i,...e.delays}})}resolveState(e){var t;let r,n=(r=z(et(t=this.root,e.value)),H(t,[...r])),i=z(et(this.root,n));return ew({_nodes:[...i],context:e.context||{},children:{},status:G(i,this.root)?"done":e.status||"active",output:e.output,error:e.error,historyValue:e.historyValue},this)}transition(e,t,r){return eh(e,t,r,[]).snapshot}microstep(e,t,r){return eh(e,t,r,[]).microstates}getTransitionData(e,t){return function e(t,r,n,i){if("string"==typeof r){let e;return(e=Z(t,r).next(n,i))&&e.length?e:t.next(n,i)}if(1===Object.keys(r).length){let s,o;return(o=e(Z(t,(s=Object.keys(r))[0]),r[s[0]],n,i))&&o.length?o:t.next(n,i)}let s=[];for(let o of Object.keys(r)){let a=r[o];if(!a)continue;let l=e(Z(t,o),a,n,i);l&&s.push(...l)}return s.length?s:t.next(n,i)}(this.root,e.value,e,t)||[]}getPreInitialState(e,t,r){let{context:n}=this.config,i=ew({context:"function"!=typeof n&&n?n:{},_nodes:[this.root],children:{},status:"active"},this);return"function"==typeof n?ec(i,t,e,[eC(({spawn:e,event:t,self:r})=>n({spawn:e,input:t.input,self:r}))],r,void 0):i}getInitialSnapshot(e,t){let r=c(t),n=[],i=this.getPreInitialState(e,r,n),{snapshot:s}=eh(ea([{target:[...J(this.root)],source:this.root,reenter:!0,actions:[],eventType:null,toJSON:null}],i,e,r,!0,n),r,e,n);return s}start(e){Object.values(e.children).forEach(e=>{"active"===e.getSnapshot().status&&e.start()})}getStateNodeById(e){let t=f(e),r=t.slice(1),n=K(t[0])?t[0].slice(1):t[0],i=this.idMap.get(n);if(!i)throw Error(`Child state node '#${n}' does not exist on machine '${this.id}'`);return ee(i,r)}get definition(){return this.root.definition}toJSON(){return this.definition}getPersistedSnapshot(e,t){return function(e,t){let{_nodes:r,tags:n,machine:i,children:s,context:o,can:a,hasTag:l,matches:u,getMeta:c,toJSON:h,...d}=e,f={};for(let e in s){let r=s[e];f[e]={snapshot:r.getPersistedSnapshot(t),src:r.src,systemId:r.systemId,syncSnapshot:r._syncSnapshot}}return{...d,context:function e(t){let r;for(let n in t){let i=t[n];if(i&&"object"==typeof i)if("sessionId"in i&&"send"in i&&"ref"in i)(r??=Array.isArray(t)?t.slice():{...t})[n]={xstate$$type:1,id:i.id};else{let s=e(i);s!==i&&((r??=Array.isArray(t)?t.slice():{...t})[n]=s)}}return r??t}(o),children:f,historyValue:function(e){if("object"!=typeof e||null===e)return{};let t={};for(let r in e){let n=e[r];Array.isArray(n)&&(t[r]=n.map(e=>({id:e.id})))}return t}(d.historyValue)}}(e,t)}restoreSnapshot(e,t){let r={},n=e.children;Object.keys(n).forEach(e=>{let i=n[e],s=i.snapshot,o=i.src,a="string"==typeof o?E(this,o):o;if(!a)return;let l=x(a,{id:e,parent:t.self,syncSnapshot:i.syncSnapshot,snapshot:s,src:o,systemId:i.systemId});r[e]=l});let i=function(e,t){if(!t||"object"!=typeof t)return{};let r={};for(let n in t)for(let i of t[n]){let t=function(e,t){if(t instanceof eN)return t;try{return e.machine.getStateNodeById(t.id)}catch{}}(e,i);t&&(r[n]??=[],r[n].push(t))}return r}(this.root,e.historyValue),s=ew({...e,children:r,_nodes:Array.from(z(et(this.root,e.value))),historyValue:i},this),o=new Set;return!function e(t,r){if(!o.has(t))for(let n in o.add(t),t){let i=t[n];if(i&&"object"==typeof i){if("xstate$$type"in i&&1===i.xstate$$type){t[n]=r[i.id];continue}e(i,r)}}}(s.context,r),s}}function eD(e,t,r,n,{event:i}){return[t,{event:"function"==typeof i?i(r,n):i},void 0]}function eP(e,{event:t}){e.defer(()=>e.emit(t))}function eL(e){function t(e,t){}return t.type="xstate.emit",t.event=e,t.resolve=eD,t.execute=eP,t}let eM=((r={}).Parent="#_parent",r.Internal="#_internal",r);function eU(e,t,r,n,{to:i,event:s,id:o,delay:a},l){let u,c,h=t.machine.implementations.delays;if("string"==typeof s)throw Error(`Only event objects may be used with sendTo; use sendTo({ type: "${s}" }) instead`);let d="function"==typeof s?s(r,n):s;if("string"==typeof a){let e=h&&h[a];u="function"==typeof e?e(r,n):e}else u="function"==typeof a?a(r,n):a;let f="function"==typeof i?i(r,n):i;if("string"==typeof f){if(!(c=f===eM.Parent?e.self._parent:f===eM.Internal?e.self:f.startsWith("#_")?t.children[f.slice(2)]:l.deferredActorIds?.includes(f)?f:t.children[f]))throw Error(`Unable to send event to actor '${f}' from machine '${t.machine.id}'.`)}else c=f||e.self;return[t,{to:c,targetId:"string"==typeof f?f:void 0,event:d,id:o,delay:u},void 0]}function eV(e,t,r){"string"==typeof r.to&&(r.to=t.children[r.to])}function eF(e,t){e.defer(()=>{let{to:r,event:n,delay:i,id:s}=t;"number"==typeof i?e.system.scheduler.schedule(e.self,r,n,i,s):e.system._relay(e.self,r,"xstate.error"===n.type?u(e.self.id,n.data):n)})}function ej(e,t,r){function n(e,t){}return n.type="xstate.sendTo",n.to=e,n.event=t,n.id=r?.id,n.delay=r?.delay,n.resolve=eU,n.retryResolve=eV,n.execute=eF,n}function eB(e,t,r,n,{collect:i}){let s=[],o=function(e){s.push(e)};return o.assign=(...e)=>{s.push(eC(...e))},o.cancel=(...e)=>{s.push(O(...e))},o.raise=(...e)=>{s.push(eI(...e))},o.sendTo=(...e)=>{s.push(ej(...e))},o.sendParent=(...e)=>{s.push(function(e,t){return ej(eM.Parent,e,t)}(...e))},o.spawnChild=(...e)=>{s.push(L(...e))},o.stopChild=(...e)=>{s.push(V(...e))},o.emit=(...e)=>{s.push(eL(...e))},i({context:r.context,event:r.event,enqueue:o,check:e=>F(e,t.context,r.event,t),self:e.self,system:e.system},n),[t,void 0,s]}function e$(e){function t(e,t){}return t.type="xstate.enqueueActions",t.collect=e,t.resolve=eB,t}function ez(e,t,r,n,{value:i,label:s}){return[t,{value:"function"==typeof i?i(r,n):i,label:s},void 0]}function eq({logger:e},{value:t,label:r}){r?e(r,t):e(t)}function eH(e=({context:e,event:t})=>({context:e,event:t}),t){function r(e,t){}return r.type="xstate.log",r.value=e,r.label=t,r.resolve=ez,r.execute=eq,r}let eG=(function e({schemas:t,actors:r,actions:n,guards:i,delays:s}){return{assign:eC,sendTo:ej,raise:eI,log:eH,cancel:O,stopChild:V,enqueueActions:e$,emit:eL,spawnChild:L,createStateConfig:e=>e,createAction:e=>e,createMachine:e=>new eO({...e,schemas:t},{actors:r,actions:n,guards:i,delays:s}),extend:o=>e({schemas:t,actors:r,actions:{...n,...o.actions},guards:{...i,...o.guards},delays:{...s,...o.delays}})}})({types:{context:{},events:{},input:{}},actors:{intervalTicker:{config:n=({sendBack:e})=>{let t=setInterval(()=>e({type:"TICK"}),1e3);return()=>clearInterval(t)},start:(e,t)=>{let{self:r,system:i,emit:s}=t,o={receivers:void 0,dispose:void 0};eT.set(r,o),o.dispose=n({input:e.input,system:i,self:r,sendBack:e=>{"stopped"!==r.getSnapshot().status&&r._parent&&i._relay(r,r._parent,e)},receive:e=>{o.receivers??=new Set,o.receivers.add(e)},emit:s})},transition:(e,t,r)=>{let n=eT.get(r.self);return t.type===a?(e={...e,status:"stopped",error:void 0},n.dispose?.()):n.receivers?.forEach(e=>e(t)),e},getInitialSnapshot:(e,t)=>({status:"active",output:void 0,error:void 0,input:t}),getPersistedSnapshot:e=>e,restoreSnapshot:e=>e}},actions:{decrementTime:eC({timeLeft:({context:e})=>e.timeLeft-1}),updateContext:eC({duration:({event:e})=>"duration"in e?e.duration:0,timeLeft:({event:e})=>"duration"in e?e.duration:0})}}).createMachine({id:"flow-timer",initial:"idle",context:({input:e})=>({duration:e.duration,timeLeft:e.duration}),on:{SELECT_PHASE:{target:".running",reenter:!0,actions:"updateContext"},SELECT_CYCLE:{target:".idle",reenter:!0,actions:"updateContext"},STOP_FOR_EDIT:{target:".idle",reenter:!0}},states:{idle:{on:{START:"running"}},running:{invoke:{id:"ticker",src:"intervalTicker"},on:{TICK:{actions:"decrementTime"},PAUSE:"paused"},always:{target:"finished",guard:({context:e})=>e.timeLeft<=0}},paused:{on:{RESUME:"running"}},finished:{}}});var eK=e.i(62962);let eW=(0,i.create)((e,t)=>({timerActor:null,snapshot:null,send:e=>{let{timerActor:r}=t();r?r.send(e):(console.warn("Timer not initialized, cannot send event:",e),t().initializeTimer())},initializeTimer:()=>{if(t().timerActor)return;let{currentCycle:r,currentPhaseIndex:n,playSounds:i}=eK.useCycleStore.getState(),s=r?.phases[n],o=x(eG,{input:{duration:60*(s?.duration??25)}}).start();o.subscribe(t=>{if(e({snapshot:t}),t.matches("finished")){let e=eK.useCycleStore.getState(),{currentCycle:t,currentPhaseIndex:r}=e;if(!t)return void o.send({type:"STOP_FOR_EDIT"});let n=t.phases[r];e.playSounds&&n?.soundFile?.url&&new Audio(n.soundFile.url).play().catch(e=>console.error("Audio play failed:",e));let i=r+1;i>=t.phases.length?(o.send({type:"STOP_FOR_EDIT"}),e.setCurrentPhaseIndex(0)):(t.phases[i],e.setCurrentPhaseIndex(i))}}),e({timerActor:o,snapshot:o.getSnapshot()})},stopTimer:()=>{t().timerActor?.stop(),e({timerActor:null,snapshot:null})}}))},62962,e=>{"use strict";let t;e.s(["useCycleStore",()=>p],62962);var r=e.i(68834),n=e.i(79473);e.i(36180);var i=e.i(17875),s=e.i(30450);let o="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),a=new Uint8Array(16),l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).slice(1));let u=function(e,r,n){if(o&&!r&&!e)return o();var i=e,s=n;let u=(i=i||{}).random??i.rng?.()??function(){if(!t){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");t=crypto.getRandomValues.bind(crypto)}return t(a)}();if(u.length<16)throw Error("Random bytes length must be >= 16");if(u[6]=15&u[6]|64,u[8]=63&u[8]|128,r){if((s=s||0)<0||s+16>r.length)throw RangeError(`UUID byte range ${s}:${s+15} is out of buffer bounds`);for(let e=0;e<16;++e)r[s+e]=u[e];return r}return function(e,t=0){return(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase()}(u)},c={title:"New Phase",duration:10,soundFile:null},h=e=>({id:e.id||u(),name:e.name||"Untitled Cycle",phases:e.phases,isPublic:!0,authorId:"system-official",authorName:"Gemini Focus",likes:0,shares:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),...e}),d=[h({id:"template-meditation",name:"Meditation Training",phases:[{id:"md-b1",title:"Start",duration:1,soundFile:null},{id:"rl-r1",title:"Breath Hold",duration:1,soundFile:null},{id:"md-rec2",title:"Phase 2",duration:2,soundFile:null},{id:"rl-b2",title:"Relax",duration:2,soundFile:null}]}),h({id:"template-pomodoro",name:"Classic Pomodoro",phases:[{id:"p-w1",title:"Work",duration:25,soundFile:null},{id:"p-b1",title:"Short Break",duration:5,soundFile:null},{id:"p-w2",title:"Work",duration:25,soundFile:null},{id:"p-b2",title:"Short Break",duration:5,soundFile:null},{id:"p-w3",title:"Work",duration:25,soundFile:null},{id:"p-b3",title:"Short Break",duration:5,soundFile:null},{id:"p-w4",title:"Work",duration:25,soundFile:null},{id:"p-b4",title:"Long Break",duration:15,soundFile:null}]}),h({id:"template-wimhof",name:"Wim Hof Breathing",phases:[{id:"wh-b1",title:"Power Breathing",duration:1.25,soundFile:null},{id:"wh-r1",title:"Breath Hold",duration:1.5,soundFile:null},{id:"wh-rec1",title:"Recovery Hold",duration:.25,soundFile:null},{id:"wh-b2",title:"Power Breathing",duration:1.25,soundFile:null},{id:"wh-r2",title:"Breath Hold",duration:2,soundFile:null},{id:"wh-rec2",title:"Recovery Hold",duration:.25,soundFile:null},{id:"wh-b3",title:"Power Breathing",duration:1.25,soundFile:null},{id:"wh-r3",title:"Breath Hold",duration:2.5,soundFile:null},{id:"wh-rec3",title:"Recovery Hold",duration:.25,soundFile:null}]})],f={cycles:[],currentCycle:null,currentPhaseIndex:0,isLoading:!0,isGuestMode:!0,userId:null,unsubscribe:null,playSounds:!0},p=(0,r.create)()((0,n.persist)((t,r)=>({...f,loadGuestData:()=>{let r=d.map(e=>({...e,createdAt:new Date}));t({cycles:r,currentCycle:r[0]||null,currentPhaseIndex:0,isLoading:!1,isGuestMode:!0,userId:null});let n=r[0]?.phases[0];n&&e.r(66879).useTimerStore.getState().send({type:"SELECT_CYCLE",duration:60*n.duration,title:n.title})},startSyncCycles:e=>{let{unsubscribe:n}=r();n&&n(),t({isLoading:!0,isGuestMode:!1,userId:e});let o=(0,i.query)((0,i.collection)(s.db,"users",e,"cycles"),(0,i.orderBy)("createdAt","desc")),a=(0,i.onSnapshot)(o,n=>{if(n.empty){console.log("User has no cycles, creating a default one.");let t=d.find(e=>"template-pomodoro"===e.id);if(t){let r={...t,createdAt:(0,i.serverTimestamp)()};delete r.id,delete r.isTemplate,(0,i.addDoc)((0,i.collection)(s.db,"users",e,"cycles"),r)}}else{let e=n.docs.map(e=>({id:e.id,...e.data()})),i=r().currentCycle?.id,s=e.find(e=>e.id===i)||e[0];t({cycles:e,isLoading:!1,currentCycle:s})}},e=>{console.error("Error syncing cycles:",e),t({isLoading:!1})});t({unsubscribe:a})},stopSyncCycles:()=>{r().unsubscribe?.(),t({unsubscribe:null,userId:null}),r().loadGuestData()},setCurrentCycle:n=>{let i=r().cycles.find(e=>e.id===n)||null;t({currentCycle:i,currentPhaseIndex:0});let s=i?.phases[0];s&&e.r(66879).useTimerStore.getState().send({type:"SELECT_CYCLE",duration:60*s.duration})},setCurrentPhaseIndex:n=>{let{currentCycle:i}=r(),s=i?.phases[n];t({currentPhaseIndex:n}),s&&e.r(66879).useTimerStore.getState().send({type:"SELECT_PHASE",duration:60*s.duration})},createNewCycle:async()=>{let{userId:e,isGuestMode:n}=r(),o={name:"My New Cycle",isPublic:!1,authorId:e||"guest",authorName:"Guest",likes:0,shares:0,updatedAt:new Date().toISOString(),phases:[{...c,id:u()}]};if(n||!e){let e={...o,id:`guest-${u()}`,createdAt:new Date().toISOString()};t(t=>({cycles:[...t.cycles,e],currentCycle:e}));return}let a=await (0,i.addDoc)((0,i.collection)(s.db,"users",e,"cycles"),{...o,createdAt:(0,i.serverTimestamp)(),updatedAt:(0,i.serverTimestamp)()});t(e=>({currentCycle:{...o,id:a.id,createdAt:new Date().toISOString()}}))},saveCurrentCycle:async()=>{let{userId:e,isGuestMode:t,currentCycle:n}=r();if(t||!e||!n)return;let o=r().cycles.find(e=>e.id===n.id);if(o&&o.isOfficial)return;let{id:a,...l}=n,u=(0,i.doc)(s.db,"users",e,"cycles",a);await (0,i.setDoc)(u,{...l,updatedAt:(0,i.serverTimestamp)()},{merge:!0})},deleteCycle:async n=>{e.r(66879).useTimerStore.getState().send({type:"STOP_FOR_EDIT"});let{userId:o,isGuestMode:a,cycles:l,currentCycle:u}=r();if(a||!o)return;let c=l.find(e=>e.id===n);c&&c.isOfficial||(u?.id===n&&t({currentCycle:l.find(e=>e.id!==n&&!e.isOfficial)||d[0],currentPhaseIndex:0}),await (0,i.deleteDoc)((0,i.doc)(s.db,"users",o,"cycles",n)))},addPhase:()=>{t(e=>{if(!e.currentCycle||e.currentCycle.isOfficial)return{};let t={...c,id:u()},r=[...e.currentCycle.phases,t],n={...e.currentCycle,phases:r};return{currentCycle:n,cycles:e.cycles.map(e=>e.id===n.id?n:e)}})},updatePhase:(r,n)=>{e.r(66879).useTimerStore.getState().send({type:"STOP_FOR_EDIT"}),t(e=>{if(!e.currentCycle||e.currentCycle.isOfficial)return{};let t=e.currentCycle.phases.map(e=>e.id===r?{...e,...n}:e),i={...e.currentCycle,phases:t};return{currentCycle:i,cycles:e.cycles.map(e=>e.id===i.id?i:e)}})},deletePhase:r=>{e.r(66879).useTimerStore.getState().send({type:"STOP_FOR_EDIT"}),t(e=>{if(!e.currentCycle||e.currentCycle.isOfficial)return{};let t=e.currentCycle.phases.filter(e=>e.id!==r),n={...e.currentCycle,phases:t};return{currentCycle:n,cycles:e.cycles.map(e=>e.id===n.id?n:e)}})},updateCycle:e=>{t(t=>{if(!t.currentCycle)return{};let r={...t.currentCycle,...e};return{currentCycle:r,cycles:t.cycles.map(e=>e.id===r.id?r:e)}})},toggleSounds:()=>t(e=>({playSounds:!e.playSounds}))}),{name:"cycle-storage",onRehydrateStorage:()=>e=>{e&&(e.isLoading=!0,e.playSounds=e.playSounds??!0)},partialize:e=>({cycles:[],currentCycleId:e.currentCycle?.id,currentPhaseIndex:e.currentPhaseIndex,userId:e.userId,isGuestMode:e.isGuestMode,playSounds:e.playSounds})}))}]);